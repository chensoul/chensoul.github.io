@plugin "@tailwindcss/typography";

@layer base {
  .prose {
    @apply !text-sm !leading-relaxed prose-headings:!mb-3 prose-p:!text-foreground prose-a:underline-offset-6 prose-blockquote:!border-l-accent/50 prose-blockquote:opacity-70 prose-strong:!text-foreground prose-code:rounded prose-code:bg-muted/75 prose-code:p-0.5 prose-code:!font-normal prose-code:!text-foreground prose-code:before:!content-none prose-code:after:!content-none prose-ol:!text-foreground prose-ul:overflow-x-clip prose-ul:!text-foreground prose-li:marker:!text-accent prose-table:text-foreground prose-th:border prose-th:border-border prose-th:!text-accent prose-td:border prose-td:border-border prose-img:mx-auto prose-hr:!my-0 prose-hr:!border-border;
  }

  /* 标题颜色：覆盖 typography 插件，统一使用前景色 */
  .prose h1,
  .prose h2,
  .prose h3,
  .prose h4,
  .prose h5,
  .prose h6 {
    color: var(--foreground) !important;
  }

  /* h2 上边距缩小 */
  .prose h2 {
    margin-top: 1.25em !important;
  }

  /* 深色主题下 h4/h5/h6 略淡，层级更清晰 */
  html[data-theme="dark"] .prose h4,
  html[data-theme="dark"] .prose h5,
  html[data-theme="dark"] .prose h6 {
    color: var(--foreground) !important;
  }

  /* inline code */
  .prose :not(pre) > code {
    @apply !break-words !whitespace-pre-wrap;
  }

  .prose strong {
    font-weight: var(--strong-font-weight) !important;
  }

  .prose a {
    @apply break-words !text-accent !no-underline hover:!underline;
  }
  .prose thead th:first-child,
  tbody td:first-child,
  tfoot td:first-child {
    padding-inline-start: 0.5714286em !important;
  }

  .prose blockquote {
    @apply !font-normal; /* font-serif !not-italic */
  }
  .prose blockquote p::before {
    content: "" !important;
  }

  .prose details {
    @apply inline-block cursor-pointer text-foreground select-none;
  }
  .prose summary {
    @apply focus-visible:no-underline focus-visible:outline-2 focus-visible:outline-offset-1 focus-visible:outline-accent;
  }

  .prose img {
    margin-block: 0 !important;
  }

  .prose kbd {
    @apply rounded border-1 border-border bg-muted text-foreground!;
  }

  .responsive-table {
    @apply overflow-x-auto;
    -webkit-overflow-scrolling: touch;
  }

  .responsive-table table {
    @apply w-full min-w-full table-auto;
  }

  .prose iframe {
    @apply aspect-video w-full max-w-full;
  }

  .prose .katex-display {
    @apply text-foreground;
  }

  /* Image bleed: figure uses #site-frame inline padding variable */
  .prose figure.image-bleed {
    margin-inline: calc(var(--frame-pad-inline) * -1);
    width: calc(100% + (var(--frame-pad-inline) * 2));
  }
  .prose figure.image-bleed img {
    display: block;
    width: 100%;
    height: auto;
    margin-inline: 0 !important;
  }
}
