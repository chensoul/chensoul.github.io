---
/**
 * 单条跑步活动卡片，点击打开详情弹窗
 */
interface RunItem {
  date: string;
  distance: number;
  duration: string;
  pace: string;
  hr_zone?: number;
  activity_type?: string;
  workout_name?: string;
  route?: string;
  vdot?: number;
  training_load?: number;
}

interface Props {
  run: RunItem;
  index: number;
  hrZoneLabels: Record<number, string>;
  durationFormatted: string;
}
const { run, index, hrZoneLabels, durationFormatted } = Astro.props;
---

<div
  class="run-card run-card cursor-pointer rounded-lg border border-[var(--border)] p-4 shadow-sm transition-all hover:border-[var(--accent)] hover:shadow-md"
  data-run-index={index}
  data-run={JSON.stringify(run)}
>
  <div class="run-main flex flex-1 flex-col gap-1.5">
    <div class="run-header flex flex-wrap items-center gap-2.5">
      <time class="run-date text-sm font-medium text-[var(--foreground)]">
        {run.date.split(" ")[0]}
      </time>
      {run.hr_zone != null && run.hr_zone > 0 && (
        <span
          class:list={[
            "hr-zone-badge hr-zone-tag inline-flex rounded-full px-2.5 py-1 text-[11px] font-semibold",
            `zone-${run.hr_zone}`,
          ]}
        >
          {hrZoneLabels[run.hr_zone]}
        </span>
      )}
    </div>
    <span class="run-type text-[13px] text-[var(--foreground)]/80">
      {run.activity_type || "户外跑步"}
      {(run.route?.trim() || run.workout_name) && (
        <span class="workout-name">
          {" "}
          · {run.route?.trim() || run.workout_name}
        </span>
      )}
    </span>
  </div>
  <div class="run-stats flex gap-5">
    <div class="stat flex flex-col gap-0.5">
      <span class="stat-value text-base font-semibold text-[var(--foreground)]">
        {run.distance}
      </span>
      <span class="stat-label text-[11px] uppercase tracking-wide text-[var(--foreground)]/70">
        公里
      </span>
    </div>
    <div class="stat flex flex-col gap-0.5">
      <span class="stat-value text-base font-semibold text-[var(--foreground)]">
        {durationFormatted}
      </span>
      <span class="stat-label text-[11px] uppercase tracking-wide text-[var(--foreground)]/70">
        时长
      </span>
    </div>
    <div class="stat flex flex-col gap-0.5">
      <span class="stat-value text-base font-semibold text-[var(--foreground)]">
        {run.pace}
      </span>
      <span class="stat-label text-[11px] uppercase tracking-wide text-[var(--foreground)]/70">
        配速
      </span>
    </div>
    <div class="stat vdot-stat flex flex-col gap-0.5">
      <span class="stat-value text-base font-semibold">{run.vdot ?? "-"}</span>
      <span class="stat-label text-[11px] uppercase tracking-wide text-[var(--foreground)]/70">
        VDOT
      </span>
    </div>
    {run.training_load != null && run.training_load > 0 && (
      <div class="stat load-stat flex flex-col gap-0.5">
        <span class="stat-value text-base font-semibold">{run.training_load}</span>
        <span class="stat-label text-[11px] uppercase tracking-wide text-[var(--foreground)]/70">
          负荷
        </span>
      </div>
    )}
  </div>
</div>
