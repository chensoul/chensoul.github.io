<!DOCTYPE html>
<html class="no-js" lang="zh-cn">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[è¯‘]æ¢ç´¢ http2ï¼ˆç¬¬ 2 éƒ¨åˆ†ï¼‰ï¼šä½¿ç”¨ node-http2 æ ¸å¿ƒå’Œ hapijs - Javaã€Springã€Spring Bootã€MicroServicesã€Architectureã€Kubernetesã€DevOps</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="[è¯‘]æ¢ç´¢ http2ï¼ˆç¬¬ 2 éƒ¨åˆ†ï¼‰ï¼šä½¿ç”¨ node-http2 æ ¸å¿ƒå’Œ hapijs">
	<meta property="og:description" content="Javaã€Springã€Spring Bootã€MicroServicesã€Architectureã€Kubernetesã€DevOps">
	<meta property="og:type" content="article">
	<meta property="og:url" content="https://blog.chensoul.cc/posts/2024/05/08/exploring-http2-part-2-overview/">
	<meta property="og:site_name" content="ChenSoul Blog">
	<meta property="og:image" content="">
	
  <meta itemprop="name" content="[è¯‘]æ¢ç´¢ http2ï¼ˆç¬¬ 2 éƒ¨åˆ†ï¼‰ï¼šä½¿ç”¨ node-http2 æ ¸å¿ƒå’Œ hapijs">
  <meta itemprop="description" content="åŸæ–‡é“¾æ¥ï¼šhttps://noobj.medium.com/exploring-http2-part-2-with-node-http2-core-and-hapijs-74e3df14249
æ¥æºï¼šhttps://www.thewebmaster.com/">
  <meta itemprop="datePublished" content="2024-05-08T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-05-08T00:00:00+00:00">
  <meta itemprop="wordCount" content="324">
  <meta itemprop="keywords" content="Javascript,Backend,Tutorial,Github">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:title" content="[è¯‘]æ¢ç´¢ http2ï¼ˆç¬¬ 2 éƒ¨åˆ†ï¼‰ï¼šä½¿ç”¨ node-http2 æ ¸å¿ƒå’Œ hapijs">
	<meta name="twitter:description" content="Javaã€Springã€Spring Bootã€MicroServicesã€Architectureã€Kubernetesã€DevOps">
	<meta name="twitter:image" content="">

	<link rel="preconnect" href="//fonts.loli.net" crossorigin>
	<link rel="dns-prefetch" href="//fonts.loli.net">
	<link rel="stylesheet" href="https://fonts.loli.net/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="/css/style.css">

	<link rel="shortcut icon" href="/favicon.ico">
		
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="ChenSoul Blog" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/logo.svg" loading="lazy" alt="Site logo" width="60" height="60">
				</div><div class="logo__item logo__text">
					<div class="logo__title">ChenSoul Blog</div>
					<div class="logo__tagline">Javaã€Springã€Spring Bootã€MicroServicesã€Architectureã€Kubernetesã€DevOps</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">èœå•</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">é¦–é¡µ</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/categories/">
				
				<span class="menu__text">åˆ†ç±»</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">æ ‡ç­¾</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/index.xml">
				
				<span class="menu__text">è®¢é˜…</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">å…³äº</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[è¯‘]æ¢ç´¢ http2ï¼ˆç¬¬ 2 éƒ¨åˆ†ï¼‰ï¼šä½¿ç”¨ node-http2 æ ¸å¿ƒå’Œ hapijs</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2024-05-08">2024-05-08</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/java/" rel="category">Java</a>
	</span>
</div><div class="meta__item-tags meta__item"><svg class="meta__icon icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg><span class="meta__text"><a class="meta__link" href="/tags/javascript/" rel="tag">Javascript</a>, <a class="meta__link" href="/tags/backend/" rel="tag">Backend</a>, <a class="meta__link" href="/tags/tutorial/" rel="tag">Tutorial</a>, <a class="meta__link" href="/tags/github/" rel="tag">Github</a>
	</span>
</div>
</div>
		</header>
		
		<div class="content post__content clearfix">
			<p>åŸæ–‡é“¾æ¥ï¼š<a href="https://noobj.medium.com/exploring-http2-part-2-with-node-http2-core-and-hapijs-74e3df14249" target="_blank">https://noobj.medium.com/exploring-http2-part-2-with-node-http2-core-and-hapijs-74e3df14249</a></p>
<p><img src="../../../static/images/exploring-http2-part-2-overview-01.webp" alt="img"></p>
<p>æ¥æºï¼š<a href="https://www.thewebmaster.com/hosting/2015/dec/14/what-is-http2-and-how-does-it-compare-to-http1-1/" target="_blank">https://www.thewebmaster.com/</a></p>
<p><strong>å…ˆå†³æ¡ä»¶</strong>ï¼šäº†è§£ javascriptã€å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„ã€‚</p>
<p>å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨<a href="https://github.com/noobg1/http1_vs_http2" target="_blank">github</a>ä¸Šæ‰¾åˆ°ã€‚</p>
<p>ç¬¬ 1 éƒ¨åˆ†ï¼š<a href="https://medium.com/@noobj/exploring-http2-part-1-overview-dc3e9b53968f" target="_blank">æ¦‚è¿°ï¼ˆ<em>http2 çš„åŸå› ã€å†…å®¹ã€æ—¶é—´ã€æ–¹å¼</em>ï¼‰</a><strong>ç¬¬ 2 éƒ¨åˆ†ï¼šä½¿ç”¨ node-http2 æ ¸å¿ƒå’Œ hapijs è¿›è¡Œæ¢ç´¢</strong></p>
<blockquote>
<p>å…è´£<strong>å£°æ˜</strong>ï¼šæœ¬æ–‡å°†ä½¿ç”¨<strong>node@v9+<strong>é™„å¸¦çš„</strong>http2æ¨¡å—ã€‚</strong><a href="https://github.com/http2/http2-spec/wiki/Implementations" target="_blank">è¿™é‡Œ</a>åˆ—å‡ºäº†å…¶ä»–å‡ ä¸ª http2 å®¢æˆ·ç«¯-æœåŠ¡å™¨åº“å®ç°ã€‚</p></blockquote>
<p>è®©æˆ‘ä»¬å¼€å§‹åˆ›å»ºä¸€ä¸ªå…·æœ‰å•ä¸€è·¯ç”±çš„ç®€å• http1.1 æœåŠ¡å™¨ã€‚</p>
<pre tabindex="0"><code>mkdir hapijs-http2 &amp;&amp; \ 
cd hapijs-http2 &amp;&amp; \ 
npm init -y &amp;&amp; \ 
npm i hapi@^16.6 -s &amp;&amp; \ 
touch http1Server.js
</code></pre><p>å°†ä¸‹é¢çš„ä»£ç å¤åˆ¶åˆ°æ­¤å¤„æˆ–ä»<a href="https://github.com/noobg1/http1_vs_http2" target="_blank">æ­¤å¤„</a><code>http1Server.js</code>å…‹éš†æ•´ä¸ªå­˜å‚¨åº“ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Hapi</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;hapi&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">server</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Hapi</span>.<span style="color:#a6e22e">Server</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// define server config
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">connection</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">port</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;8000&#39;</span>
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// define route config
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">route</span>([{
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;GET&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/ping&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">handler</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">request</span>, <span style="color:#a6e22e">reply</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">reply</span>(<span style="color:#e6db74">&#39;pong&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// start server
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">start</span>(<span style="color:#a6e22e">err</span> =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">err</span>) <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Started </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">connections</span>.<span style="color:#a6e22e">length</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> connections`</span>)
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿›è¡Œå¥å…¨æ€§æ£€æŸ¥ã€‚</p>
<p>å¯åŠ¨æœåŠ¡å™¨ï¼Œ<code>node http1Server.js</code></p>
<pre tabindex="0"><code>â‡’ http://127.0.0.1:8000/ping
 pong
</code></pre><p>å‡‰çˆ½çš„ï¼å¦‚æœæˆ‘ä»¬å¾—åˆ° pong çš„ pingï¼Œè®©æˆ‘ä»¬å°è¯•å°†<strong>http2</strong>é›†æˆåˆ°æˆ‘ä»¬çš„ hapijs æœåŠ¡å™¨ä¸­ã€‚</p>
<p>æœ¬è´¨ä¸Šï¼Œhttp2 éœ€è¦ä¸ https ä¸€èµ·è¿è¡Œã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦<a href="https://www.globalsign.com/en/ssl-information-center/what-is-an-ssl-certificate/" target="_blank">ssl è¯ä¹¦</a>ã€‚æˆ‘ä»¬å°†ä½¿ç”¨<a href="https://www.openssl.org/" target="_blank">OpenSSL</a>åˆ›å»ºä¸€ä¸ªè‡ªç­¾åè¯ä¹¦ï¼Œæˆ–è€…æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨<a href="https://github.com/noobg1/http1_vs_http2/tree/master/config/secrets" target="_blank">æ­¤å¤„</a>çš„ä¸€ä¸ªã€‚</p>
<pre tabindex="0"><code>openssl req -x509 -newkey rsa:2048 -nodes -sha256 -subj &#39;/CN=localhost&#39; \ 
  -keyout localhost-privkey.pem -out localhost-cert.pem
</code></pre><p>æˆ‘ä»¬å°†<code>localhost-privkey.pem</code>åœ¨<code>localhost-cert.pem</code>æˆ‘ä»¬çš„<code>http2Server.js</code>.</p>
<p>è®©æˆ‘ä»¬è¿›è¡Œä»¥ä¸‹æ›´æ”¹ï¼Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Hapi</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;hapi&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;fs&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Http2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;http2&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">server</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Hapi</span>.<span style="color:#a6e22e">Server</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// read certificate and private key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">serverOptions</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">key</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">readFileSync</span>(<span style="color:#e6db74">&#39;localhost-privkey.pem&#39;</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">cert</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">readFileSync</span>(<span style="color:#e6db74">&#39;localhost-cert.pem&#39;</span>)
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// create http2 secure server listener
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">listener</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Http2</span>.<span style="color:#a6e22e">createSecureServer</span>(<span style="color:#a6e22e">serverOptions</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// create a connection object with listener and other options
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">connection</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">listener</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">port</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;8000&#39;</span>
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// define routes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">route</span>([{
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;GET&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/ping&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">handler</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">request</span>, <span style="color:#a6e22e">reply</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">reply</span>(<span style="color:#e6db74">&#39;pong&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// start server
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">start</span>(<span style="color:#a6e22e">err</span> =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">err</span>) <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Started </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">connections</span>.<span style="color:#a6e22e">length</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> connections`</span>)
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ï¼Ÿ</p>
<blockquote>
<p><strong>ç¬¬ 7-10 è¡Œ</strong>ï¼šæˆ‘ä»¬æ­£åœ¨è¯»å–ä¹‹å‰ç”Ÿæˆçš„è¯ä¹¦å’Œç§é’¥ã€‚</p>
<p><strong>ç¬¬ 13 è¡Œ</strong>ï¼šåˆ›å»ºä¸€ä¸ªå®‰å…¨çš„ Http2 æœåŠ¡å™¨ï¼Œå…¶ä¸­è¯ä¹¦å’Œç§é’¥ä½œä¸ºæœåŠ¡å™¨<a href="https://nodejs.org/dist/latest-v10.x/docs/api/http2.html#http2_http2_createsecureserver_options_onrequesthandler" target="_blank">é€‰é¡¹</a>ä»<code>http2</code>æ¨¡å—ä¼ é€’ã€‚</p>
<p><strong>ç¬¬ 17 è¡Œ</strong>ï¼šæˆ‘ä»¬å¯ä»¥åœ¨ä½¿ç”¨è¯¥é€‰é¡¹åˆ›å»ºè¿æ¥æ—¶æä¾›æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨å®ç°<code>listener</code>ã€‚ ï¼ˆæ›´å¤šä¿¡æ¯<a href="https://github.com/hapijs/hapi/blob/master/API.md#serverconnectionoptions" target="_blank">åœ¨è¿™é‡Œ</a>ï¼‰ã€‚</p>
<p><strong>ä»…ä¾›å‚è€ƒ</strong>ï¼šæˆ‘ä½¿ç”¨çš„æ˜¯ <a href="mailto:node@v10.4.1">node@v10.4.1</a>ï¼Œä»»ä½•é«˜äº 9 çš„å€¼éƒ½å¯ä»¥ã€‚</p></blockquote>
<p>é‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨æµè§ˆå™¨<code>https://127.0.0.1:8000/ping</code></p>
<p>ç§ï¼</p>
<p><img src="../../../static/images/exploring-http2-part-2-overview-02.webp" alt="img"></p>
<p>æœåŠ¡å™¨ç”¨ pong å›å¤</p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œ</p></blockquote>
<ul>
<li>åè®®å€¼ä¸º<strong>h2</strong>åˆ«å<strong>http2</strong></li>
<li>å°½ç®¡æˆ‘ä»¬ä½¿ç”¨ https è¿è¡Œï¼Œä½†æˆ‘ä»¬åœ¨æµè§ˆå™¨åœ°å€æ ä¸­çœ‹åˆ°<strong>ä¸å®‰å…¨</strong>ï¼›å› ä¸ºæˆ‘ä»¬å¯¹ssl è¯ä¹¦<em>è¿›è¡Œäº†è‡ªç­¾å</em>ï¼Œå¹¶ä¸”æµè§ˆå™¨æ— æ³•å°†å…¶è¯†åˆ«ä¸ºæ¥è‡ªæœ‰æ•ˆçš„<a href="https://www.globalsign.com/en/ssl-information-center/what-are-certification-authorities-trust-hierarchies/" target="_blank"><em>è¯ä¹¦é¢å‘æœºæ„</em></a>ã€‚</li>
<li>å¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨curlï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¾—åˆ°This is because http2 may not support with default curly by your OS.æ‚¨å¯ä»¥æŒ‰ç…§<a href="https://simonecarletti.com/blog/2016/01/http2-curl-macosx/" target="_blank">æ­¤æ“ä½œ</a>å‡çº§æ‚¨çš„curl (macOS)ã€‚
<code>âœ curl https://127.0.0.1:8000/ping curl: Unsupported protocol</code></li>
<li>ä¸€æ—¦æˆ‘ä»¬å®Œæˆè®¾ç½®ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸¦æœ‰æ ‡å¿—çš„curlæ¥æ”¯æŒhttp2åè®®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¼ é€’å¸¦æœ‰æ ‡å¿—çš„è¯ä¹¦æ–‡ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯è‡ªç­¾åçš„å¹¶ä¸”ä¸èƒ½è¢«curlè¯†åˆ«ã€‚
<code>curl --http2 --cacert localhost-cert.pem https://127.0.0.1:8000/ping</code>
<code>â€”-http2``â€”-cacert</code></li>
</ul>
<p><img src="../../../static/images/exploring-http2-part-2-overview-03.webp" alt="img"></p>
<ul>
<li><code>-I</code>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¦æ±‚curlä»…è¿”å›å¸¦æœ‰ï¼ˆheadï¼‰æˆ–å¸¦æœ‰ï¼ˆverboseï¼‰çš„å“åº”å¤´æ¥éªŒè¯åè®®<code>-v</code>ã€‚</li>
</ul>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚ä½†æˆ‘ä»¬æ‰€æœ‰çš„å®¢æˆ·å¯èƒ½æ”¯æŒä¹Ÿå¯èƒ½ä¸æ”¯æŒ http2ã€‚æˆ‘ä»¬é€šè¿‡æ·»åŠ é¢å¤–çš„æœåŠ¡å™¨é€‰é¡¹æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼š
<code>allowHttp1: true</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>// read certificate and private-key
</span></span><span style="display:flex;"><span>const serverOptions <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  key: fs.readFileSync<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;localhost-privkey.pem&#39;</span><span style="color:#f92672">)</span>,
</span></span><span style="display:flex;"><span>  cert: fs.readFileSync<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;localhost-cert.pem&#39;</span><span style="color:#f92672">)</span>,
</span></span><span style="display:flex;"><span>  allowHTTP1: true
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>;
</span></span></code></pre></div><p>åœ¨ serverOptions ä¸­æ·»åŠ â€œallowHTTP1: trueâ€
åœ¨ serverOptions ä¸­æ·»åŠ â€œallowHTTP1ï¼š trueâ€</p>
<p>ç°åœ¨æˆ‘ä»¬å¼€å§‹ï¼å½“å®¢æˆ·ç«¯ä¸æ”¯æŒ http2 æ—¶ï¼Œå›é€€åˆ°æä¾› http1.1</p>
<p><img src="../../../static/images/exploring-http2-part-2-overview-04.webp" alt="img"></p>
<p>åŒæ—¶ä¸º http1.1 å’Œ http2 å®¢æˆ·ç«¯æä¾›æœåŠ¡</p>
<p>ä»…é€šè¿‡è¿™äº›æ›´æ”¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—çº¦ 135% çš„æ€§èƒ½<a href="https://medium.com/the-node-js-collection/node-js-can-http-2-push-b491894e1bb1" target="_blank">æå‡</a>ã€‚</p>
<p>ä»”ç»†è§‚å¯Ÿå·®å¼‚ï¼Œ</p>
<p><img src="../../../static/images/exploring-http2-part-2-overview-05.webp" alt="img"></p>
<blockquote>
<p>é€šè¿‡<strong>ç€‘å¸ƒ</strong>éƒ¨åˆ†ï¼Œå¯ä»¥æ˜æ˜¾åœ°æŒæ¡å•ä¸ª TCP è¿æ¥ä½¿ç”¨ä¸å¤šä¸ª TCP è¿æ¥ä½¿ç”¨ä¹‹é—´çš„å·®å¼‚ã€‚</p></blockquote>
<p>å¦‚æœæ‚¨æƒ³è·å¾— http2 å¯ä»¥æä¾›çš„ç¬¬ä¸€æ‰‹ç»éªŒï¼Œè¯·æŒ‰ç…§<a href="https://github.com/noobg1/http1_vs_http2" target="_blank">æ­¤å¤„çš„</a>è¯´æ˜åœ¨æ‚¨çš„è®¡ç®—æœºä¸­è¿è¡Œä¸Šè¿°æ¼”ç¤ºã€‚</p>
<p><em>å› æ­¤ï¼Œ</em><a href="https://github.com/http2/http2-spec/wiki/Implementations" target="_blank"><em>é€‰æ‹©</em></a><em>æ‚¨çš„å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨åº“å®ç°å¹¶å¼€å§‹ä½¿ç”¨ http2ï¼</em></p>
<p>å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨<a href="https://github.com/noobg1/http1_vs_http2" target="_blank">github</a>ä¸Šæ‰¾åˆ°ã€‚</p>
<blockquote>
<p>å‚è€ƒï¼š</p></blockquote>
<ul>
<li><a href="https://http2.github.io/faq" target="_blank">https://http2.github.io/faq</a></li>
<li><a href="https://http2.akamai.com/demo" target="_blank">https://http2.akamai.com/demo</a></li>
<li><a href="https://github.com/http2/http2-spec/wiki/Implementations" target="_blank">https://github.com/http2/http2-spec/wiki/Implementations</a></li>
<li><a href="https://caniuse.com/#feat=http2" target="_blank">https://caniuse.com/#feat=http2</a></li>
<li><a href="https://nodejs.org/dist/latest-v10.x/docs/api/http2.html" target="_blank">https://nodejs.org/dist/latest-v10.x/docs/api/http2.html</a></li>
</ul>
<p><em>å¦‚æœä½ è§‰å¾—è¿™ä¸ªæ•…äº‹æœ‰ç”¨çš„è¯ï¼Œè¯·ç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹ğŸ‘</em></p>

		</div>


	</article>
</main>
<footer class="post__footer">
	

<div class="post-related">
	<h3>ç›¸å…³æ–‡ç« </h3>
	<ul class="post-related-list">
		
		<li class="post-related-item">
			<a href="/posts/2024/05/08/exploring-http2-part-1-overview/" target="_blank" title="[è¯‘]æ¢ç´¢ http2ï¼ˆç¬¬ 1 éƒ¨åˆ†ï¼‰ï¼šæ¦‚è¿°">[è¯‘]æ¢ç´¢ http2ï¼ˆç¬¬ 1 éƒ¨åˆ†ï¼‰ï¼šæ¦‚è¿°</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2024/05/08/socketio-vs-http/" target="_blank" title="[è¯‘]æ¯”è¾ƒ Socket.IO å’Œ HTTPï¼šä¸»è¦åŒºåˆ«å’Œç”¨ä¾‹">[è¯‘]æ¯”è¾ƒ Socket.IO å’Œ HTTPï¼šä¸»è¦åŒºåˆ«å’Œç”¨ä¾‹</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2024/05/07/thingsboard-domain/" target="_blank" title="ThingsBoardçš„é¢†åŸŸæ¨¡å‹">ThingsBoardçš„é¢†åŸŸæ¨¡å‹</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2024/05/07/websocket-alternatives/" target="_blank" title="[è¯‘]2024å¹´æœ€å¥½çš„WebSocketæ›¿ä»£å“">[è¯‘]2024å¹´æœ€å¥½çš„WebSocketæ›¿ä»£å“</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2024/05/07/websockets-java/" target="_blank" title="[è¯‘]Javaå’ŒWebSocketsï¼šæ„å»ºå¯é çš„å®æ—¶åº”ç”¨ç¨‹åº">[è¯‘]Javaå’ŒWebSocketsï¼šæ„å»ºå¯é çš„å®æ—¶åº”ç”¨ç¨‹åº</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2024/05/07/the-websocket-api-and-protocol-explained/" target="_blank" title="[è¯‘]WebSocket APIå’Œåè®®è¯´æ˜">[è¯‘]WebSocket APIå’Œåè®®è¯´æ˜</a>
		</li>
		
	</ul>
</div>

</footer>

<footer class="post__footer">
	<footer class="post__footer">
		
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/javascript/" rel="tag">javascript</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/backend/" rel="tag">backend</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/tutorial/" rel="tag">tutorial</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/github/" rel="tag">github</a>
		</li>
	</ul>
</div>
	</footer>
</footer>


<nav class="pagination flex">
	<div class="pagination__item pagination__item--prev">
		<a class="pagination__link" href="/posts/2024/05/07/websocket-alternatives/" rel="prev">
			<p class="pagination__title">Â«&thinsp;ä¸Šä¸€ç¯‡: [è¯‘]2024å¹´æœ€å¥½çš„WebSocketæ›¿ä»£å“</p>
		</a>
	</div>
	<div class="pagination__item pagination__item--next">
		<a class="pagination__link" href="/posts/2024/05/08/exploring-http2-part-1-overview/" rel="next">
			<p class="pagination__title">&thinsp;Â» ä¸‹ä¸€ç¯‡: [è¯‘]æ¢ç´¢ http2ï¼ˆç¬¬ 1 éƒ¨åˆ†ï¼‰ï¼šæ¦‚è¿°</p>
		</a>
	</div>
</nav>



<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="ChenSoul avatar" src="/avatar.jpg" class="avatar" height="60" width="60" loading="lazy">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">å…³äº ChenSoul</span>
	</div>
	<div class="authorbox__description">
		ä¸€ä¸ªæ¥è‡ªä¸­å›½æ­¦æ±‰çš„å¼€å‘è€…ï¼Œä¸»è¦æ’°å†™è½¯ä»¶å¼€å‘å’Œå¼€æºæ–¹é¢çš„æ–‡ç« ã€‚æµè§ˆæˆ‘çš„<a href="%28/posts%29">åšå®¢æ–‡ç« </a>ï¼Œè®¢é˜…æˆ‘çš„ <a href="/index.xml">RSS</a> æºï¼Œæˆ–äº†è§£æ›´å¤š<a href="/about/">å…³äºæˆ‘</a>çš„ä¿¡æ¯ã€‚
	</div>
</div>




	<p><h3>æ¬¢è¿ç•™è¨€ï¼</h3></p>
<div id="remark42"></div>
<script>
	var remark_config = {
		host: 'https:\/\/comment.chensoul.cc',
		site_id: 'remark',
		components: ['embed'],
		url: 'https:\/\/blog.chensoul.cc\/posts\/2024\/05\/08\/exploring-http2-part-2-overview\/',
		locale: 'zh'
	};

	!function(e, n) {
		for (var o = 0; o < e.length; o++) {
			var r = n.createElement('script'),
			c = '.js',
			d = n.head || n.body;
			'noModule' in r ? (r.type = 'module', c = '.mjs') : r.async = !0, r.defer = !0, r.src = remark_config.host + '/web/' + e[o] + c, d.appendChild(r)
		}
	}(remark_config.components || ['embed'], document);

</script>





			</div>
			


		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
<div class="footer__links">
	<a class="footer__link" href="/">é¦–é¡µ</a> | <a class="footer__link" href="/categories/">åˆ†ç±»</a> | <a class="footer__link" href="/tags/">æ ‡ç­¾</a> | <a class="footer__link" href="/index.xml">è®¢é˜…</a> | <a class="footer__link" href="/about/">å…³äº</a>
</div>
		<div class="footer__copyright">
			&copy; 2025 ChenSoul.
			<span class="footer__copyright-credits">åŸºäº <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> å¼•æ“å’Œ <a href="https://github.com/chensoul/rose-hugo/" rel="nofollow noopener" target="_blank">Rose Hugo</a> ä¸»é¢˜</span>
		</div>
	</div>

	






<style>
	.scroll-up a {
		display: block;
		height: 3.125rem;
		width: 3.125rem;
		text-align: center;
		line-height: 2.7;
		border-radius: 50px;
		font-size: 1.125rem;
		color: #fff;
		opacity: 1;
		transition: all 0.3s ease 0s;
		box-shadow: 0 0 10px rgb(0 0 0 / 20%);
	}
	.scroll-up a {
		background: #ee591f;
	}
	.scroll-up {
		position: fixed;
		display: none;
		bottom: 50px;
		z-index: 999;
	}
	.scroll-up.right {
		right: 60px;
	}
</style>

<div class="scroll-up custom right" style="display: block;"><a href="#top" id="top-link" accesskey="g"><i
	class="fa fa-arrow-up"></i></a></div>

<script>
	var mybutton = document.getElementById("top-link");
	window.onscroll = function () {
		if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
			mybutton.style.visibility = "visible";
			mybutton.style.opacity = "1";
		} else {
			mybutton.style.visibility = "hidden";
			mybutton.style.opacity = "0";
		}
	};
</script>


    <script defer src="https://umami.chensoul.cc/random-string.js" data-website-id="1e07d36d-bec3-4ba6-9459-876b1ac3bbe7"></script>
</footer>


	</div>

	<script>
		'use strict';
		(function iifeMenu(document, window, undefined) {
			var menuBtn = document.querySelector('.menu__btn');
			var	menu = document.querySelector('.menu__list');
			function toggleMenu() {
				menu.classList.toggle('menu__list--active');
				menu.classList.toggle('menu__list--transition');
				this.classList.toggle('menu__btn--active');
				this.setAttribute(
					'aria-expanded',
					this.getAttribute('aria-expanded') === 'true' ? 'false' : 'true'
				);
			}
			function removeMenuTransition() {
				this.classList.remove('menu__list--transition');
			}
			if (menuBtn && menu) {
				menuBtn.addEventListener('click', toggleMenu, false);
				menu.addEventListener('transitionend', removeMenuTransition, false);
			}
		}(document, window));
	</script>
</body>
</html>