<!DOCTYPE html>
<html class="no-js" lang="zh-cn">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring AI è®©æ•°æ®åº“å¬æ‡‚äººè¯ï¼šText2SQL è‡ªç„¶è¯­è¨€æŸ¥è¯¢å®è·µæŒ‡å— - Javaã€Springã€Spring Bootã€MicroServicesã€Architectureã€Kubernetesã€DevOps</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="æ·±å…¥æ¢ç´¢ Spring AI &#43; DeepSeek å®ç° Text2SQL è‡ªç„¶è¯­è¨€æ•°æ®åº“æŸ¥è¯¢ï¼ŒåŒ…å«ç›´æ¥æ¨¡å¼ã€MCPå·¥å…·é›†æˆã€åˆ†æ­¥éª¤æŸ¥è¯¢ä¸‰ç§å®ç°æ–¹æ¡ˆï¼Œé™„å®Œæ•´æºç å’Œè¸©å‘ç»éªŒ">
	<meta property="og:title" content="Spring AI è®©æ•°æ®åº“å¬æ‡‚äººè¯ï¼šText2SQL è‡ªç„¶è¯­è¨€æŸ¥è¯¢å®è·µæŒ‡å—">
	<meta property="og:description" content="æ·±å…¥æ¢ç´¢ Spring AI &#43; DeepSeek å®ç° Text2SQL è‡ªç„¶è¯­è¨€æ•°æ®åº“æŸ¥è¯¢ï¼ŒåŒ…å«ç›´æ¥æ¨¡å¼ã€MCPå·¥å…·é›†æˆã€åˆ†æ­¥éª¤æŸ¥è¯¢ä¸‰ç§å®ç°æ–¹æ¡ˆï¼Œé™„å®Œæ•´æºç å’Œè¸©å‘ç»éªŒ">
	<meta property="og:type" content="article">
	<meta property="og:url" content="https://blog.chensoul.cc/posts/2025/09/30/spring-ai-text2sql-showcase/">
	<meta property="og:site_name" content="ChenSoul Blog">
	<meta property="og:image" content="https://csmos.oss-cn-beijing.aliyuncs.com/spring-ai-text2sql-showcase-01.png">
	
  <meta itemprop="name" content="Spring AI è®©æ•°æ®åº“å¬æ‡‚äººè¯ï¼šText2SQL è‡ªç„¶è¯­è¨€æŸ¥è¯¢å®è·µæŒ‡å—">
  <meta itemprop="description" content="æ·±å…¥æ¢ç´¢ Spring AI &#43; DeepSeek å®ç° Text2SQL è‡ªç„¶è¯­è¨€æ•°æ®åº“æŸ¥è¯¢ï¼ŒåŒ…å«ç›´æ¥æ¨¡å¼ã€MCPå·¥å…·é›†æˆã€åˆ†æ­¥éª¤æŸ¥è¯¢ä¸‰ç§å®ç°æ–¹æ¡ˆï¼Œé™„å®Œæ•´æºç å’Œè¸©å‘ç»éªŒ">
  <meta itemprop="datePublished" content="2025-09-30T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-09-30T00:00:00+00:00">
  <meta itemprop="wordCount" content="2650">
  <meta itemprop="keywords" content="Spring,AI,,Text2SQL,,è‡ªç„¶è¯­è¨€æŸ¥è¯¢,,NL2SQL,,Spring,Boot,,DeepSeek,,MCPå·¥å…·,,æ•°æ®åº“æŸ¥è¯¢,,AIç¼–ç¨‹,,æœºå™¨å­¦ä¹ ,,SQLç”Ÿæˆ,,æ™ºèƒ½æŸ¥è¯¢,,è‡ªç„¶è¯­è¨€å¤„ç†,,äººå·¥æ™ºèƒ½,,æ•°æ®åº“äº¤äº’,,æ™ºèƒ½SQL,,ä¸­æ–‡æŸ¥è¯¢,,ä¸šåŠ¡è§„åˆ™æ¨ç†,,å®‰å…¨é˜²æŠ¤,,æç¤ºè¯å·¥ç¨‹">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:title" content="Spring AI è®©æ•°æ®åº“å¬æ‡‚äººè¯ï¼šText2SQL è‡ªç„¶è¯­è¨€æŸ¥è¯¢å®è·µæŒ‡å—">
	<meta name="twitter:description" content="æ·±å…¥æ¢ç´¢ Spring AI &#43; DeepSeek å®ç° Text2SQL è‡ªç„¶è¯­è¨€æ•°æ®åº“æŸ¥è¯¢ï¼ŒåŒ…å«ç›´æ¥æ¨¡å¼ã€MCPå·¥å…·é›†æˆã€åˆ†æ­¥éª¤æŸ¥è¯¢ä¸‰ç§å®ç°æ–¹æ¡ˆï¼Œé™„å®Œæ•´æºç å’Œè¸©å‘ç»éªŒ">
	<meta name="twitter:image" content="https://csmos.oss-cn-beijing.aliyuncs.com/spring-ai-text2sql-showcase-01.png">

	<link rel="preconnect" href="//fonts.loli.net" crossorigin>
	<link rel="dns-prefetch" href="//fonts.loli.net">
	<link rel="stylesheet" href="https://fonts.loli.net/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="/css/style.css">

	<link rel="shortcut icon" href="/favicon.ico">
		
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="ChenSoul Blog" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/logo.svg" loading="lazy" alt="Site logo" width="60" height="60">
				</div><div class="logo__item logo__text">
					<div class="logo__title">ChenSoul Blog</div>
					<div class="logo__tagline">Javaã€Springã€Spring Bootã€MicroServicesã€Architectureã€Kubernetesã€DevOps</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">èœå•</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">é¦–é¡µ</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/categories/">
				
				<span class="menu__text">åˆ†ç±»</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">æ ‡ç­¾</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/index.xml">
				
				<span class="menu__text">è®¢é˜…</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">å…³äº</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring AI è®©æ•°æ®åº“å¬æ‡‚äººè¯ï¼šText2SQL è‡ªç„¶è¯­è¨€æŸ¥è¯¢å®è·µæŒ‡å—</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 1 1 0 28 1 1 0 0 1 0-28m0 3a3 3 0 1 0 0 22 3 3 0 0 0 0-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class="meta__text" datetime="2025-09-30">2025-09-30</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/ai/" rel="category">Ai</a>
	</span>
</div><div class="meta__item-tags meta__item"><svg class="meta__icon icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg><span class="meta__text"><a class="meta__link" href="/tags/java/" rel="tag">Java</a>, <a class="meta__link" href="/tags/spring-boot/" rel="tag">Spring-Boot</a>, <a class="meta__link" href="/tags/spring-ai/" rel="tag">Spring-Ai</a>, <a class="meta__link" href="/tags/tutorial/" rel="tag">Tutorial</a>
	</span>
</div>
</div>
		</header>
		
		<div class="content post__content clearfix">
			<p>&ldquo;èƒ½ä¸èƒ½è®©æ•°æ®åº“ç›´æ¥å¬æ‡‚ä¸­æ–‡é—®é¢˜ï¼Œç„¶åè‡ªåŠ¨ç”Ÿæˆ SQLï¼Ÿ&rdquo; è¿™ä¸ªæƒ³æ³•åœ¨æˆ‘è„‘æµ·ä¸­ç›˜æ—‹äº†å¾ˆä¹…ã€‚æœ€è¿‘ç»ˆäºç”¨ <strong>Spring AI</strong> å®ç°äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä»æœ€åˆçš„ç®€å•å®ç°åˆ°åæ¥çš„ <strong>MCP å·¥å…·é›†æˆ</strong>ï¼Œå†åˆ°<strong>åˆ†æ­¥éª¤æŸ¥è¯¢æ¨¡å¼</strong>ï¼Œæ•´ä¸ªè¿‡ç¨‹å……æ»¡äº†æƒŠå–œå’Œè¸©å‘ã€‚ä»Šå¤©å°±æ¥åˆ†äº«ä¸€ä¸‹æˆ‘çš„ <strong>Text2SQL</strong> å®è·µå¿ƒå¾—ã€‚</p>
<h2 id="æºä»£ç ">æºä»£ç </h2>
<p>å¦‚æœæ‚¨æƒ³äº²è‡ªå°è¯•ï¼Œå¯ä»¥éšæ—¶æŸ¥çœ‹æˆ‘çš„æºä»£ç ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¿…é¡»å…‹éš†æˆ‘çš„ç¤ºä¾‹ <a href="https://github.com/chensoul/spring-ai-text2sql-showcase" target="_blank">GitHub ä»“åº“</a>ã€‚ç„¶åï¼Œæ‚¨åªéœ€æŒ‰ç…§æˆ‘çš„è¯´æ˜è¿›è¡Œæ“ä½œå³å¯ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆé€‰æ‹©-text2sql">ä¸ºä»€ä¹ˆé€‰æ‹© Text2SQL</h2>
<p>æƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼šäº§å“ç»ç†é—®&quot;ä¸Šä¸ªæœˆæŠ€æœ¯éƒ¨çš„å¹³å‡å·¥èµ„æ˜¯å¤šå°‘ï¼Ÿ&quot;ï¼Œä½ ä¸éœ€è¦å†™å¤æ‚çš„ <strong>SQL æŸ¥è¯¢è¯­å¥</strong>ï¼Œåªéœ€è¦ç”¨<strong>è‡ªç„¶è¯­è¨€æè¿°</strong>ï¼Œç³»ç»Ÿå°±èƒ½è‡ªåŠ¨ç”Ÿæˆå¹¶æ‰§è¡ŒæŸ¥è¯¢ã€‚è¿™å°±æ˜¯ <strong>Text2SQL</strong>ï¼ˆä¹Ÿç§° <strong>NL2SQL</strong>ï¼‰çš„é­…åŠ›æ‰€åœ¨ã€‚</p>
<p>æˆ‘é€‰æ‹© <strong>Spring AI</strong> ä½œä¸º<strong>è‡ªç„¶è¯­è¨€å¤„ç†</strong>æ¡†æ¶ï¼Œä¸»è¦çœ‹ä¸­äº†å®ƒçš„ï¼š</p>
<ul>
<li><strong>ç®€å•æ˜“ç”¨</strong>ï¼šå‡ è¡Œé…ç½®å°±èƒ½æ¥å…¥å„ç§ <strong>LLM å¤§è¯­è¨€æ¨¡å‹</strong>ï¼ˆOpenAIã€DeepSeekã€é€šä¹‰åƒé—®ç­‰ï¼‰</li>
<li><strong>å·¥å…·é›†æˆ</strong>ï¼šæ”¯æŒ <strong>MCPï¼ˆModel Context Protocolï¼‰<strong>å·¥å…·è°ƒç”¨ï¼Œå®ç°</strong>å‡½æ•°è°ƒç”¨</strong>èƒ½åŠ›</li>
<li><strong>Spring ç”Ÿæ€</strong>ï¼šä¸ç°æœ‰ <strong>Spring Boot</strong> é¡¹ç›®æ— ç¼é›†æˆï¼Œæ”¯æŒ<strong>ä¾èµ–æ³¨å…¥</strong>å’Œ<strong>è‡ªåŠ¨é…ç½®</strong></li>
</ul>
<p><strong>æ ¸å¿ƒæŠ€æœ¯æ ˆ</strong> ï¼š</p>
<ul>
<li><strong>Spring Boot 3.5.6</strong> + <strong>Spring AI 1.1.0-M2</strong>ï¼ˆä¼ä¸šçº§ Java æ¡†æ¶ï¼‰</li>
<li><strong>MySQL 9</strong> (Dockerå®¹å™¨åŒ–éƒ¨ç½²)</li>
<li><strong>DeepSeek Chat API</strong>ï¼ˆå›½äº§å¤§è¯­è¨€æ¨¡å‹ï¼‰</li>
<li><strong>Bootstrap 5</strong> + <strong>Thymeleaf</strong>ï¼ˆå“åº”å¼å‰ç«¯æ¡†æ¶ï¼‰</li>
<li><strong>Maven</strong> æ„å»ºå·¥å…·</li>
</ul>
<p><strong>å…³é”®ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li>æ”¯æŒä¸‰ç§<strong>æ™ºèƒ½æŸ¥è¯¢æ¨¡å¼</strong>ï¼šç›´æ¥æ¨¡å¼ã€<strong>MCPå·¥å…·æ¨¡å¼</strong>ã€<strong>åˆ†æ­¥éª¤æ¨¡å¼</strong></li>
<li>å†…ç½®<strong>SQLæ³¨å…¥é˜²æŠ¤</strong>ï¼ˆä»…å…è®¸SELECTæŸ¥è¯¢ï¼Œé˜²æ­¢æ•°æ®æ³„éœ²ï¼‰</li>
<li><strong>ç°ä»£åŒ–Webç•Œé¢</strong>ï¼ˆæ”¯æŒç§»åŠ¨ç«¯é€‚é…ï¼‰</li>
<li><strong>æ•°æ®åº“ç»“æ„è‡ªåŠ¨è·å–</strong>ï¼ˆæ”¯æŒå¤šè¡¨å…³è”æŸ¥è¯¢ï¼‰</li>
</ul>
<h2 id="10-åˆ†é’Ÿå¿«é€Ÿä½“éªŒ">10 åˆ†é’Ÿå¿«é€Ÿä½“éªŒ</h2>
<p>è®©æˆ‘ä»¬å…ˆå¿«é€Ÿè·‘èµ·æ¥ï¼Œçœ‹çœ‹<strong>è‡ªç„¶è¯­è¨€æ•°æ®åº“æŸ¥è¯¢</strong>çš„æ•ˆæœå¦‚ä½•ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½® DeepSeek API Keyï¼ˆæ”¯æŒ OpenAIã€Claudeã€é€šä¹‰åƒé—®ç­‰å¤šç§ LLMï¼‰</span>
</span></span><span style="display:flex;"><span>export DEEPSEEK_API_KEY<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;your-deepseek-api-key-here&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯åŠ¨ MySQL æ•°æ®åº“å®¹å™¨ï¼ˆDocker å®¹å™¨åŒ–éƒ¨ç½²ï¼‰</span>
</span></span><span style="display:flex;"><span>docker-compose up -d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Maven ç¼–è¯‘å¹¶è¿è¡Œ Spring Boot åº”ç”¨</span>
</span></span><span style="display:flex;"><span>mvn clean spring-boot:run
</span></span></code></pre></div><p><strong>ç¬¬äºŒæ­¥ï¼šä½“éªŒæ™ºèƒ½æŸ¥è¯¢</strong></p>
<ul>
<li><strong>ç›´æ¥æŸ¥è¯¢æ¨¡å¼</strong>ï¼šhttp://localhost:8080 ï¼ˆå•æ­¥ SQL ç”Ÿæˆï¼‰</li>
<li><strong>åˆ†æ­¥éª¤æ¨¡å¼</strong>ï¼šhttp://localhost:8080/step ï¼ˆå¤šæ­¥æ¨ç†æŸ¥è¯¢ï¼‰</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>å°è´´å£«</strong>ï¼šé¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨æ‰§è¡Œ<strong>æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬</strong>ï¼ŒåŠ è½½å‘˜å·¥ã€éƒ¨é—¨ã€é¡¹ç›®ç¤ºä¾‹æ•°æ®ã€‚</p></blockquote>
<h2 id="ç¬¬ä¸€ç‰ˆç®€å•ç²—æš´çš„ç›´æ¥æ¨¡å¼">ç¬¬ä¸€ç‰ˆï¼šç®€å•ç²—æš´çš„ç›´æ¥æ¨¡å¼</h2>
<p>æœ€å¼€å§‹ï¼Œæˆ‘é‡‡ç”¨äº†æœ€ç®€å•ç›´æ¥çš„æ–¹å¼ï¼šæŠŠ<strong>æ•°æ®åº“ Schema</strong> ä½œä¸º<strong>ä¸Šä¸‹æ–‡ä¿¡æ¯</strong>æ³¨å…¥åˆ°<strong>æç¤ºè¯å·¥ç¨‹</strong>ä¸­ï¼Œè®© <strong>LLM å¤§è¯­è¨€æ¨¡å‹</strong>ç›´æ¥ç”Ÿæˆ SQLã€‚è¿™ç§<strong>é›¶æ ·æœ¬å­¦ä¹ </strong>æ–¹å¼è™½ç„¶ç®€å•ï¼Œä½†æ•ˆæœå‡ºå¥‡åœ°å¥½ã€‚</p>
<p><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼š<strong>æ•°æ®åº“ç»“æ„</strong> + <strong>ç”¨æˆ·é—®é¢˜</strong> â†’ <strong>AI æ¨¡å‹æ¨ç†</strong> â†’ <strong>SQL è¯­å¥</strong> â†’ <strong>å®‰å…¨æ ¡éªŒ</strong> â†’ <strong>æ‰§è¡ŒæŸ¥è¯¢</strong></p>
<h3 id="ç³»ç»Ÿæ¶æ„å›¾">ç³»ç»Ÿæ¶æ„å›¾</h3>
<pre class="mermaid">
	flowchart LR
User[Browser UI] --&gt; Controller[REST Controller]
Controller --&gt; Service[DirectText2SqlService]
Service --&gt; ChatClient[Spring AI ChatClient]
Service --&gt; DatabaseTool[JdbcTemplate Tool]
ChatClient --&gt; DeepSeek[DeepSeek Chat API]
DatabaseTool --&gt; MySQL[MySQL Database]
</pre>
<h3 id="æ ¸å¿ƒä»£ç å®ç°">æ ¸å¿ƒä»£ç å®ç°</h3>
<p>è®©æˆ‘æ¥å±•ç¤ºä¸€ä¸‹æœ€æ ¸å¿ƒçš„ <code>DirectText2SqlService</code> ç±»ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Slf4j</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RequiredArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DirectText2SqlService</span> <span style="color:#66d9ef">implements</span> Text2SqlService {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> ChatClient chatClient;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> DatabaseTool databaseTool;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// SQL ç”Ÿæˆæç¤ºæ¨¡æ¿</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String SQL_GENERATION_PROMPT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ SQL ç”ŸæˆåŠ©æ‰‹ã€‚åŸºäºä»¥ä¸‹æ•°æ®åº“ç»“æ„ä¿¡æ¯ï¼Œå°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢è½¬æ¢ä¸º SQL è¯­å¥ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            æ•°æ®åº“ç»“æ„ä¿¡æ¯ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            {schema}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            è¯·éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            1. åªç”Ÿæˆ SELECT æŸ¥è¯¢è¯­å¥
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            2. ä½¿ç”¨æ­£ç¡®çš„è¡¨åå’Œå­—æ®µå
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            3. æ·»åŠ é€‚å½“çš„ WHERE æ¡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            4. ä½¿ç”¨ LIMIT é™åˆ¶ç»“æœæ•°é‡ï¼ˆæœ€å¤š 1000 æ¡ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            5. ç¡®ä¿ SQL è¯­æ³•æ­£ç¡®
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            6. å¦‚æœæŸ¥è¯¢æ¶‰åŠå¤šè¡¨ï¼Œè¯·ä½¿ç”¨é€‚å½“çš„ JOIN
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            7. åªè¿”å› SQL è¯­å¥ï¼Œä¸è¦åŒ…å«å…¶ä»–è§£é‡Š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ç”¨æˆ·æŸ¥è¯¢ï¼š{userQuery}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸º SQL å¹¶æ‰§è¡ŒæŸ¥è¯¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @param userQuery ç”¨æˆ·è‡ªç„¶è¯­è¨€æŸ¥è¯¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @return æŸ¥è¯¢ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Text2SqlResult <span style="color:#a6e22e">processQuery</span>(String userQuery) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 1. éªŒè¯è¾“å…¥</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (userQuery <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> userQuery.<span style="color:#a6e22e">trim</span>().<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;æŸ¥è¯¢å†…å®¹ä¸èƒ½ä¸ºç©º&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 2. ç”Ÿæˆ SQL</span>
</span></span><span style="display:flex;"><span>            String sql <span style="color:#f92672">=</span> generateSql(userQuery);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (sql <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> sql.<span style="color:#a6e22e">trim</span>().<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;æ— æ³•ç”Ÿæˆæœ‰æ•ˆçš„SQLæŸ¥è¯¢ï¼Œè¯·æ£€æŸ¥æ‚¨çš„æŸ¥è¯¢æè¿°&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 3. éªŒè¯ SQL å®‰å…¨æ€§</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>SqlUtils.<span style="color:#a6e22e">isSqlSafe</span>(sql)) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;ç”Ÿæˆçš„ SQL åŒ…å«ä¸å®‰å…¨çš„æ“ä½œï¼Œè¯·é‡æ–°æè¿°æ‚¨çš„æŸ¥è¯¢éœ€æ±‚&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#34;sql: {}&#34;</span>, sql);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 4. æ‰§è¡Œ SQL æŸ¥è¯¢</span>
</span></span><span style="display:flex;"><span>            List<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;&gt;</span> results <span style="color:#f92672">=</span> databaseTool.<span style="color:#a6e22e">executeQuery</span>(sql);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">success</span>(sql, results);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;å¤„ç†æŸ¥è¯¢æ—¶å‘ç”Ÿé”™è¯¯: {}&#34;</span>, e.<span style="color:#a6e22e">getMessage</span>(), e);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;å¤„ç†æŸ¥è¯¢æ—¶å‘ç”Ÿé”™è¯¯: &#34;</span> <span style="color:#f92672">+</span> e.<span style="color:#a6e22e">getMessage</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * ç”Ÿæˆ SQL æŸ¥è¯¢è¯­å¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">generateSql</span>(String userQuery) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// è·å–æ•°æ®åº“ç»“æ„ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>        String schema <span style="color:#f92672">=</span> databaseTool.<span style="color:#a6e22e">getDatabaseSchema</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// åˆ›å»ºæç¤ºæ¨¡æ¿</span>
</span></span><span style="display:flex;"><span>        PromptTemplate promptTemplate <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PromptTemplate(SQL_GENERATION_PROMPT);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ„å»ºæç¤º</span>
</span></span><span style="display:flex;"><span>        Prompt prompt <span style="color:#f92672">=</span> promptTemplate.<span style="color:#a6e22e">create</span>(Map.<span style="color:#a6e22e">of</span>(
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;schema&#34;</span>, schema,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;userQuery&#34;</span>, userQuery
</span></span><span style="display:flex;"><span>        ));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// è°ƒç”¨ AI ç”Ÿæˆ SQL</span>
</span></span><span style="display:flex;"><span>        ChatResponse response <span style="color:#f92672">=</span> chatClient.<span style="color:#a6e22e">prompt</span>(prompt).<span style="color:#a6e22e">call</span>().<span style="color:#a6e22e">chatResponse</span>();
</span></span><span style="display:flex;"><span>        String sql <span style="color:#f92672">=</span> response.<span style="color:#a6e22e">getResult</span>().<span style="color:#a6e22e">getOutput</span>().<span style="color:#a6e22e">getText</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ¸…ç† SQL è¯­å¥ï¼ˆç§»é™¤å¯èƒ½çš„ä»£ç å—æ ‡è®°ï¼‰</span>
</span></span><span style="display:flex;"><span>        sql <span style="color:#f92672">=</span> sql.<span style="color:#a6e22e">replaceAll</span>(<span style="color:#e6db74">&#34;```sql&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>).<span style="color:#a6e22e">replaceAll</span>(<span style="color:#e6db74">&#34;```&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>).<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sql;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ ¸å¿ƒé…ç½®">æ ¸å¿ƒé…ç½®</h3>
<p>è®©æˆ‘æ¥å±•ç¤ºä¸€ä¸‹å…³é”®çš„é…ç½®æ–‡ä»¶ã€‚é¦–å…ˆæ˜¯ <code>application.yml</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">spring</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">datasource</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">url</span>: <span style="color:#ae81ff">jdbc:mysql://localhost:3306/text2sql_db?useUnicode=true&amp;characterEncoding=UTF-8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">username</span>: <span style="color:#ae81ff">root</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">password</span>: <span style="color:#ae81ff">root123</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ai</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">openai</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">base-url</span>: <span style="color:#ae81ff">https://api.deepseek.com</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">api-key</span>: <span style="color:#ae81ff">${DEEPSEEK_API_KEY}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">chat</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">options</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">model</span>: <span style="color:#ae81ff">deepseek-chat</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">temperature</span>: <span style="color:#ae81ff">0.1</span>
</span></span></code></pre></div><p>ç„¶åæ˜¯ <code>docker-compose.yml</code> çš„æ•°æ®åº“é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">mysql</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">mysql:8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">text2sql-mysql</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_ROOT_PASSWORD</span>: <span style="color:#ae81ff">root123</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_DATABASE</span>: <span style="color:#ae81ff">text2sql_db</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;3306:3306&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./mysql.cnf:/etc/mysql/conf.d/mysql.cnf</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./src/main/resources/schema.sql:/docker-entrypoint-initdb.d/01-schema.sql</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./src/main/resources/data.sql:/docker-entrypoint-initdb.d/02-data.sql</span>
</span></span></code></pre></div><h3 id="spring-ai-é…ç½®ç±»">Spring AI é…ç½®ç±»</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AppConfig</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> ChatClient <span style="color:#a6e22e">chatClient</span>(OpenAiChatModel chatModel) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ChatClient.<span style="color:#a6e22e">builder</span>(chatModel)
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">defaultAdvisors</span>(<span style="color:#66d9ef">new</span> SimpleLoggerAdvisor())
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¿™ä¸ªé…ç½®ç±»åšäº†ä¸€ä»¶äº‹ï¼š</p>
<ol>
<li><strong>åŸºç¡€ ChatClient</strong>ï¼šç”¨äºç›´æ¥æ¨¡å¼çš„ SQL ç”Ÿæˆ</li>
</ol>
<h3 id="api-æ¥å£è®¾è®¡">API æ¥å£è®¾è®¡</h3>
<p>æˆ‘è®¾è®¡äº†ä¸¤ä¸ªæ ¸å¿ƒæ¥å£ï¼š</p>
<ul>
<li><strong>æŸ¥è¯¢æ¥å£</strong>ï¼š<code>POST /api/query</code> - æ¥æ”¶è‡ªç„¶è¯­è¨€é—®é¢˜ï¼Œè¿”å› SQL å’ŒæŸ¥è¯¢ç»“æœ</li>
<li><strong>ç»“æ„æ¥å£</strong>ï¼š<code>GET /api/schema</code> - è·å–æ•°æ®åº“ç»“æ„ä¿¡æ¯</li>
</ul>
<h3 id="rest-controller-å®ç°">REST Controller å®ç°</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Controller</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RequiredArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Text2SqlController</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Text2SqlService text2SqlService;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> DatabaseTool databaseTool;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * å¤„ç†è‡ªç„¶è¯­è¨€æŸ¥è¯¢çš„ API æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@PostMapping</span>(<span style="color:#e6db74">&#34;/api/query&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@ResponseBody</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> ResponseEntity<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;&gt;</span> <span style="color:#a6e22e">processQuery</span>(<span style="color:#a6e22e">@RequestBody</span> Map<span style="color:#f92672">&lt;</span>String, String<span style="color:#f92672">&gt;</span> request) {
</span></span><span style="display:flex;"><span>        String query <span style="color:#f92672">=</span> request.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;query&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (query <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> query.<span style="color:#a6e22e">trim</span>().<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>            Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> response <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>            response.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;success&#34;</span>, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>            response.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;error&#34;</span>, <span style="color:#e6db74">&#34;æŸ¥è¯¢å†…å®¹ä¸èƒ½ä¸ºç©º&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> ResponseEntity.<span style="color:#a6e22e">badRequest</span>().<span style="color:#a6e22e">body</span>(response);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å¤„ç†æŸ¥è¯¢</span>
</span></span><span style="display:flex;"><span>        Text2SqlResult result <span style="color:#f92672">=</span> text2SqlService.<span style="color:#a6e22e">processQuery</span>(query);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> response <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        response.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;success&#34;</span>, result.<span style="color:#a6e22e">isSuccess</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (result.<span style="color:#a6e22e">isSuccess</span>()) {
</span></span><span style="display:flex;"><span>            response.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;sql&#34;</span>, result.<span style="color:#a6e22e">getSql</span>());
</span></span><span style="display:flex;"><span>            response.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;data&#34;</span>, result.<span style="color:#a6e22e">getData</span>());
</span></span><span style="display:flex;"><span>            response.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;count&#34;</span>, result.<span style="color:#a6e22e">getData</span>().<span style="color:#a6e22e">size</span>());
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            response.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;error&#34;</span>, result.<span style="color:#a6e22e">getError</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ResponseEntity.<span style="color:#a6e22e">ok</span>(response);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * è·å–æ•°æ®åº“ç»“æ„ä¿¡æ¯çš„ API
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@GetMapping</span>(<span style="color:#e6db74">&#34;/api/schema&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@ResponseBody</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> ResponseEntity<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String, String<span style="color:#f92672">&gt;&gt;</span> <span style="color:#a6e22e">getSchema</span>() {
</span></span><span style="display:flex;"><span>        Map<span style="color:#f92672">&lt;</span>String, String<span style="color:#f92672">&gt;</span> response <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        response.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;schema&#34;</span>, databaseTool.<span style="color:#a6e22e">getDatabaseSchema</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ResponseEntity.<span style="color:#a6e22e">ok</span>(response);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è®©æˆ‘ä»¬çœ‹çœ‹å®é™…çš„ä½¿ç”¨æ•ˆæœï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST http://localhost:8080/api/query <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -H <span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -d <span style="color:#e6db74">&#39;{&#34;query&#34;: &#34;ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨çš„å‘˜å·¥æ•°é‡&#34;}&#39;</span>
</span></span></code></pre></div><p><strong>è¿”å›ç»“æœ</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;success&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;sql&#34;</span>: <span style="color:#e6db74">&#34;SELECT department, COUNT(*) as count FROM employees GROUP BY department&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;data&#34;</span>: [ { <span style="color:#f92672">&#34;department&#34;</span>: <span style="color:#e6db74">&#34;æŠ€æœ¯éƒ¨&#34;</span>, <span style="color:#f92672">&#34;count&#34;</span>: <span style="color:#ae81ff">3</span> } ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;count&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>çœ‹åˆ°æ²¡ï¼ŸAI ä¸ä»…ç”Ÿæˆäº†æ­£ç¡®çš„ SQLï¼Œè¿˜ç›´æ¥è¿”å›äº†æŸ¥è¯¢ç»“æœï¼è¿™å°±æ˜¯ Text2SQL çš„é­…åŠ›ã€‚</p>
<h3 id="å‰ç«¯ç•Œé¢å±•ç¤º">å‰ç«¯ç•Œé¢å±•ç¤º</h3>
<p>æˆ‘è®¾è®¡äº†ä¸€ä¸ªç®€æ´ç¾è§‚çš„ Web ç•Œé¢ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿç›´è§‚åœ°ä½“éªŒ Text2SQL åŠŸèƒ½ï¼š</p>
<p><img src="https://csmos.oss-cn-beijing.aliyuncs.com/spring-ai-text2sql-showcase-01.png" alt="Spring AI Text2SQL ç›´æ¥æ¨¡å¼ç•Œé¢å±•ç¤º - è‡ªç„¶è¯­è¨€æ•°æ®åº“æŸ¥è¯¢ç³»ç»Ÿå‰ç«¯ç•Œé¢ï¼ŒåŒ…å«ä¸­æ–‡æŸ¥è¯¢è¾“å…¥æ¡†ã€ç¤ºä¾‹æŸ¥è¯¢æ¨¡æ¿ã€SQLç”Ÿæˆç»“æœå±•ç¤ºå’Œæ•°æ®åº“ç»“æ„æŸ¥çœ‹åŠŸèƒ½"></p>
<p><strong>ä¸»è¦åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li><strong>è‡ªç„¶è¯­è¨€è¾“å…¥</strong>ï¼šç”¨æˆ·å¯ä»¥ç›´æ¥ç”¨ä¸­æ–‡æè¿°æŸ¥è¯¢éœ€æ±‚</li>
<li><strong>ç¤ºä¾‹æŸ¥è¯¢</strong>ï¼šæä¾›å¸¸ç”¨çš„æŸ¥è¯¢æ¨¡æ¿ï¼Œç‚¹å‡»å³å¯ä½¿ç”¨</li>
<li><strong>å®æ—¶ç»“æœå±•ç¤º</strong>ï¼šæ˜¾ç¤ºç”Ÿæˆçš„ SQL å’ŒæŸ¥è¯¢ç»“æœ</li>
<li><strong>æ•°æ®åº“ç»“æ„æŸ¥çœ‹</strong>ï¼šå¯ä»¥æŸ¥çœ‹å®Œæ•´çš„æ•°æ®åº“ç»“æ„ä¿¡æ¯</li>
</ul>
<p><strong>ç•Œé¢ç‰¹è‰²</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ Bootstrap 5 æ„å»ºï¼Œå“åº”å¼è®¾è®¡</li>
<li>æ¸å˜è‰²èƒŒæ™¯ï¼Œè§†è§‰æ•ˆæœç°ä»£</li>
<li>ä»£ç é«˜äº®æ˜¾ç¤ºï¼ŒSQL è¯­å¥æ¸…æ™°å¯è¯»</li>
<li>è¡¨æ ¼ç»“æœå±•ç¤ºï¼Œæ•°æ®ä¸€ç›®äº†ç„¶</li>
</ul>
<p><strong>ç¤ºä¾‹æ•°æ®è¡¨ç»“æ„</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#75715e">-- å‘˜å·¥è¡¨æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">IGNORE</span> <span style="color:#66d9ef">INTO</span> employees (name, department, <span style="color:#66d9ef">position</span>, salary, hire_date, email) <span style="color:#66d9ef">VALUES</span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;å¼ ä¸‰&#39;</span>, <span style="color:#e6db74">&#39;æŠ€æœ¯éƒ¨&#39;</span>, <span style="color:#e6db74">&#39;é«˜çº§å·¥ç¨‹å¸ˆ&#39;</span>, <span style="color:#ae81ff">15000</span>, <span style="color:#e6db74">&#39;2022-01-15&#39;</span>, <span style="color:#e6db74">&#39;zhangsan@company.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;æå››&#39;</span>, <span style="color:#e6db74">&#39;æŠ€æœ¯éƒ¨&#39;</span>, <span style="color:#e6db74">&#39;å·¥ç¨‹å¸ˆ&#39;</span>, <span style="color:#ae81ff">12000</span>, <span style="color:#e6db74">&#39;2022-03-20&#39;</span>, <span style="color:#e6db74">&#39;lisi@company.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;ç‹äº”&#39;</span>, <span style="color:#e6db74">&#39;é”€å”®éƒ¨&#39;</span>, <span style="color:#e6db74">&#39;é”€å”®ç»ç†&#39;</span>, <span style="color:#ae81ff">18000</span>, <span style="color:#e6db74">&#39;2021-11-10&#39;</span>, <span style="color:#e6db74">&#39;wangwu@company.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;èµµå…­&#39;</span>, <span style="color:#e6db74">&#39;é”€å”®éƒ¨&#39;</span>, <span style="color:#e6db74">&#39;é”€å”®ä»£è¡¨&#39;</span>, <span style="color:#ae81ff">10000</span>, <span style="color:#e6db74">&#39;2023-02-01&#39;</span>, <span style="color:#e6db74">&#39;zhaoliu@company.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;é’±ä¸ƒ&#39;</span>, <span style="color:#e6db74">&#39;äººäº‹éƒ¨&#39;</span>, <span style="color:#e6db74">&#39;äººäº‹ç»ç†&#39;</span>, <span style="color:#ae81ff">16000</span>, <span style="color:#e6db74">&#39;2021-08-05&#39;</span>, <span style="color:#e6db74">&#39;qianqi@company.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;å­™å…«&#39;</span>, <span style="color:#e6db74">&#39;è´¢åŠ¡éƒ¨&#39;</span>, <span style="color:#e6db74">&#39;ä¼šè®¡å¸ˆ&#39;</span>, <span style="color:#ae81ff">14000</span>, <span style="color:#e6db74">&#39;2022-06-15&#39;</span>, <span style="color:#e6db74">&#39;sunba@company.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;å‘¨ä¹&#39;</span>, <span style="color:#e6db74">&#39;æŠ€æœ¯éƒ¨&#39;</span>, <span style="color:#e6db74">&#39;æ¶æ„å¸ˆ&#39;</span>, <span style="color:#ae81ff">25000</span>, <span style="color:#e6db74">&#39;2020-12-01&#39;</span>, <span style="color:#e6db74">&#39;zhoujiu@company.com&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;å´å&#39;</span>, <span style="color:#e6db74">&#39;å¸‚åœºéƒ¨&#39;</span>, <span style="color:#e6db74">&#39;å¸‚åœºä¸“å‘˜&#39;</span>, <span style="color:#ae81ff">11000</span>, <span style="color:#e6db74">&#39;2023-01-10&#39;</span>, <span style="color:#e6db74">&#39;wushi@company.com&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- é¡¹ç›®è¡¨æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">IGNORE</span> <span style="color:#66d9ef">INTO</span> projects (name, description, start_date, end_date, status, budget) <span style="color:#66d9ef">VALUES</span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;ç”µå•†å¹³å°é‡æ„&#39;</span>, <span style="color:#e6db74">&#39;é‡æ„ç°æœ‰ç”µå•†å¹³å°ï¼Œæå‡æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ&#39;</span>, <span style="color:#e6db74">&#39;2023-01-01&#39;</span>, <span style="color:#e6db74">&#39;2023-06-30&#39;</span>, <span style="color:#e6db74">&#39;è¿›è¡Œä¸­&#39;</span>, <span style="color:#ae81ff">500000</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;ç§»åŠ¨ç«¯åº”ç”¨å¼€å‘&#39;</span>, <span style="color:#e6db74">&#39;å¼€å‘å…¬å¸ç§»åŠ¨ç«¯åº”ç”¨&#39;</span>, <span style="color:#e6db74">&#39;2023-03-01&#39;</span>, <span style="color:#e6db74">&#39;2023-08-31&#39;</span>, <span style="color:#e6db74">&#39;è¿›è¡Œä¸­&#39;</span>, <span style="color:#ae81ff">300000</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;æ•°æ®åˆ†æç³»ç»Ÿ&#39;</span>, <span style="color:#e6db74">&#39;æ„å»ºä¼ä¸šæ•°æ®åˆ†æå¹³å°&#39;</span>, <span style="color:#e6db74">&#39;2022-10-01&#39;</span>, <span style="color:#e6db74">&#39;2023-02-28&#39;</span>, <span style="color:#e6db74">&#39;å·²å®Œæˆ&#39;</span>, <span style="color:#ae81ff">200000</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;å®¢æˆ·ç®¡ç†ç³»ç»Ÿ&#39;</span>, <span style="color:#e6db74">&#39;å‡çº§å®¢æˆ·å…³ç³»ç®¡ç†ç³»ç»Ÿ&#39;</span>, <span style="color:#e6db74">&#39;2023-02-15&#39;</span>, <span style="color:#e6db74">&#39;2023-07-15&#39;</span>, <span style="color:#e6db74">&#39;è¿›è¡Œä¸­&#39;</span>, <span style="color:#ae81ff">150000</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;è´¢åŠ¡ç³»ç»Ÿä¼˜åŒ–&#39;</span>, <span style="color:#e6db74">&#39;ä¼˜åŒ–è´¢åŠ¡ç³»ç»Ÿæ€§èƒ½&#39;</span>, <span style="color:#e6db74">&#39;2022-12-01&#39;</span>, <span style="color:#e6db74">&#39;2023-01-31&#39;</span>, <span style="color:#e6db74">&#39;å·²å®Œæˆ&#39;</span>, <span style="color:#ae81ff">80000</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- é¡¹ç›®æˆå‘˜å…³ç³»è¡¨æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">IGNORE</span> <span style="color:#66d9ef">INTO</span> project_members (project_id, employee_id, <span style="color:#66d9ef">role</span>, join_date) <span style="color:#66d9ef">VALUES</span>
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;å¼€å‘è´Ÿè´£äºº&#39;</span>, <span style="color:#e6db74">&#39;2023-01-01&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;å¼€å‘å·¥ç¨‹å¸ˆ&#39;</span>, <span style="color:#e6db74">&#39;2023-01-01&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#e6db74">&#39;æŠ€æœ¯æ¶æ„å¸ˆ&#39;</span>, <span style="color:#e6db74">&#39;2023-01-01&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;é¡¹ç›®ç»ç†&#39;</span>, <span style="color:#e6db74">&#39;2023-03-01&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;å¼€å‘å·¥ç¨‹å¸ˆ&#39;</span>, <span style="color:#e6db74">&#39;2023-03-01&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#e6db74">&#39;æŠ€æœ¯è´Ÿè´£äºº&#39;</span>, <span style="color:#e6db74">&#39;2022-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#e6db74">&#39;æ•°æ®åˆ†æå¸ˆ&#39;</span>, <span style="color:#e6db74">&#39;2022-10-01&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;é¡¹ç›®ç»ç†&#39;</span>, <span style="color:#e6db74">&#39;2023-02-15&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;ä¸šåŠ¡åˆ†æå¸ˆ&#39;</span>, <span style="color:#e6db74">&#39;2023-02-15&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#e6db74">&#39;é¡¹ç›®ç»ç†&#39;</span>, <span style="color:#e6db74">&#39;2022-12-01&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- éƒ¨é—¨è¡¨æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">IGNORE</span> <span style="color:#66d9ef">INTO</span> departments (name, manager_id, budget, <span style="color:#66d9ef">location</span>) <span style="color:#66d9ef">VALUES</span>
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;æŠ€æœ¯éƒ¨&#39;</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2000000</span>, <span style="color:#e6db74">&#39;åŒ—äº¬&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;é”€å”®éƒ¨&#39;</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1500000</span>, <span style="color:#e6db74">&#39;ä¸Šæµ·&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;äººäº‹éƒ¨&#39;</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">800000</span>, <span style="color:#e6db74">&#39;åŒ—äº¬&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;è´¢åŠ¡éƒ¨&#39;</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">600000</span>, <span style="color:#e6db74">&#39;åŒ—äº¬&#39;</span>),
</span></span><span style="display:flex;"><span>(<span style="color:#e6db74">&#39;å¸‚åœºéƒ¨&#39;</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">1000000</span>, <span style="color:#e6db74">&#39;ä¸Šæµ·&#39;</span>);
</span></span></code></pre></div><h2 id="ç¬¬äºŒç‰ˆmcp-å·¥å…·é›†æˆæ¨¡å¼---è®©-ai-æ›´èªæ˜">ç¬¬äºŒç‰ˆï¼šMCP å·¥å…·é›†æˆæ¨¡å¼ - è®© AI æ›´èªæ˜</h2>
<p>ç›´æ¥æ¨¡å¼è™½ç„¶ç®€å•ï¼Œä½†é‡åˆ°<strong>å¤æ‚æ•°æ®åº“æŸ¥è¯¢</strong>æ—¶å°±å¼€å§‹åŠ›ä¸ä»å¿ƒäº†ã€‚æ¯”å¦‚<strong>å¤šè¡¨å…³è”æŸ¥è¯¢</strong>ã€<strong>å­—æ®µè¯­ä¹‰ç†è§£</strong>ç­‰æƒ…å†µï¼ŒAI å®¹æ˜“äº§ç”Ÿ<strong>å¹»è§‰é—®é¢˜</strong>ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘å¼•å…¥äº† <strong>MCPï¼ˆModel Context Protocolï¼‰å·¥å…·é›†æˆ</strong>ï¼Œè®© <strong>LLM å¤§è¯­è¨€æ¨¡å‹</strong>èƒ½å¤Ÿï¼š</p>
<ol>
<li><strong>å…ˆè®¤çŸ¥</strong>ï¼šé€šè¿‡<strong>å‡½æ•°è°ƒç”¨</strong>è·å–çœŸå®çš„<strong>æ•°æ®åº“ Schema</strong></li>
<li><strong>å†ç”Ÿæˆ</strong>ï¼šåŸºäºçœŸå®ç»“æ„ç”Ÿæˆ<strong>ç²¾å‡† SQL</strong></li>
<li><strong>åéªŒè¯</strong>ï¼šæ‰§è¡Œå‰å…ˆåš<strong>è¯­æ³•æ ¡éªŒ</strong>å’Œ<strong>å®‰å…¨æ£€æŸ¥</strong></li>
</ol>
<h3 id="ä¸ºä»€ä¹ˆéœ€è¦-mcp-å·¥å…·è°ƒç”¨">ä¸ºä»€ä¹ˆéœ€è¦ MCP å·¥å…·è°ƒç”¨ï¼Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ çš„æ•°æ®åº“æœ‰ 50 å¼ è¡¨ï¼Œæ¯å¼ è¡¨éƒ½æœ‰å¤æ‚çš„<strong>å¤–é”®å…³è”</strong>ã€‚å¦‚æœæŠŠè¿™äº›ä¿¡æ¯éƒ½å¡è¿›<strong>æç¤ºè¯ä¸Šä¸‹æ–‡</strong>ï¼Œä¸ä»…ä¼šè¶…å‡º<strong>æ¨¡å‹ä¸Šä¸‹æ–‡çª—å£</strong>é™åˆ¶ï¼Œè¿˜å®¹æ˜“è®© AI äº§ç”Ÿ<strong>æ•°æ®å¹»è§‰</strong>ã€‚</p>
<p><strong>MCP å·¥å…·æ¨¡å¼</strong>çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>åŠ¨æ€è·å–</strong>ï¼šå®æ—¶ä»æ•°æ®åº“è·å–<strong>å…ƒæ•°æ®ä¿¡æ¯</strong>ï¼Œé¿å…è¿‡æ—¶æ•°æ®</li>
<li><strong>å®‰å…¨éªŒè¯</strong>ï¼šç”Ÿæˆ SQL åå…ˆåš<strong>è¯­æ³•æ£€æŸ¥</strong>ï¼Œç¡®ä¿æŸ¥è¯¢æ­£ç¡®</li>
<li><strong>æ™ºèƒ½çº é”™</strong>ï¼šå¦‚æœ SQL æœ‰é—®é¢˜ï¼ŒAI å¯ä»¥æ ¹æ®<strong>é”™è¯¯ä¿¡æ¯</strong>è‡ªåŠ¨ä¿®æ­£</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li><strong>å¤æ‚å¤šè¡¨å…³è”æŸ¥è¯¢</strong>ï¼ˆJOINã€å­æŸ¥è¯¢ï¼‰</li>
<li>å¯¹<strong>å­—æ®µè¯­ä¹‰</strong>æ•æ„Ÿçš„æŸ¥è¯¢</li>
<li>éœ€è¦<strong>é«˜å‡†ç¡®æ€§</strong>çš„ç”Ÿäº§ç¯å¢ƒ</li>
</ul>
<h3 id="mcp-å·¥å…·è°ƒç”¨æµç¨‹å›¾">MCP å·¥å…·è°ƒç”¨æµç¨‹å›¾</h3>
<pre class="mermaid">
	sequenceDiagram
    participant User as ç”¨æˆ·
    participant Controller as REST Controller
    participant Service as MCP Text2SQL Service
    participant AI as AI æ¨¡å‹
    participant Tool as æ•°æ®åº“å·¥å…·
    participant DB as MySQL æ•°æ®åº“

    User-&gt;&gt;Controller: å‘é€è‡ªç„¶è¯­è¨€æŸ¥è¯¢
    Controller-&gt;&gt;Service: å¤„ç†æŸ¥è¯¢è¯·æ±‚
    Service-&gt;&gt;AI: è¯·æ±‚è·å–æ•°æ®åº“ç»“æ„
    AI-&gt;&gt;Tool: è°ƒç”¨ getDatabaseSchema å·¥å…·
    Tool-&gt;&gt;DB: æŸ¥è¯¢ INFORMATION_SCHEMA
    DB--&gt;&gt;Tool: è¿”å›è¡¨ç»“æ„ä¿¡æ¯
    Tool--&gt;&gt;AI: è¿”å›ç»“æ„æ•°æ®
    AI--&gt;&gt;Service: è¿”å›ç»“æ„ä¿¡æ¯
    Service-&gt;&gt;AI: åŸºäºç»“æ„ç”Ÿæˆ SQL
    AI--&gt;&gt;Service: è¿”å›ç”Ÿæˆçš„ SQL
    Service-&gt;&gt;AI: è¯·æ±‚éªŒè¯ SQLï¼ˆå°èŒƒå›´æµ‹è¯•ï¼‰
    AI-&gt;&gt;Tool: è°ƒç”¨ executeQuery å·¥å…·ï¼ˆLIMIT 1ï¼‰
    Tool-&gt;&gt;DB: æ‰§è¡Œæµ‹è¯•æŸ¥è¯¢
    DB--&gt;&gt;Tool: è¿”å›æµ‹è¯•ç»“æœ
    Tool--&gt;&gt;AI: è¿”å›éªŒè¯ç»“æœ
    AI--&gt;&gt;Service: è¿”å›éªŒè¯é€šè¿‡/å¤±è´¥ä¿¡æ¯
    
    alt SQL éªŒè¯é€šè¿‡
        Service-&gt;&gt;Tool: æ‰§è¡Œå®Œæ•´æŸ¥è¯¢
        Tool-&gt;&gt;DB: æ‰§è¡Œå®Œæ•´ SQL
        DB--&gt;&gt;Tool: è¿”å›å®Œæ•´ç»“æœ
        Tool--&gt;&gt;Service: è¿”å›æŸ¥è¯¢ç»“æœ
        Service--&gt;&gt;Controller: è¿”å›æˆåŠŸç»“æœ
        Controller--&gt;&gt;User: è¿”å› SQL å’ŒæŸ¥è¯¢ç»“æœ
    else SQL éªŒè¯å¤±è´¥
        Service-&gt;&gt;AI: è¯·æ±‚ä¿®æ­£ SQL
        AI--&gt;&gt;Service: è¿”å›ä¿®æ­£åçš„ SQL
        Service-&gt;&gt;AI: å†æ¬¡éªŒè¯ä¿®æ­£åçš„ SQL
        AI--&gt;&gt;Service: è¿”å›éªŒè¯ç»“æœ
        Service--&gt;&gt;Controller: è¿”å›é”™è¯¯æˆ–ä¿®æ­£åçš„ç»“æœ
        Controller--&gt;&gt;User: è¿”å›é”™è¯¯ä¿¡æ¯æˆ–ä¿®æ­£åçš„ç»“æœ
    end
</pre>
<h3 id="spring-ai-é…ç½®ç±»-1">Spring AI é…ç½®ç±»</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AppConfig</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> ChatClient <span style="color:#a6e22e">chatClient</span>(OpenAiChatModel chatModel) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ChatClient.<span style="color:#a6e22e">builder</span>(chatModel).<span style="color:#a6e22e">defaultAdvisors</span>(<span style="color:#66d9ef">new</span> SimpleLoggerAdvisor()).<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Bean</span>(<span style="color:#e6db74">&#34;mcpChatClient&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> ChatClient <span style="color:#a6e22e">mcpChatClient</span>(ChatClient.<span style="color:#a6e22e">Builder</span> chatClientBuilder, DatabaseTool databaseTool) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> chatClientBuilder
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">defaultTools</span>(databaseTool)
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>mcpChatClient è®¾ç½®äº†é»˜è®¤çš„å·¥å…· databaseToolï¼ŒDatabaseTool çš„æ–¹æ³•éœ€è¦æ·»åŠ  MCP çš„ @Tool æ³¨è§£ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Slf4j</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Service</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RequiredArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DatabaseTool</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> JdbcTemplate jdbcTemplate;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Tool</span>(name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;getTableNames&#34;</span>, description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;è·å–æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„åç§°åˆ—è¡¨&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getTableNames</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    SELECT TABLE_NAME 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    FROM INFORMATION_SCHEMA.TABLES 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    WHERE TABLE_SCHEMA = DATABASE()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    AND TABLE_TYPE = &#39;BASE TABLE&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    ORDER BY TABLE_NAME
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                    &#34;&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> jdbcTemplate.<span style="color:#a6e22e">queryForList</span>(sql, String.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;è·å–è¡¨åˆ—è¡¨å¤±è´¥&#34;</span>, e);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> List.<span style="color:#a6e22e">of</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="mcptext2sqlservice">McpText2SqlService</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Slf4j</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Service</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RequiredArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">McpText2SqlService</span> <span style="color:#66d9ef">implements</span> Text2SqlService {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Qualifier</span>(<span style="color:#e6db74">&#34;mcpChatClient&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> ChatClient mcpChatClient;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// SQL ç”Ÿæˆæç¤ºæ¨¡æ¿ï¼ˆMCPç‰ˆæœ¬ï¼‰</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String SQL_GENERATION_PROMPT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ SQL ç”ŸæˆåŠ©æ‰‹ã€‚ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·æ¥è·å–æ•°æ®åº“ç»“æ„ä¿¡æ¯ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            å¯ç”¨å·¥å…·ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            - getTableNames(): è·å–æ‰€æœ‰è¡¨å
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            - getTableSchema(tableName): è·å–æŒ‡å®šè¡¨çš„å®Œæ•´ç»“æ„
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            - getDatabaseSchema(): è·å–æ‰€æœ‰è¡¨çš„å®Œæ•´ç»“æ„
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            - getTableColumns(tableName): è·å–æŒ‡å®šè¡¨çš„åˆ—ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            - executeQuery(sql): æ‰§è¡Œ SQL æŸ¥è¯¢éªŒè¯ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            è¯·éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            1. é¦–å…ˆä½¿ç”¨ getTableNames() äº†è§£æ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            2. æ ¹æ®ç”¨æˆ·æŸ¥è¯¢éœ€æ±‚ï¼Œä½¿ç”¨ getTableSchema() è·å–ç›¸å…³è¡¨çš„ç»“æ„ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            3. åªç”Ÿæˆ SELECT æŸ¥è¯¢è¯­å¥
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            4. ä½¿ç”¨æ­£ç¡®çš„è¡¨åå’Œå­—æ®µå
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            5. æ·»åŠ é€‚å½“çš„ WHERE æ¡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            6. ä½¿ç”¨ LIMIT é™åˆ¶ç»“æœæ•°é‡ï¼ˆæœ€å¤š 1000 æ¡ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            7. ç¡®ä¿ SQL è¯­æ³•æ­£ç¡®
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            8. å¦‚æœæŸ¥è¯¢æ¶‰åŠå¤šè¡¨ï¼Œè¯·ä½¿ç”¨é€‚å½“çš„ JOIN
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            9. ç”Ÿæˆ SQL åï¼Œå¯ä»¥ä½¿ç”¨ executeQuery() éªŒè¯ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            10. åªè¿”å› SQL è¯­å¥ï¼Œä¸è¦åŒ…å«å…¶ä»–è§£é‡Š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ç”¨æˆ·æŸ¥è¯¢ï¼š{userQuery}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸º SQL å¹¶æ‰§è¡ŒæŸ¥è¯¢ï¼ˆMCPç‰ˆæœ¬ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Text2SqlResult <span style="color:#a6e22e">processQuery</span>(String userQuery) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 1. éªŒè¯è¾“å…¥</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (userQuery <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> userQuery.<span style="color:#a6e22e">trim</span>().<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;æŸ¥è¯¢ä¸èƒ½ä¸ºç©º&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 2. ä½¿ç”¨ MCP å·¥å…·ç”Ÿæˆ SQL</span>
</span></span><span style="display:flex;"><span>            String sql <span style="color:#f92672">=</span> generateSqlWithMcpTools(userQuery);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (sql <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> sql.<span style="color:#a6e22e">trim</span>().<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;æ— æ³•ç”Ÿæˆæœ‰æ•ˆçš„ SQL æŸ¥è¯¢&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 3. éªŒè¯ SQL å®‰å…¨æ€§</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>SqlUtils.<span style="color:#a6e22e">isSqlSafe</span>(sql)) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;ç”Ÿæˆçš„ SQL ä¸å®‰å…¨ï¼ŒåŒ…å«å±é™©æ“ä½œ&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 4. æ‰§è¡ŒæŸ¥è¯¢</span>
</span></span><span style="display:flex;"><span>            List<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;&gt;</span> results <span style="color:#f92672">=</span> executeQuery(sql);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">success</span>(sql, results);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;MCP Text2SQL å¤„ç†å¤±è´¥&#34;</span>, e);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Text2SqlResult.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;å¤„ç†æŸ¥è¯¢æ—¶å‘ç”Ÿé”™è¯¯: &#34;</span> <span style="color:#f92672">+</span> e.<span style="color:#a6e22e">getMessage</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">generateSqlWithMcpTools</span>(String userQuery) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            PromptTemplate promptTemplate <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PromptTemplate(SQL_GENERATION_PROMPT);
</span></span><span style="display:flex;"><span>            Prompt prompt <span style="color:#f92672">=</span> promptTemplate.<span style="color:#a6e22e">create</span>(Map.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;userQuery&#34;</span>, userQuery));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            ChatResponse response <span style="color:#f92672">=</span> mcpChatClient.<span style="color:#a6e22e">prompt</span>(prompt).<span style="color:#a6e22e">call</span>().<span style="color:#a6e22e">chatResponse</span>();
</span></span><span style="display:flex;"><span>            String sql <span style="color:#f92672">=</span> response.<span style="color:#a6e22e">getResult</span>().<span style="color:#a6e22e">getOutput</span>().<span style="color:#a6e22e">getText</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// æ¸…ç† SQL è¯­å¥ï¼Œç§»é™¤å¯èƒ½çš„è§£é‡Šæ–‡æœ¬</span>
</span></span><span style="display:flex;"><span>            sql <span style="color:#f92672">=</span> SqlUtils.<span style="color:#a6e22e">cleanSql</span>(sql);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#34;MCP å·¥å…·ç”Ÿæˆçš„ SQL: {}&#34;</span>, sql);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> sql;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#34;ä½¿ç”¨ MCP å·¥å…·ç”Ÿæˆ SQL å¤±è´¥&#34;</span>, e);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> List<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;&gt;</span> <span style="color:#a6e22e">executeQuery</span>(String sql) {
</span></span><span style="display:flex;"><span>        log.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#34;ä½¿ç”¨ MCP å·¥å…·æ‰§è¡ŒæŸ¥è¯¢: {}&#34;</span>, sql);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;&gt;</span> result <span style="color:#f92672">=</span> mcpChatClient.<span style="color:#a6e22e">prompt</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">user</span>(<span style="color:#e6db74">&#34;è¯·ä½¿ç”¨ executeQuery å·¥å…·æ‰§è¡Œä»¥ä¸‹ SQL æŸ¥è¯¢: &#34;</span> <span style="color:#f92672">+</span> sql)
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">call</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#a6e22e">entity</span>(<span style="color:#66d9ef">new</span> ParameterizedTypeReference<span style="color:#f92672">&lt;</span>List<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;&gt;&gt;</span>() {
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        log.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#34;MCP å·¥å…·æ‰§è¡ŒæŸ¥è¯¢å®Œæˆï¼Œè¿”å› {} æ¡è®°å½•&#34;</span>, result.<span style="color:#a6e22e">size</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="ç¬¬ä¸‰ç‰ˆåˆ†æ­¥éª¤æŸ¥è¯¢æ¨¡å¼---è®©-ai-æ¨ç†è¿‡ç¨‹é€æ˜åŒ–">ç¬¬ä¸‰ç‰ˆï¼šåˆ†æ­¥éª¤æŸ¥è¯¢æ¨¡å¼ - è®© AI æ¨ç†è¿‡ç¨‹é€æ˜åŒ–</h2>
<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ä»…æƒ³è¦ç»“æœï¼Œè¿˜æƒ³çŸ¥é“ <strong>AI å¤§è¯­è¨€æ¨¡å‹</strong>æ˜¯æ€ä¹ˆ<strong>é€»è¾‘æ¨ç†</strong>çš„ã€‚ç‰¹åˆ«æ˜¯åœ¨<strong>æ•™å­¦æ¼”ç¤º</strong>ã€<strong>è°ƒè¯•å¤æ‚æŸ¥è¯¢</strong>æˆ–è€…<strong>ç”Ÿäº§ç¯å¢ƒç›‘æ§</strong>æ—¶ï¼Œ<strong>åˆ†æ­¥éª¤å±•ç¤º</strong>å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p>
<p>å‚è€ƒé˜¿é‡Œçš„<strong>æè¨€äº§å“</strong>ï¼ŒæŠŠæ•´ä¸ª <strong>Text2SQL è‡ªç„¶è¯­è¨€å¤„ç†</strong>è¿‡ç¨‹æ‹†è§£æˆäº† 5 ä¸ªæ¸…æ™°çš„<strong>æ¨ç†æ­¥éª¤</strong>ï¼š</p>
<pre class="mermaid">
	flowchart TD
Q[Step 1 é—®é¢˜æ”¹å†™] --&gt; T[Step 2 æ•°æ®è¡¨é€‰å–]
T --&gt; I[Step 3 ä¿¡æ¯æ¨ç†]
I --&gt; G[Step 4 SQLç”Ÿæˆ]
G --&gt; E[Step 5 SQLæ‰§è¡Œ]
</pre>
<h3 id="æ¯ä¸€æ­¥éƒ½åœ¨åšä»€ä¹ˆ">æ¯ä¸€æ­¥éƒ½åœ¨åšä»€ä¹ˆï¼Ÿ</h3>
<p>ä»¥æ‰§è¡Œ &ldquo;æ‰¾å‡ºå·¥èµ„æœ€é«˜çš„å‘˜å·¥&rdquo; ä¸ºä¾‹ï¼Œå±•ç¤º<strong>å¤šæ­¥æ¨ç†</strong>è¿‡ç¨‹ï¼š</p>
<p><strong>æ­¥éª¤ 1ï¼šè‡ªç„¶è¯­è¨€é—®é¢˜æ”¹å†™</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>é—®é¢˜æ”¹å†™ï¼Œæ”¹å†™ä¸ºï¼šæŸ¥è¯¢å·¥èµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯
</span></span></code></pre></div><p><strong>æ­¥éª¤ 2ï¼šæ•°æ®è¡¨æ™ºèƒ½é€‰å–</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>æ•°æ®è¡¨é€‰å–ï¼Œé€‰æ‹©è¡¨ä¸ºï¼šemployees
</span></span></code></pre></div><p><strong>æ­¥éª¤ 3ï¼šä¸šåŠ¡é€»è¾‘ä¿¡æ¯æ¨ç†</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>ä¿¡æ¯æ¨ç†ï¼Œæœ¬æ¬¡æ¨ç†å‚è€ƒä¸šåŠ¡ä¿¡æ¯æ˜¯ï¼š
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> éœ€è¦æŸ¥è¯¢çš„å­—æ®µï¼šid, name, department, position, salary, hire_date, email
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ç­›é€‰æ¡ä»¶ï¼šæ— ç‰¹å®šç­›é€‰æ¡ä»¶
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> è¡¨å…³è”å…³ç³»ï¼šå•è¡¨æŸ¥è¯¢ï¼Œæ— éœ€è¡¨å…³è”
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> æ’åºè§„åˆ™ï¼šæŒ‰salaryå­—æ®µé™åºæ’åˆ—ï¼Œä»¥æ‰¾åˆ°å·¥èµ„æœ€é«˜çš„å‘˜å·¥
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> åˆ†ç»„ç»Ÿè®¡ï¼šæ— éœ€åˆ†ç»„ç»Ÿè®¡
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ç»“æœé™åˆ¶ï¼šä½¿ç”¨LIMIT 1é™åˆ¶ç»“æœæ•°é‡ï¼Œç¡®ä¿åªè¿”å›å·¥èµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ä¸šåŠ¡å«ä¹‰ï¼šç”¨äºè¯†åˆ«å…¬å¸ä¸­è–ªé…¬æœ€é«˜çš„å‘˜å·¥ï¼Œä¾¿äºäººåŠ›èµ„æºç®¡ç†å’Œè–ªé…¬ç»“æ„åˆ†æ
</span></span></code></pre></div><p><strong>æ­¥éª¤ 4ï¼šSQL è¯­å¥æ™ºèƒ½ç”Ÿæˆ</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>æŸ¥è¯¢SQLç”Ÿæˆï¼Œç”ŸæˆSQLæŸ¥è¯¢è¯­å¥ä¸ºï¼š
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SELECT 
</span></span><span style="display:flex;"><span>    id,
</span></span><span style="display:flex;"><span>    name,
</span></span><span style="display:flex;"><span>    department,
</span></span><span style="display:flex;"><span>    position,
</span></span><span style="display:flex;"><span>    salary,
</span></span><span style="display:flex;"><span>    hire_date,
</span></span><span style="display:flex;"><span>    email
</span></span><span style="display:flex;"><span>FROM employees
</span></span><span style="display:flex;"><span>ORDER BY salary DESC
</span></span><span style="display:flex;"><span>LIMIT 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">**SQLæ™ºèƒ½æ³¨é‡Š**</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">1. **æŸ¥è¯¢ç›®çš„**: æŸ¥è¯¢å…¬å¸ä¸­å·¥èµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯ï¼Œç”¨äºè¯†åˆ«è–ªé…¬æœ€é«˜çš„å‘˜å·¥
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">2. **å­—æ®µè¯´æ˜**:
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">   - id: å‘˜å·¥å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºç²¾ç¡®è¯†åˆ«å‘˜å·¥
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">   - name: å‘˜å·¥å§“åï¼Œä¾¿äºäººåŠ›èµ„æºè¯†åˆ«å…·ä½“äººå‘˜
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">   - department: æ‰€å±éƒ¨é—¨ï¼Œåˆ†æé«˜è–ªå‘˜å·¥åˆ†å¸ƒæƒ…å†µ
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">   - position: èŒä½ä¿¡æ¯ï¼Œäº†è§£é«˜è–ªå¯¹åº”çš„å²—ä½çº§åˆ«
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">   - salary: å·¥èµ„æ•°é¢ï¼Œæ ¸å¿ƒæŸ¥è¯¢å­—æ®µ
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">   - hire_date: å…¥èŒæ—¥æœŸï¼Œåˆ†æé«˜è–ªä¸å…¥èŒæ—¶é—´çš„å…³ç³»
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">   - email: è”ç³»æ–¹å¼ï¼Œä¾¿äºåç»­æ²Ÿé€š
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">3. **è¡¨å…³è”**: å•è¡¨æŸ¥è¯¢ï¼Œç›´æ¥ä»employeesè¡¨ä¸­è·å–æ•°æ®ï¼Œæ— éœ€è¡¨å…³è”
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">4. **æ¡ä»¶ç­›é€‰**: æ— ç‰¹å®šç­›é€‰æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨å…¬å¸æ‰€æœ‰å‘˜å·¥
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">5. **åˆ†ç»„èšåˆ**: æ— éœ€åˆ†ç»„ç»Ÿè®¡ï¼Œç›´æ¥æŸ¥è¯¢å•ä¸ªæœ€é«˜è–ªå‘˜å·¥
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">6. **æ’åºé€»è¾‘**: æŒ‰salaryå­—æ®µé™åºæ’åˆ—(DESC)ï¼Œç¡®ä¿å·¥èµ„æœ€é«˜çš„å‘˜å·¥æ’åœ¨ç¬¬ä¸€ä½
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">7. **æ€§èƒ½ä¼˜åŒ–**: ä½¿ç”¨LIMIT 1é™åˆ¶ç»“æœæ•°é‡ï¼Œé¿å…è¿”å›ä¸å¿…è¦çš„æ•°æ®ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span><span style="color:#66d9ef">&gt; </span><span style="font-style:italic">8. **ä¸šåŠ¡ä»·å€¼**: è¯¥æŸ¥è¯¢ç»“æœæœ‰åŠ©äºäººåŠ›èµ„æºéƒ¨é—¨äº†è§£å…¬å¸è–ªé…¬ç»“æ„ï¼Œè¯†åˆ«å…³é”®äººæ‰ï¼Œä¸ºè–ªé…¬è°ƒæ•´å’Œäººæ‰ä¿ç•™ç­–ç•¥æä¾›æ•°æ®æ”¯æŒ
</span></span></span></code></pre></div><p><strong>æ­¥éª¤ 5ï¼šSQLæ‰§è¡Œ</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>æ‰§è¡ŒæˆåŠŸï¼Œæ‰¾åˆ° 1 æ¡è®°å½•
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>| id | name | department | position | salary | hire_date | email |
</span></span><span style="display:flex;"><span>|----|------|------------|----------|--------|-----------|-------|
</span></span><span style="display:flex;"><span>| 7 | å‘¨ä¹ | æŠ€æœ¯éƒ¨ | æ¶æ„å¸ˆ | 25000.00 | 1606752000000 | zhoujiu@company.com |
</span></span></code></pre></div><h3 id="åˆ†æ­¥éª¤æŸ¥è¯¢çš„æç¤ºè¯è®¾è®¡">åˆ†æ­¥éª¤æŸ¥è¯¢çš„æç¤ºè¯è®¾è®¡</h3>
<p>ä¸ºäº†å®ç°è¿™ç§åˆ†æ­¥éª¤å±•ç¤ºï¼Œä¸ºæ¯ä¸ªæ­¥éª¤è®¾è®¡äº†ä¸“é—¨çš„æç¤ºè¯æ¨¡æ¿ï¼š</p>
<p>æ¯”å¦‚ä»¥ä¸‹æ˜¯æ­¥éª¤ 1 çš„æç¤ºè¯æ¨¡æ¿ï¼Œä¸ºäº†è¯†åˆ«å‡ºä¸æ˜¯æ•°æ®åº“æŸ¥è¯¢çš„è¾“å…¥ï¼Œå¯¹æç¤ºè¯åšäº†ä¸€äº›ä¿®æ”¹ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#75715e">// æ­¥éª¤1: é—®é¢˜æ”¹å†™æç¤ºæ¨¡æ¿</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String STEP1_PROMPT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            è¯·å°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢æ”¹å†™ä¸ºæ›´æ¸…æ™°ã€æ›´å…·ä½“çš„æŸ¥è¯¢æè¿°ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ç”¨æˆ·æŸ¥è¯¢ï¼š{userQuery}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            åˆ¤æ–­è§„åˆ™ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            1. æ•°æ®åº“æŸ¥è¯¢ç‰¹å¾è¯ï¼šæŸ¥è¯¢ã€ç»Ÿè®¡ã€æŸ¥æ‰¾ã€è·å–ã€æ˜¾ç¤ºã€åˆ—å‡ºã€è®¡ç®—ã€æ±‡æ€»ã€åˆ†æã€ç­›é€‰ã€æ’åºã€åˆ†ç»„ã€è¿æ¥ã€å…³è”
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            2. éæ•°æ®åº“æŸ¥è¯¢ç‰¹å¾ï¼šé—®å€™è¯­ã€è‡ªæˆ‘ä»‹ç»ã€èŠå¤©ã€å¤©æ°”ã€æ–°é—»ã€å¨±ä¹ã€æŠ€æœ¯é—®é¢˜ã€ç¼–ç¨‹é—®é¢˜ã€ç³»ç»Ÿé—®é¢˜
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            è¯·ä½¿ç”¨ getDatabaseSchema MCPå·¥å…·æŸ¥è¯¢æ•°æ®åº“è¡¨ç»“æ„
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            åˆ¤æ–­æµç¨‹ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            1. æ£€æŸ¥æ˜¯å¦åŒ…å«æ•°æ®åº“æŸ¥è¯¢ç‰¹å¾è¯
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            2. æ£€æŸ¥æ˜¯å¦æ¶‰åŠæ•°æ®åº“é‡Œé¢çš„ä¸šåŠ¡å®ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            3. æ£€æŸ¥æ˜¯å¦åŒ…å«æ•°æ®æ“ä½œæ„å›¾
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            4. æ’é™¤æ˜æ˜¾çš„éæ•°æ®åº“æŸ¥è¯¢å†…å®¹
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            5. ä½¿ç”¨MCPå·¥å…·æŸ¥è¯¢å®é™…è¡¨ç»“æ„ï¼Œåˆ¤æ–­æŸ¥è¯¢æ˜¯å¦å¯è¡Œ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¿”å›ï¼Œä¸è¦åŒ…å«ä»»ä½•å…¶ä»–å†…å®¹ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            å¦‚æœæ˜¯æ•°æ®åº“æŸ¥è¯¢ä¸”ä¸ç°æœ‰è¡¨ç›¸å…³ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            é—®é¢˜æ”¹å†™ï¼Œæ”¹å†™ä¸ºï¼š[æ”¹å†™åçš„æŸ¥è¯¢æè¿°]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            å¦‚æœä¸æ˜¯æ•°æ®åº“æŸ¥è¯¢ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            æç¤ºï¼šè¯·è¾“å…¥ä¸æ•°æ®åº“æŸ¥è¯¢ç›¸å…³çš„é—®é¢˜ï¼Œä¾‹å¦‚&#34;æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯&#34;ã€&#34;ç»Ÿè®¡é”€å”®æ•°æ®&#34;ç­‰
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            å¦‚æœæ˜¯æ•°æ®åº“æŸ¥è¯¢ä½†ä¸ç°æœ‰è¡¨æ— å…³ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            æç¤ºï¼šå½“å‰æ•°æ®åº“ä¸­æ²¡æœ‰ç›¸å…³çš„ä¸šåŠ¡è¡¨ï¼Œè¯·æŸ¥è¯¢å‘˜å·¥ã€éƒ¨é—¨ã€é¡¹ç›®ç­‰ç›¸å…³ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            è¦æ±‚ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            1. å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ ¼å¼è¿”å›
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            2. å¯¹äºæ•°æ®åº“æŸ¥è¯¢ï¼Œæ”¹å†™åçš„æè¿°è¦ç®€æ´æ˜äº†ï¼Œçªå‡ºæŸ¥è¯¢çš„æ ¸å¿ƒéœ€æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            3. ä½¿ç”¨æ ‡å‡†çš„æ•°æ®åº“æŸ¥è¯¢æœ¯è¯­
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            4. ä¸è¦åŒ…å«ä»»ä½•åˆ†æè¿‡ç¨‹æˆ–é¢å¤–è¯´æ˜
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            5. å¿…é¡»ä½¿ç”¨MCPå·¥å…·æŸ¥è¯¢æ•°æ®åº“ç»“æ„åå†åšåˆ¤æ–­
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>;
</span></span></code></pre></div><p><strong>è¿™ç§æ–¹å¼çš„ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><strong>æ•™å­¦å‹å¥½</strong>ï¼šæ¯ä¸€æ­¥éƒ½å¯ä»¥å•ç‹¬è§‚å¯Ÿå’Œè°ƒæ•´</li>
<li><strong>è°ƒè¯•ä¾¿åˆ©</strong>ï¼šå‡ºé—®é¢˜æ—¶èƒ½å¿«é€Ÿå®šä½åˆ°å…·ä½“æ­¥éª¤</li>
<li><strong>å¯å¹²é¢„</strong>ï¼šå¯ä»¥åœ¨ä»»æ„æ­¥éª¤æ’å…¥äººå·¥æ£€æŸ¥æˆ–è§„åˆ™ä¿®æ­£</li>
<li><strong>ç»“æœæ¸…æ™°</strong>ï¼šä½¿ç”¨ Markdown è¡¨æ ¼è®©æŸ¥è¯¢ç»“æœæ›´åŠ ç›´è§‚æ˜“è¯»</li>
</ul>
<h3 id="åˆ†æ­¥éª¤æŸ¥è¯¢çš„å‰ç«¯ç•Œé¢">åˆ†æ­¥éª¤æŸ¥è¯¢çš„å‰ç«¯ç•Œé¢</h3>
<p>å¯åŠ¨åº”ç”¨ä¹‹åï¼Œè®¿é—® http://localhost:8080/step å³å¯è®¿é—®åˆ†æ­¥éª¤æŸ¥è¯¢çš„å‰ç«¯ç•Œé¢ï¼š</p>
<p><img src="https://csmos.oss-cn-beijing.aliyuncs.com/spring-ai-text2sql-showcase-02.png" alt="Spring AI Text2SQL åˆ†æ­¥éª¤æŸ¥è¯¢æ¨¡å¼ç•Œé¢ - å¤šæ­¥æ¨ç†è¿‡ç¨‹å±•ç¤ºç•Œé¢ï¼ŒåŒ…å«é—®é¢˜æ”¹å†™ã€æ•°æ®è¡¨é€‰å–ã€ä¿¡æ¯æ¨ç†ã€SQLç”Ÿæˆå’Œæ‰§è¡Œç»“æœçš„å®Œæ•´AIæ¨ç†é“¾è·¯"></p>
<h2 id="ç¬¬å››ç‰ˆæ™ºèƒ½ä¸šåŠ¡è§„åˆ™æ¨ç†è®©aiæ›´æ‡‚ä¸šåŠ¡">ç¬¬å››ç‰ˆï¼šæ™ºèƒ½ä¸šåŠ¡è§„åˆ™æ¨ç†ï¼Œè®©AIæ›´æ‡‚ä¸šåŠ¡</h2>
<p>åœ¨å‰é¢çš„ç‰ˆæœ¬ä¸­ï¼ŒAI è™½ç„¶èƒ½å¤Ÿç”Ÿæˆ SQLï¼Œä½†åœ¨ç†è§£ä¸šåŠ¡å«ä¹‰å’Œæ¨ç†é€»è¾‘æ–¹é¢è¿˜æœ‰æå‡ç©ºé—´ã€‚ç¬¬å››ç‰ˆå¼•å…¥äº†<strong>æ™ºèƒ½ä¸šåŠ¡è§„åˆ™æ¨ç†</strong>ï¼Œè®© AI ä¸ä»…ä¼šå†™ SQLï¼Œæ›´èƒ½ç†è§£ä¸šåŠ¡é€»è¾‘ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆéœ€è¦ä¸šåŠ¡è§„åˆ™æ¨ç†">ä¸ºä»€ä¹ˆéœ€è¦ä¸šåŠ¡è§„åˆ™æ¨ç†ï¼Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼š</p>
<ul>
<li>ç”¨æˆ·é—®ï¼š&ldquo;è¿‘ä¸¤å¹´å…¥èŒçš„å‘˜å·¥å¹³å‡è–ªæ°´æ˜¯å¤šå°‘ï¼Ÿ&rdquo;</li>
<li>ç”¨æˆ·é—®ï¼š&ldquo;æŠ€æœ¯éƒ¨å·¥èµ„æœ€é«˜çš„å‰3åå‘˜å·¥&rdquo;</li>
<li>ç”¨æˆ·é—®ï¼š&ldquo;æ¯ä¸ªéƒ¨é—¨çš„äººæ•°ç»Ÿè®¡&rdquo;</li>
</ul>
<p>è¿™äº›æŸ¥è¯¢ä¸ä»…éœ€è¦æ­£ç¡®çš„ SQL è¯­æ³•ï¼Œæ›´éœ€è¦ç†è§£ï¼š</p>
<ul>
<li><strong>æ—¶é—´æ¨ç†</strong>ï¼šä»€ä¹ˆæ˜¯&quot;è¿‘ä¸¤å¹´&quot;ï¼Ÿå¦‚ä½•è½¬æ¢ä¸ºå…·ä½“çš„æ—¥æœŸèŒƒå›´ï¼Ÿ</li>
<li><strong>ä¸šåŠ¡æœ¯è¯­</strong>ï¼šä»€ä¹ˆæ˜¯&quot;å¹³å‡è–ªæ°´&quot;ï¼Ÿåº”è¯¥ç”¨å“ªä¸ªå­—æ®µï¼Ÿ</li>
<li><strong>æ’åºé€»è¾‘</strong>ï¼šå¦‚ä½•æ‰¾åˆ°&quot;æœ€é«˜&quot;çš„å‘˜å·¥ï¼Ÿ</li>
<li><strong>åˆ†ç»„ç»Ÿè®¡</strong>ï¼šå¦‚ä½•æŒ‰éƒ¨é—¨åˆ†ç»„ï¼Ÿ</li>
</ul>
<h3 id="ä¸šåŠ¡è§„åˆ™æ¨ç†çš„æ ¸å¿ƒç»„ä»¶">ä¸šåŠ¡è§„åˆ™æ¨ç†çš„æ ¸å¿ƒç»„ä»¶</h3>
<p>ç¬¬å››ç‰ˆå¼•å…¥äº† <code>BusinessRuleService</code>ï¼Œæä¾›äº”å¤§æ ¸å¿ƒæ¨ç†èƒ½åŠ›ï¼š</p>
<h4 id="1-ä¸šåŠ¡æœ¯è¯­è§£é‡Š">1. ä¸šåŠ¡æœ¯è¯­è§£é‡Š</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// ä¸šåŠ¡æœ¯è¯­æ˜ å°„</span>
</span></span><span style="display:flex;"><span>BUSINESS_TERMS.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;å‘˜å·¥&#34;</span>, <span style="color:#e6db74">&#34;employeesè¡¨ä¸­çš„å‘˜å·¥è®°å½•&#34;</span>);
</span></span><span style="display:flex;"><span>BUSINESS_TERMS.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;å·¥èµ„&#34;</span>, <span style="color:#e6db74">&#34;salaryå­—æ®µï¼Œä½¿ç”¨decimal(10,2)ç±»å‹å­˜å‚¨&#34;</span>);
</span></span><span style="display:flex;"><span>BUSINESS_TERMS.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;éƒ¨é—¨&#34;</span>, <span style="color:#e6db74">&#34;departmentå­—æ®µï¼Œè¡¨ç¤ºå‘˜å·¥æ‰€å±éƒ¨é—¨&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åŒä¹‰è¯å¤„ç†</span>
</span></span><span style="display:flex;"><span>SYNONYMS.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;è–ªæ°´&#34;</span>, <span style="color:#e6db74">&#34;å·¥èµ„&#34;</span>);
</span></span><span style="display:flex;"><span>SYNONYMS.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;è–ªèµ„&#34;</span>, <span style="color:#e6db74">&#34;å·¥èµ„&#34;</span>);
</span></span><span style="display:flex;"><span>SYNONYMS.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;æ”¶å…¥&#34;</span>, <span style="color:#e6db74">&#34;å·¥èµ„&#34;</span>);
</span></span></code></pre></div><h4 id="2-æ—¶é—´æ¨ç†å¼•æ“">2. æ—¶é—´æ¨ç†å¼•æ“</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// æ”¯æŒå¤šç§æ—¶é—´è¡¨è¾¾å¼</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;è¿‘ä¸¤å¹´&#34;</span> <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;æ—¶é—´èŒƒå›´: 2022-01-01 è‡³ 2024-12-31&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;è¿‡å»6ä¸ªæœˆ&#34;</span> <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;æ—¶é—´èŒƒå›´: 2024-06-01 è‡³ 2024-12-31&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;ä»Šå¹´&#34;</span> <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;æ—¶é—´èŒƒå›´: 2024-01-01 è‡³ 2024-12-31&#34;</span>
</span></span></code></pre></div><h4 id="3-èšåˆè§„åˆ™æ¨ç†">3. èšåˆè§„åˆ™æ¨ç†</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// æ ¹æ®æŒ‡æ ‡ç±»å‹æ¨èèšåˆå‡½æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;å·¥èµ„æ€»æ•°&#34;</span> <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;å»ºè®®ä½¿ç”¨SUMèšåˆå‡½æ•°&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;å‘˜å·¥äººæ•°&#34;</span> <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;å»ºè®®ä½¿ç”¨COUNTèšåˆå‡½æ•°&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;å¹³å‡å·¥èµ„&#34;</span> <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;å»ºè®®ä½¿ç”¨AVGèšåˆå‡½æ•°&#34;</span>
</span></span></code></pre></div><h4 id="4-è¡¨å…³è”è§„åˆ™">4. è¡¨å…³è”è§„åˆ™</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// æ™ºèƒ½è¯†åˆ«è¡¨å…³è”å…³ç³»</span>
</span></span><span style="display:flex;"><span>employees <span style="color:#f92672">+</span> project_members <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;é€šè¿‡employee_idå­—æ®µå…³è”&#34;</span>
</span></span><span style="display:flex;"><span>projects <span style="color:#f92672">+</span> project_members <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;é€šè¿‡project_idå­—æ®µå…³è”&#34;</span>
</span></span></code></pre></div><h4 id="5-å­—æ®µéœ€æ±‚æ¨ç†">5. å­—æ®µéœ€æ±‚æ¨ç†</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// æ ¹æ®æŸ¥è¯¢å†…å®¹æ¨æ–­éœ€è¦çš„å­—æ®µ</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;æŸ¥è¯¢å‘˜å·¥å§“å&#34;</span> <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;éœ€è¦nameå­—æ®µ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;æŒ‰éƒ¨é—¨ç»Ÿè®¡&#34;</span> <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;éœ€è¦departmentå­—æ®µ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;å·¥èµ„æ’åº&#34;</span> <span style="color:#960050;background-color:#1e0010">â†’</span> <span style="color:#e6db74">&#34;éœ€è¦salaryå­—æ®µ&#34;</span>
</span></span></code></pre></div><h3 id="æ­¥éª¤3ä¿¡æ¯æ¨ç†çš„æ™ºèƒ½åŒ–å‡çº§">æ­¥éª¤3ï¼šä¿¡æ¯æ¨ç†çš„æ™ºèƒ½åŒ–å‡çº§</h3>
<p>åœ¨åˆ†æ­¥éª¤æŸ¥è¯¢æ¨¡å¼ä¸­ï¼Œæ­¥éª¤3&quot;ä¿¡æ¯æ¨ç†&quot;å¾—åˆ°äº†æ˜¾è‘—å¢å¼ºï¼š</p>
<h4 id="åŸå§‹æ­¥éª¤3ç¬¬ä¸‰ç‰ˆ">åŸå§‹æ­¥éª¤3ï¼ˆç¬¬ä¸‰ç‰ˆï¼‰</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>ä¿¡æ¯æ¨ç†ï¼Œæœ¬æ¬¡æ¨ç†å‚è€ƒä¸šåŠ¡ä¿¡æ¯æ˜¯ï¼š
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> éœ€è¦æŸ¥è¯¢çš„å­—æ®µï¼šid, name, department, position, salary, hire_date, email
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ç­›é€‰æ¡ä»¶ï¼šæ— ç‰¹å®šç­›é€‰æ¡ä»¶
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> è¡¨å…³è”å…³ç³»ï¼šå•è¡¨æŸ¥è¯¢ï¼Œæ— éœ€è¡¨å…³è”
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> æ’åºè§„åˆ™ï¼šæŒ‰salaryå­—æ®µé™åºæ’åˆ—ï¼Œä»¥æ‰¾åˆ°å·¥èµ„æœ€é«˜çš„å‘˜å·¥
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> åˆ†ç»„ç»Ÿè®¡ï¼šæ— éœ€åˆ†ç»„ç»Ÿè®¡
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ç»“æœé™åˆ¶ï¼šä½¿ç”¨LIMIT 1é™åˆ¶ç»“æœæ•°é‡ï¼Œç¡®ä¿åªè¿”å›å·¥èµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ä¸šåŠ¡å«ä¹‰ï¼šç”¨äºè¯†åˆ«å…¬å¸ä¸­è–ªé…¬æœ€é«˜çš„å‘˜å·¥ï¼Œä¾¿äºäººåŠ›èµ„æºç®¡ç†å’Œè–ªé…¬ç»“æ„åˆ†æ
</span></span></code></pre></div><h4 id="å¢å¼ºç‰ˆæ­¥éª¤3ç¬¬å››ç‰ˆ">å¢å¼ºç‰ˆæ­¥éª¤3ï¼ˆç¬¬å››ç‰ˆï¼‰</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>ä¿¡æ¯æ¨ç†ï¼Œæœ¬æ¬¡æ¨ç†å‚è€ƒä¸šåŠ¡ä¿¡æ¯æ˜¯ï¼š
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> éœ€è¦æŸ¥è¯¢çš„å­—æ®µï¼šid, name, department, position, salary, hire_date, email
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ç­›é€‰æ¡ä»¶ï¼šæ— ç‰¹å®šç­›é€‰æ¡ä»¶
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> è¡¨å…³è”å…³ç³»ï¼šå•è¡¨æŸ¥è¯¢ï¼Œæ— éœ€è¡¨å…³è”
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> æ’åºè§„åˆ™ï¼šæŒ‰salaryå­—æ®µé™åºæ’åˆ—ï¼Œä»¥æ‰¾åˆ°å·¥èµ„æœ€é«˜çš„å‘˜å·¥
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> åˆ†ç»„ç»Ÿè®¡ï¼šæ— éœ€åˆ†ç»„ç»Ÿè®¡
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ç»“æœé™åˆ¶ï¼šä½¿ç”¨LIMIT 1é™åˆ¶ç»“æœæ•°é‡ï¼Œç¡®ä¿åªè¿”å›å·¥èµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ä¸šåŠ¡å«ä¹‰ï¼šç”¨äºè¯†åˆ«å…¬å¸ä¸­è–ªé…¬æœ€é«˜çš„å‘˜å·¥ï¼Œä¾¿äºäººåŠ›èµ„æºç®¡ç†å’Œè–ªé…¬ç»“æ„åˆ†æ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">**ä¸šåŠ¡è§„åˆ™å‚è€ƒ**</span>ï¼š
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> æ—¶é—´èŒƒå›´: æ— ç‰¹å®šæ—¶é—´é™åˆ¶
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> ä¸šåŠ¡è§„åˆ™: éœ€è¦æ·»åŠ ORDER BYå­å¥è¿›è¡Œæ’åº; éœ€è¦æ·»åŠ LIMITå­å¥é™åˆ¶è¿”å›ç»“æœæ•°é‡
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> å…³é”®å­—æ®µ: salary, name, department, position
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> èšåˆå»ºè®®: æ— éœ€èšåˆï¼Œç›´æ¥æŸ¥è¯¢å•ä¸ªè®°å½•
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">-</span> åŒä¹‰è¯æ˜ å°„: å·¥èµ„ â†’ salaryå­—æ®µ
</span></span></code></pre></div><h3 id="ä¸šåŠ¡è§„åˆ™æ¨ç†çš„å®é™…æ•ˆæœ">ä¸šåŠ¡è§„åˆ™æ¨ç†çš„å®é™…æ•ˆæœ</h3>
<p>è®©æˆ‘ä»¬çœ‹çœ‹å‡ ä¸ªå…·ä½“çš„ä¾‹å­ï¼š</p>
<h4 id="ä¾‹å­1æ—¶é—´æ¨ç†">ä¾‹å­1ï¼šæ—¶é—´æ¨ç†</h4>
<p><strong>ç”¨æˆ·æŸ¥è¯¢</strong>ï¼š&ldquo;è¿‘ä¸€å¹´å…¥èŒçš„å‘˜å·¥ä¿¡æ¯&rdquo;</p>
<p><strong>ä¸šåŠ¡è§„åˆ™æ¨ç†</strong>ï¼š</p>
<ul>
<li>æ—¶é—´èŒƒå›´: 2023-12-01 è‡³ 2024-12-31</li>
<li>ç­›é€‰æ¡ä»¶: hire_date &gt;= &lsquo;2023-12-01&rsquo;</li>
<li>ä¸šåŠ¡è§„åˆ™: éœ€è¦æ·»åŠ WHEREæ¡ä»¶è¿›è¡Œæ—¶é—´ç­›é€‰</li>
</ul>
<p><strong>ç”Ÿæˆçš„SQL</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> employees 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> hire_date <span style="color:#f92672">&gt;=</span> <span style="color:#e6db74">&#39;2023-12-01&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> hire_date <span style="color:#66d9ef">DESC</span>
</span></span></code></pre></div><h4 id="ä¾‹å­2èšåˆæ¨ç†">ä¾‹å­2ï¼šèšåˆæ¨ç†</h4>
<p><strong>ç”¨æˆ·æŸ¥è¯¢</strong>ï¼š&ldquo;æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„&rdquo;</p>
<p><strong>ä¸šåŠ¡è§„åˆ™æ¨ç†</strong>ï¼š</p>
<ul>
<li>åˆ†ç»„ç»Ÿè®¡: æŒ‰departmentå­—æ®µåˆ†ç»„</li>
<li>èšåˆå»ºè®®: ä½¿ç”¨AVGèšåˆå‡½æ•°è®¡ç®—å¹³å‡å·¥èµ„</li>
<li>å…³é”®å­—æ®µ: department, salary</li>
<li>ä¸šåŠ¡è§„åˆ™: éœ€è¦æ·»åŠ GROUP BYå­å¥è¿›è¡Œåˆ†ç»„ç»Ÿè®¡</li>
</ul>
<p><strong>ç”Ÿæˆçš„SQL</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> department, <span style="color:#66d9ef">AVG</span>(salary) <span style="color:#66d9ef">as</span> avg_salary 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> department 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> avg_salary <span style="color:#66d9ef">DESC</span>
</span></span></code></pre></div><h4 id="ä¾‹å­3æ’åºæ¨ç†">ä¾‹å­3ï¼šæ’åºæ¨ç†</h4>
<p><strong>ç”¨æˆ·æŸ¥è¯¢</strong>ï¼š&ldquo;æŠ€æœ¯éƒ¨å·¥èµ„æœ€é«˜çš„å‰3åå‘˜å·¥&rdquo;</p>
<p><strong>ä¸šåŠ¡è§„åˆ™æ¨ç†</strong>ï¼š</p>
<ul>
<li>ç­›é€‰æ¡ä»¶: department = &lsquo;æŠ€æœ¯éƒ¨&rsquo;</li>
<li>æ’åºè§„åˆ™: æŒ‰salaryå­—æ®µé™åºæ’åˆ—</li>
<li>ç»“æœé™åˆ¶: ä½¿ç”¨LIMIT 3é™åˆ¶ç»“æœæ•°é‡</li>
<li>å…³é”®å­—æ®µ: name, salary, department, position</li>
</ul>
<p><strong>ç”Ÿæˆçš„SQL</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> name, salary, <span style="color:#66d9ef">position</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> employees 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> department <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;æŠ€æœ¯éƒ¨&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> salary <span style="color:#66d9ef">DESC</span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">3</span>
</span></span></code></pre></div><h3 id="æŠ€æœ¯å®ç°ç»†èŠ‚">æŠ€æœ¯å®ç°ç»†èŠ‚</h3>
<h4 id="businessruleservice-æ ¸å¿ƒæ–¹æ³•">BusinessRuleService æ ¸å¿ƒæ–¹æ³•</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Service</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">BusinessRuleService</span> {
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * æ—¶é—´æ¨ç† - è§£æç›¸å¯¹æ—¶é—´è¡¨è¾¾å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">parseTimeExpression</span>(String timeExpression) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ”¯æŒ&#34;è¿‘Xå¹´&#34;ã€&#34;è¿‡å»Xä¸ªæœˆ&#34;ã€&#34;ä»Šå¹´&#34;ã€&#34;å»å¹´&#34;ç­‰è¡¨è¾¾å¼</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// è‡ªåŠ¨è½¬æ¢ä¸ºå…·ä½“çš„æ—¥æœŸèŒƒå›´</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * èšåˆè§„åˆ™æ¨ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getAggregationRule</span>(String metric, String dimension) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ ¹æ®æŒ‡æ ‡ç±»å‹æ¨èåˆé€‚çš„èšåˆå‡½æ•°</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// SUMã€COUNTã€AVGã€MAXã€MINç­‰</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * è¡¨å…³è”è§„åˆ™æ¨ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getTableJoinRule</span>(String table1, String table2) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ™ºèƒ½è¯†åˆ«è¡¨ä¹‹é—´çš„å…³è”å­—æ®µ</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ”¯æŒå¤–é”®å…³è”ã€ä¸šåŠ¡å­—æ®µå…³è”ç­‰</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * ä¸šåŠ¡é€»è¾‘æ¨ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getBusinessLogic</span>(String query, String selectedTables) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ç»¼åˆæ¨ç†æŸ¥è¯¢çš„ä¸šåŠ¡é€»è¾‘</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// åŒ…æ‹¬æ—¶é—´ã€çŠ¶æ€ã€æ’åºã€åˆ†ç»„ã€é™åˆ¶ç­‰</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * å­—æ®µéœ€æ±‚æ¨ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getFieldRequirements</span>(String query, String tableName) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ ¹æ®æŸ¥è¯¢å†…å®¹æ¨æ–­éœ€è¦çš„å­—æ®µ</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ”¯æŒåŒä¹‰è¯æ˜ å°„å’Œä¸šåŠ¡æœ¯è¯­è§£é‡Š</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="æ­¥éª¤3çš„æç¤ºè¯æ¨¡æ¿">æ­¥éª¤3çš„æç¤ºè¯æ¨¡æ¿</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String STEP3_PROMPT <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        åŸºäºé€‰ä¸­çš„è¡¨å’ŒæŸ¥è¯¢éœ€æ±‚ï¼Œè¿›è¡Œæ™ºèƒ½ä¿¡æ¯æ¨ç†ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        æŸ¥è¯¢éœ€æ±‚ï¼š{rewrittenQuery}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        é€‰ä¸­è¡¨ï¼š{selectedTables}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        ä¸šåŠ¡è§„åˆ™å‚è€ƒï¼š{businessRules}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¿”å›ï¼Œä¸è¦æ·»åŠ ä»»ä½•å…¶ä»–å†…å®¹ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        ä¿¡æ¯æ¨ç†ï¼Œæœ¬æ¬¡æ¨ç†å‚è€ƒä¸šåŠ¡ä¿¡æ¯æ˜¯ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        - éœ€è¦æŸ¥è¯¢çš„å­—æ®µï¼š[å…·ä½“åˆ—å‡ºéœ€è¦æŸ¥è¯¢çš„å­—æ®µå]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        - ç­›é€‰æ¡ä»¶ï¼š[è¯´æ˜WHEREæ¡ä»¶ï¼Œå¦‚æ— ç‰¹å®šæ¡ä»¶åˆ™è¯´æ˜&#34;æ— ç‰¹å®šç­›é€‰æ¡ä»¶&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        - è¡¨å…³è”å…³ç³»ï¼š[è¯´æ˜è¡¨å…³è”æƒ…å†µï¼Œå¦‚å•è¡¨æŸ¥è¯¢åˆ™è¯´æ˜&#34;å•è¡¨æŸ¥è¯¢ï¼Œæ— éœ€è¡¨å…³è”&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        - æ’åºè§„åˆ™ï¼š[è¯´æ˜ORDER BYçš„æ’åºé€»è¾‘å’Œç›®çš„]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        - åˆ†ç»„ç»Ÿè®¡ï¼š[è¯´æ˜æ˜¯å¦éœ€è¦GROUP BYï¼Œå¦‚ä¸éœ€è¦åˆ™è¯´æ˜&#34;æ— éœ€åˆ†ç»„ç»Ÿè®¡&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        - ç»“æœé™åˆ¶ï¼š[è¯´æ˜LIMITé™åˆ¶æ•°é‡å’Œç›®çš„]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        - ä¸šåŠ¡å«ä¹‰ï¼š[è§£é‡ŠæŸ¥è¯¢çš„ä¸šåŠ¡ä»·å€¼å’Œå®é™…åº”ç”¨åœºæ™¯]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        è¦æ±‚ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        1. ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ ¼å¼è¾“å‡ºï¼Œæ¯è¡Œä¸€ä¸ªè¦ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        2. åŸºäºä¸šåŠ¡è§„åˆ™å‚è€ƒä¿¡æ¯è¿›è¡Œæ¨ç†
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        3. æ¨ç†ç»“æœè¦å…·ä½“ã€å‡†ç¡®ã€æœ‰ä¸šåŠ¡ä»·å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        4. ä¸è¦åŒ…å«SQLè¯­å¥ï¼Œåªåšé€»è¾‘æ¨ç†
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>;
</span></span></code></pre></div><h3 id="ä¸šåŠ¡è§„åˆ™æ¨ç†çš„ä¼˜åŠ¿">ä¸šåŠ¡è§„åˆ™æ¨ç†çš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>æ™ºèƒ½åŒ–ç¨‹åº¦æ›´é«˜</strong>ï¼šAI ä¸ä»…ä¼šå†™ SQLï¼Œæ›´èƒ½ç†è§£ä¸šåŠ¡å«ä¹‰</li>
<li><strong>å‡†ç¡®æ€§æ˜¾è‘—æå‡</strong>ï¼šé€šè¿‡ä¸šåŠ¡è§„åˆ™çº¦æŸï¼Œå‡å°‘ SQL ç”Ÿæˆé”™è¯¯</li>
<li><strong>ç”¨æˆ·ä½“éªŒæ›´å¥½</strong>ï¼šæ”¯æŒè‡ªç„¶è¯­è¨€è¡¨è¾¾ï¼Œæ— éœ€å­¦ä¹  SQL è¯­æ³•</li>
<li><strong>å¯æ‰©å±•æ€§å¼º</strong>ï¼šä¸šåŠ¡è§„åˆ™å¯ä»¥æŒç»­ä¼˜åŒ–å’Œæ‰©å±•</li>
<li><strong>æ•™å­¦ä»·å€¼é«˜</strong>ï¼šåˆ†æ­¥éª¤å±•ç¤ºè®©ç”¨æˆ·ç†è§£ AI çš„æ€è€ƒè¿‡ç¨‹</li>
</ol>
<p>é€šè¿‡å¼•å…¥æ™ºèƒ½ä¸šåŠ¡è§„åˆ™æ¨ç†ï¼Œç¬¬å››ç‰ˆè®© Text2SQL ç³»ç»ŸçœŸæ­£å…·å¤‡äº†&quot;ç†è§£ä¸šåŠ¡&quot;çš„èƒ½åŠ›ï¼Œä¸ä»…èƒ½å¤Ÿç”Ÿæˆæ­£ç¡®çš„ SQLï¼Œæ›´èƒ½ç†è§£ç”¨æˆ·çš„çœŸå®æ„å›¾ï¼Œæä¾›æ›´æœ‰ä»·å€¼çš„ä¸šåŠ¡æ´å¯Ÿã€‚</p>
<h3 id="å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</h3>
<p><strong>äººåŠ›èµ„æºåœºæ™¯</strong>ï¼š</p>
<ul>
<li>&ldquo;è¿‘åŠå¹´å…¥èŒçš„å‘˜å·¥å¹³å‡å·¥èµ„&rdquo;</li>
<li>&ldquo;å„éƒ¨é—¨å·¥èµ„åˆ†å¸ƒæƒ…å†µ&rdquo;</li>
<li>&ldquo;æŠ€æœ¯éƒ¨è–ªèµ„æœ€é«˜çš„å‰5å&rdquo;</li>
</ul>
<p><strong>é¡¹ç›®ç®¡ç†åœºæ™¯</strong>ï¼š</p>
<ul>
<li>&ldquo;è¿›è¡Œä¸­çš„é¡¹ç›®é¢„ç®—ç»Ÿè®¡&rdquo;</li>
<li>&ldquo;æ¯ä¸ªé¡¹ç›®çš„å‚ä¸äººæ•°&rdquo;</li>
<li>&ldquo;é¡¹ç›®å®Œæˆç‡åˆ†æ&rdquo;</li>
</ul>
<p><strong>è´¢åŠ¡åˆ†æåœºæ™¯</strong>ï¼š</p>
<ul>
<li>&ldquo;å„éƒ¨é—¨å¹´åº¦é¢„ç®—ä½¿ç”¨æƒ…å†µ&rdquo;</li>
<li>&ldquo;é¡¹ç›®æˆæœ¬æ•ˆç›Šåˆ†æ&rdquo;</li>
<li>&ldquo;å‘˜å·¥è–ªé…¬ç»“æ„åˆ†æ&rdquo;</li>
</ul>
<h3 id="ç‰ˆæœ¬æ¼”è¿›å¯¹æ¯”">ç‰ˆæœ¬æ¼”è¿›å¯¹æ¯”</h3>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>ç¬¬ä¸€ç‰ˆ</th>
          <th>ç¬¬äºŒç‰ˆ</th>
          <th>ç¬¬ä¸‰ç‰ˆ</th>
          <th>ç¬¬å››ç‰ˆ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>å®ç°æ–¹å¼</strong></td>
          <td>ç›´æ¥æ¨¡å¼</td>
          <td>MCPå·¥å…·</td>
          <td>åˆ†æ­¥éª¤æŸ¥è¯¢</td>
          <td>æ™ºèƒ½ä¸šåŠ¡è§„åˆ™</td>
      </tr>
      <tr>
          <td><strong>å‡†ç¡®æ€§</strong></td>
          <td>â­â­â­</td>
          <td>â­â­â­â­</td>
          <td>â­â­â­â­</td>
          <td>â­â­â­â­â­</td>
      </tr>
      <tr>
          <td><strong>å¯è§£é‡Šæ€§</strong></td>
          <td>â­â­</td>
          <td>â­â­â­</td>
          <td>â­â­â­â­â­</td>
          <td>â­â­â­â­â­</td>
      </tr>
      <tr>
          <td><strong>ä¸šåŠ¡ç†è§£</strong></td>
          <td>â­â­</td>
          <td>â­â­â­</td>
          <td>â­â­â­</td>
          <td>â­â­â­â­â­</td>
      </tr>
      <tr>
          <td><strong>æ•™å­¦ä»·å€¼</strong></td>
          <td>â­â­</td>
          <td>â­â­â­</td>
          <td>â­â­â­â­â­</td>
          <td>â­â­â­â­â­</td>
      </tr>
      <tr>
          <td><strong>é€‚ç”¨åœºæ™¯</strong></td>
          <td>ç®€å•æŸ¥è¯¢</td>
          <td>å¤æ‚æŸ¥è¯¢</td>
          <td>æ•™å­¦æ¼”ç¤º</td>
          <td>ç”Ÿäº§ç¯å¢ƒ</td>
      </tr>
  </tbody>
</table>
<h2 id="å®‰å…¨ç¬¬ä¸€sql-æ³¨å…¥é˜²æŠ¤ä¸æ•°æ®å®‰å…¨ç­–ç•¥">å®‰å…¨ç¬¬ä¸€ï¼šSQL æ³¨å…¥é˜²æŠ¤ä¸æ•°æ®å®‰å…¨ç­–ç•¥</h2>
<p><strong>Text2SQL è‡ªç„¶è¯­è¨€æŸ¥è¯¢</strong>è™½ç„¶æ–¹ä¾¿ï¼Œä½†<strong>æ•°æ®åº“å®‰å…¨</strong>é—®é¢˜ç»å¯¹ä¸èƒ½å¿½è§†ã€‚æˆ‘åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ€»ç»“äº†å‡ æ¡<strong>å®‰å…¨é˜²æŠ¤</strong>é“å¾‹ï¼š</p>
<h3 id="æ ¸å¿ƒå®‰å…¨é˜²æŠ¤ç­–ç•¥">æ ¸å¿ƒå®‰å…¨é˜²æŠ¤ç­–ç•¥</h3>
<p><strong>1. åªè¯»æƒé™ç­–ç•¥</strong></p>
<ul>
<li>ä¸¥æ ¼é™åˆ¶åªèƒ½æ‰§è¡Œ <code>SELECT</code> æŸ¥è¯¢è¯­å¥</li>
<li>æ‹’ç»æ‰€æœ‰ <code>DROP</code>ã€<code>DELETE</code>ã€<code>UPDATE</code>ã€<code>INSERT</code> ç­‰<strong>å±é™©æ“ä½œ</strong></li>
<li>åœ¨<strong>ä»£ç å±‚é¢</strong>å’Œ<strong>æ•°æ®åº“å±‚é¢</strong>åšåŒé‡æ£€æŸ¥</li>
</ul>
<p><strong>2. ç³»ç»Ÿè¡¨ä¿æŠ¤</strong></p>
<ul>
<li>æ‹¦æˆªè®¿é—® <code>INFORMATION_SCHEMA</code> çš„æŸ¥è¯¢</li>
<li>ç¦æ­¢è®¿é—®<strong>ç³»ç»Ÿæ•°æ®åº“</strong>å’Œ<strong>æ•æ„Ÿè¡¨</strong></li>
<li>é™åˆ¶æŸ¥è¯¢èŒƒå›´ï¼Œé¿å…<strong>æ•°æ®æ³„éœ²</strong></li>
</ul>
<p><strong>3. è¾“å‡ºå†…å®¹æ§åˆ¶</strong></p>
<ul>
<li>æ¸…ç† <strong>AI æ¨¡å‹è¾“å‡º</strong>ä¸­çš„ä»£ç å—åŒ…è£¹</li>
<li>è‡ªåŠ¨æ·»åŠ  <code>LIMIT</code> é™åˆ¶ï¼Œé˜²æ­¢<strong>å¤§æ•°æ®é‡æŸ¥è¯¢</strong></li>
<li>å¯¹<strong>æ•æ„Ÿå­—æ®µ</strong>è¿›è¡Œè„±æ•å¤„ç†</li>
</ul>
<p><strong>4. æ™ºèƒ½å®‰å…¨æ ¡éªŒ</strong></p>
<ul>
<li><strong>MCP æ¨¡å¼</strong>ä¸‹å…ˆåšå°èŒƒå›´æµ‹è¯•</li>
<li>å¤±è´¥æ—¶æä¾›å…·ä½“çš„<strong>é”™è¯¯ä¿¡æ¯</strong>å’Œä¿®æ­£å»ºè®®</li>
<li>å»ºç«‹æŸ¥è¯¢<strong>ç™½åå•</strong>å’Œ<strong>é»‘åå•</strong>æœºåˆ¶</li>
</ul>
<h3 id="sql-æ³¨å…¥é˜²æŠ¤ä»£ç ç¤ºä¾‹">SQL æ³¨å…¥é˜²æŠ¤ä»£ç ç¤ºä¾‹</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlUtils</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å±é™©æ“ä½œé»‘åå•</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> DANGEROUS_KEYWORDS <span style="color:#f92672">=</span> Set.<span style="color:#a6e22e">of</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;DROP&#34;</span>, <span style="color:#e6db74">&#34;DELETE&#34;</span>, <span style="color:#e6db74">&#34;UPDATE&#34;</span>, <span style="color:#e6db74">&#34;INSERT&#34;</span>, <span style="color:#e6db74">&#34;ALTER&#34;</span>, <span style="color:#e6db74">&#34;CREATE&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;TRUNCATE&#34;</span>, <span style="color:#e6db74">&#34;EXEC&#34;</span>, <span style="color:#e6db74">&#34;EXECUTE&#34;</span>, <span style="color:#e6db74">&#34;CALL&#34;</span>, <span style="color:#e6db74">&#34;MERGE&#34;</span>, <span style="color:#e6db74">&#34;REPLACE&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;UNION&#34;</span>, <span style="color:#e6db74">&#34;INFORMATION_SCHEMA&#34;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ç³»ç»Ÿè¡¨é»‘åå•</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> SYSTEM_TABLES <span style="color:#f92672">=</span> Set.<span style="color:#a6e22e">of</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;information_schema&#34;</span>, <span style="color:#e6db74">&#34;mysql&#34;</span>, <span style="color:#e6db74">&#34;performance_schema&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;sys&#34;</span>, <span style="color:#e6db74">&#34;test&#34;</span>, <span style="color:#e6db74">&#34;tmp&#34;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * æ¸…ç† SQL è¯­å¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">cleanSql</span>(String sql) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sql <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ç§»é™¤å¯èƒ½çš„ä»£ç å—æ ‡è®°</span>
</span></span><span style="display:flex;"><span>        sql <span style="color:#f92672">=</span> sql.<span style="color:#a6e22e">replaceAll</span>(<span style="color:#e6db74">&#34;```sql\\s*&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>).<span style="color:#a6e22e">replaceAll</span>(<span style="color:#e6db74">&#34;```\\s*&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ª SELECT è¯­å¥</span>
</span></span><span style="display:flex;"><span>        Pattern pattern <span style="color:#f92672">=</span> Pattern.<span style="color:#a6e22e">compile</span>(<span style="color:#e6db74">&#34;(SELECT.*?)(?=\\n\\n|$)&#34;</span>, Pattern.<span style="color:#a6e22e">DOTALL</span> <span style="color:#f92672">|</span> Pattern.<span style="color:#a6e22e">CASE_INSENSITIVE</span>);
</span></span><span style="display:flex;"><span>        Matcher matcher <span style="color:#f92672">=</span> pattern.<span style="color:#a6e22e">matcher</span>(sql);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (matcher.<span style="color:#a6e22e">find</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> matcher.<span style="color:#a6e22e">group</span>(1).<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sql.<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * éªŒè¯ SQL å®‰å…¨æ€§
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">isSqlSafe</span>(String sql) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sql <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> sql.<span style="color:#a6e22e">trim</span>().<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        String upperSql <span style="color:#f92672">=</span> sql.<span style="color:#a6e22e">toUpperCase</span>().<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 1. æ£€æŸ¥æ˜¯å¦åªåŒ…å«SELECTè¯­å¥</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>upperSql.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;SELECT&#34;</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 2. æ£€æŸ¥å±é™©å…³é”®è¯</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (String keyword : DANGEROUS_KEYWORDS) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (upperSql.<span style="color:#a6e22e">contains</span>(keyword)) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 3. æ£€æŸ¥ç³»ç»Ÿè¡¨è®¿é—®</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (String systemTable : SYSTEM_TABLES) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (upperSql.<span style="color:#a6e22e">contains</span>(systemTable)) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 4. æ£€æŸ¥SQLæ³¨å…¥æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (containsSqlInjection(sql)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * æ£€æµ‹SQLæ³¨å…¥æ”»å‡»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">containsSqlInjection</span>(String sql) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ£€æµ‹å¸¸è§çš„SQLæ³¨å…¥æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>        String<span style="color:#f92672">[]</span> injectionPatterns <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;&#39;.*--&#34;</span>, <span style="color:#e6db74">&#34;&#39;.*;&#34;</span>, <span style="color:#e6db74">&#34;&#39;.*UNION&#34;</span>, <span style="color:#e6db74">&#34;&#39;.*OR.*=&#34;</span>, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;&#39;.*AND.*=&#34;</span>, <span style="color:#e6db74">&#34;&#39;.*OR.*1=1&#34;</span>, <span style="color:#e6db74">&#34;&#39;.*AND.*1=1&#34;</span>
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (String pattern : injectionPatterns) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (sql.<span style="color:#a6e22e">matches</span>(<span style="color:#e6db74">&#34;.*&#34;</span> <span style="color:#f92672">+</span> pattern <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.*&#34;</span>)) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * æ¸…ç†å’Œæ ‡å‡†åŒ–SQL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">sanitizeSql</span>(String sql) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sql <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ç§»é™¤ä»£ç å—æ ‡è®°</span>
</span></span><span style="display:flex;"><span>        sql <span style="color:#f92672">=</span> cleanSql(sql);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ç¡®ä¿æœ‰LIMITé™åˆ¶</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>sql.<span style="color:#a6e22e">toUpperCase</span>().<span style="color:#a6e22e">contains</span>(<span style="color:#e6db74">&#34;LIMIT&#34;</span>)) {
</span></span><span style="display:flex;"><span>            sql <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34; LIMIT 1000&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sql;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * è·å–SQLå®‰å…¨éªŒè¯çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">getSecurityError</span>(String sql) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sql <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> sql.<span style="color:#a6e22e">trim</span>().<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;SQLè¯­å¥ä¸èƒ½ä¸ºç©º&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        String upperSql <span style="color:#f92672">=</span> sql.<span style="color:#a6e22e">toUpperCase</span>().<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>upperSql.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;SELECT&#34;</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;åªå…è®¸æ‰§è¡ŒSELECTæŸ¥è¯¢è¯­å¥&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (String keyword : DANGEROUS_KEYWORDS) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (upperSql.<span style="color:#a6e22e">contains</span>(keyword)) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;æ£€æµ‹åˆ°å±é™©æ“ä½œ: &#34;</span> <span style="color:#f92672">+</span> keyword;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (String systemTable : SYSTEM_TABLES) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (upperSql.<span style="color:#a6e22e">contains</span>(systemTable)) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;ç¦æ­¢è®¿é—®ç³»ç»Ÿè¡¨: &#34;</span> <span style="color:#f92672">+</span> systemTable;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (containsSqlInjection(sql)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;æ£€æµ‹åˆ°SQLæ³¨å…¥æ”»å‡»æ¨¡å¼&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;SQLè¯­å¥å®‰å…¨&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="å¸¸è§é—®é¢˜æ’æŸ¥æŒ‡å—ä¸æ•…éšœè¯Šæ–­">å¸¸è§é—®é¢˜æ’æŸ¥æŒ‡å—ä¸æ•…éšœè¯Šæ–­</h2>
<p>å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜å¾ˆæ­£å¸¸ï¼Œè¿™é‡Œæ˜¯æˆ‘æ€»ç»“çš„<strong>Text2SQL ç³»ç»Ÿ</strong>å¸¸è§é—®é¢˜åŠ<strong>æ•…éšœæ’æŸ¥</strong>è§£å†³æ–¹æ¡ˆï¼š</p>
<h3 id="ç¯å¢ƒé…ç½®é—®é¢˜">ç¯å¢ƒé…ç½®é—®é¢˜</h3>
<p><strong>API Key é…ç½®é—®é¢˜</strong></p>
<ul>
<li>ç¡®ä¿ <code>DEEPSEEK_API_KEY</code> <strong>ç¯å¢ƒå˜é‡</strong>å·²æ­£ç¡®è®¾ç½®</li>
<li>æ£€æŸ¥<strong>ç½‘ç»œè¿æ¥</strong>ï¼Œç¡®ä¿èƒ½è®¿é—® <strong>DeepSeek API æœåŠ¡</strong></li>
</ul>
<p><strong>æ•°æ®åº“è¿æ¥é—®é¢˜</strong></p>
<ul>
<li><strong>ç«¯å£å†²çª</strong>ï¼š3306 è¢«å ç”¨æ—¶ï¼Œä¿®æ”¹ <code>docker-compose.yml</code> ä¸­çš„<strong>ç«¯å£æ˜ å°„</strong></li>
<li><strong>å­—ç¬¦é›†é—®é¢˜</strong>ï¼šç¡®ä¿ <code>mysql.cnf</code> æ­£ç¡®æŒ‚è½½ï¼Œå­—ç¬¦é›†ç»Ÿä¸€ä¸º <code>utf8mb4</code></li>
</ul>
<h3 id="åŠŸèƒ½æ€§é—®é¢˜">åŠŸèƒ½æ€§é—®é¢˜</h3>
<p><strong>AI è‡ªç„¶è¯­è¨€ç†è§£ä¸å‡†ç¡®</strong></p>
<ul>
<li>æä¾›æ›´å…·ä½“çš„<strong>ä¸Šä¸‹æ–‡ä¿¡æ¯</strong>ï¼ˆè¡¨åã€å­—æ®µå«ä¹‰ã€ä¸šåŠ¡è§„åˆ™ï¼‰</li>
<li>åœ¨<strong>æç¤ºè¯æ¨¡æ¿</strong>ä¸­åŠ å…¥æ›´å¤šç¤ºä¾‹</li>
<li>è€ƒè™‘ä½¿ç”¨ <strong>MCP æ¨¡å¼</strong>è·å–çœŸå®<strong>æ•°æ®åº“ Schema ç»“æ„</strong></li>
</ul>
<p><strong>SQL è¯­æ³•é”™è¯¯</strong></p>
<ul>
<li>å¯ç”¨ MCP æ¨¡å¼ï¼Œå…ˆåšå°èŒƒå›´æµ‹è¯•</li>
<li>æ ¹æ®é”™è¯¯ä¿¡æ¯è°ƒæ•´æç¤ºè¯</li>
<li>å»ºç«‹ SQL è¯­æ³•æ£€æŸ¥æœºåˆ¶</li>
</ul>
<h3 id="æ€§èƒ½é—®é¢˜">æ€§èƒ½é—®é¢˜</h3>
<p><strong>æŸ¥è¯¢é€Ÿåº¦æ…¢</strong></p>
<ul>
<li>ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•</li>
<li>é™åˆ¶æŸ¥è¯¢ç»“æœæ•°é‡</li>
<li>è€ƒè™‘æ·»åŠ æŸ¥è¯¢ç¼“å­˜æœºåˆ¶</li>
</ul>
<h3 id="æœ€ä½³å®è·µå»ºè®®">æœ€ä½³å®è·µå»ºè®®</h3>
<p><strong>1. æç¤ºè¯ä¼˜åŒ–</strong></p>
<ul>
<li>ä½¿ç”¨å…·ä½“çš„ä¸šåŠ¡åœºæ™¯æè¿°</li>
<li>æä¾›è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li>
<li>å®šæœŸæ›´æ–°å’Œæµ‹è¯•æç¤ºè¯</li>
</ul>
<p><strong>2. é”™è¯¯å¤„ç†</strong></p>
<ul>
<li>å®ç°å®Œå–„çš„å¼‚å¸¸æ•è·æœºåˆ¶</li>
<li>æä¾›ç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯</li>
<li>è®°å½•è¯¦ç»†çš„é”™è¯¯æ—¥å¿—ç”¨äºè°ƒè¯•</li>
</ul>
<p><strong>3. æ€§èƒ½ç›‘æ§</strong></p>
<ul>
<li>ç›‘æ§SQLæ‰§è¡Œæ—¶é—´</li>
<li>è®°å½•AIæ¨¡å‹è°ƒç”¨æ¬¡æ•°å’Œæˆæœ¬</li>
<li>è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´</li>
</ul>
<p><strong>4. ç”¨æˆ·ä½“éªŒ</strong></p>
<ul>
<li>æä¾›æŸ¥è¯¢è¿›åº¦æŒ‡ç¤º</li>
<li>æ”¯æŒæŸ¥è¯¢å†å²è®°å½•</li>
<li>å®ç°æŸ¥è¯¢ç»“æœå¯¼å‡ºåŠŸèƒ½</li>
</ul>
<h2 id="é¡¹ç›®æ€»ç»“ä¸æŠ€æœ¯å±•æœ›">é¡¹ç›®æ€»ç»“ä¸æŠ€æœ¯å±•æœ›</h2>
<p>ä»æœ€åˆçš„ä¸€ä¸ªæƒ³æ³•ï¼Œåˆ°ç°åœ¨çš„å®Œæ•´å®ç°ï¼Œè¿™ä¸ªè¿‡ç¨‹è®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°äº† <strong>AI æŠ€æœ¯</strong>çš„é­…åŠ›ã€‚<strong>Text2SQL è‡ªç„¶è¯­è¨€æŸ¥è¯¢</strong>ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯åŠŸèƒ½ï¼Œå®ƒçœŸæ­£æ”¹å˜äº†æˆ‘ä»¬ä¸<strong>æ•°æ®åº“</strong>äº¤äº’çš„æ–¹å¼ã€‚</p>
<h3 id="æŠ€æœ¯æ”¶è·ä¸æˆé•¿">æŠ€æœ¯æ”¶è·ä¸æˆé•¿</h3>
<ol>
<li><strong>AI æŠ€æœ¯æˆé•¿</strong>ï¼šä»ç®€å•çš„<strong>æç¤ºè¯å·¥ç¨‹</strong>åˆ°å¤æ‚çš„ <strong>MCP å·¥å…·é›†æˆ</strong>ï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯å­¦ä¹ </li>
<li><strong>é—®é¢˜è§£å†³èƒ½åŠ›</strong>ï¼š<strong>ä¸­æ–‡ä¹±ç </strong>ã€<strong>å®‰å…¨é˜²æŠ¤</strong>ã€<strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼Œæ¯ä¸ªå‘éƒ½è®©æˆ‘æ›´å¼ºå¤§</li>
<li><strong>äº§å“æ€ç»´</strong>ï¼šä»<strong>æŠ€æœ¯å®ç°</strong>åˆ°<strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼Œè€ƒè™‘ç”¨æˆ·çœŸæ­£éœ€è¦ä»€ä¹ˆ</li>
</ol>
<h3 id="æœªæ¥æŠ€æœ¯è§„åˆ’">æœªæ¥æŠ€æœ¯è§„åˆ’</h3>
<p>è¿™ä¸ª <strong>Spring AI Text2SQL</strong> é¡¹ç›®è¿˜æœ‰å¾ˆå¤šå¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼š</p>
<p><strong>çŸ­æœŸæŠ€æœ¯ç›®æ ‡</strong>ï¼š</p>
<ul>
<li>æ”¯æŒ<strong>å¤šæ¨¡å‹åˆ‡æ¢</strong>ï¼ˆOpenAIã€Geminiã€Claude ç­‰ï¼‰</li>
<li>æ·»åŠ <strong>æŸ¥è¯¢å†å²</strong>å’Œ<strong>å¤šè½®å¯¹è¯</strong>åŠŸèƒ½</li>
<li>ä¼˜åŒ–<strong>æç¤ºè¯æ¨¡æ¿</strong>ï¼Œæé«˜ <strong>SQL ç”Ÿæˆå‡†ç¡®ç‡</strong></li>
</ul>
<p><strong>é•¿æœŸæŠ€æœ¯æ„¿æ™¯</strong>ï¼š</p>
<ul>
<li><strong>æ™ºèƒ½æŸ¥è¯¢ä¼˜åŒ–</strong>å»ºè®®</li>
<li><strong>æ•°æ®å¯è§†åŒ–æŠ¥è¡¨</strong>ç”Ÿæˆ</li>
<li>æ›´ä¸¥æ ¼çš„<strong>æƒé™æ§åˆ¶</strong>å’Œ<strong>å®¡è®¡æœºåˆ¶</strong></li>
<li>æ”¯æŒæ›´å¤š<strong>æ•°æ®åº“ç±»å‹</strong>ï¼ˆPostgreSQLã€Oracleã€MongoDBï¼‰</li>
</ul>
<h3 id="ç»™å¼€å‘è€…çš„å»ºè®®">ç»™å¼€å‘è€…çš„å»ºè®®</h3>
<p>å¦‚æœä½ ä¹Ÿæƒ³å°è¯• <strong>Text2SQL å¼€å‘</strong>ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼š</p>
<ol>
<li><strong>ä»ç®€å•å¼€å§‹</strong>ï¼šå…ˆç”¨<strong>ç›´æ¥æ¨¡å¼</strong>å¿«é€ŸéªŒè¯æƒ³æ³•</li>
<li><strong>é€æ­¥ä¼˜åŒ–</strong>ï¼šæ ¹æ®å®é™…éœ€æ±‚å¼•å…¥ <strong>MCP</strong> å’Œ<strong>åˆ†æ­¥éª¤æ¨¡å¼</strong></li>
<li><strong>å®‰å…¨ç¬¬ä¸€</strong>ï¼šä»ä¸€å¼€å§‹å°±è€ƒè™‘<strong>å®‰å…¨é—®é¢˜</strong>ï¼Œä¸è¦äº‹åè¡¥æ•‘</li>
<li><strong>æŒç»­å­¦ä¹ </strong>ï¼š<strong>AI æŠ€æœ¯</strong>å‘å±•å¾ˆå¿«ï¼Œä¿æŒå­¦ä¹ çš„å¿ƒæ€</li>
</ol>
<h3 id="æŠ€æœ¯é€‰å‹ä¸æ¶æ„å»ºè®®">æŠ€æœ¯é€‰å‹ä¸æ¶æ„å»ºè®®</h3>
<p><strong>AI å¤§è¯­è¨€æ¨¡å‹é€‰æ‹©</strong>ï¼š</p>
<ul>
<li><strong>DeepSeek</strong>ï¼šæ€§ä»·æ¯”é«˜ï¼Œ<strong>ä¸­æ–‡ç†è§£</strong>å¥½ï¼Œé€‚åˆä¸ªäººé¡¹ç›®</li>
<li><strong>OpenAI GPT-4</strong>ï¼šå‡†ç¡®ç‡é«˜ï¼Œä½†æˆæœ¬è¾ƒé«˜</li>
<li><strong>Claude</strong>ï¼š<strong>æ¨ç†èƒ½åŠ›</strong>å¼ºï¼Œé€‚åˆå¤æ‚æŸ¥è¯¢</li>
<li><strong>æœ¬åœ°æ¨¡å‹</strong>ï¼šæ•°æ®å®‰å…¨ï¼Œä½†éœ€è¦å¼ºå¤§çš„ç¡¬ä»¶æ”¯æŒ</li>
</ul>
<p><strong>æ•°æ®åº“æ”¯æŒ</strong>ï¼š</p>
<ul>
<li><strong>MySQL</strong>ï¼šæœ€å¸¸ç”¨ï¼Œç”Ÿæ€å®Œå–„</li>
<li><strong>PostgreSQL</strong>ï¼šåŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢</li>
<li><strong>SQLite</strong>ï¼šè½»é‡çº§ï¼Œé€‚åˆåŸå‹å¼€å‘</li>
<li><strong>ClickHouse</strong>ï¼šé€‚åˆå¤§æ•°æ®åˆ†æåœºæ™¯</li>
</ul>
<h3 id="é¡¹ç›®æ‰©å±•æ–¹å‘">é¡¹ç›®æ‰©å±•æ–¹å‘</h3>
<p><strong>çŸ­æœŸæ‰©å±•</strong>ï¼š</p>
<ul>
<li>æ”¯æŒæ›´å¤šæ•°æ®åº“ç±»å‹</li>
<li>æ·»åŠ æŸ¥è¯¢å†å²å’Œç®¡ç†åŠŸèƒ½</li>
<li>å®ç°æŸ¥è¯¢ç»“æœå¯è§†åŒ–</li>
<li>æ”¯æŒå¤šè¯­è¨€æŸ¥è¯¢</li>
</ul>
<p><strong>é•¿æœŸè§„åˆ’</strong>ï¼š</p>
<ul>
<li>é›†æˆå‘é‡æ•°æ®åº“ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢</li>
<li>å®ç°æ™ºèƒ½æŸ¥è¯¢ä¼˜åŒ–å»ºè®®</li>
<li>æ·»åŠ æ•°æ®è¡€ç¼˜åˆ†æåŠŸèƒ½</li>
<li>æ”¯æŒè‡ªç„¶è¯­è¨€åˆ°å¤æ‚æŠ¥è¡¨çš„ç”Ÿæˆ</li>
</ul>
<h2 id="å­¦ä¹ èµ„æºæ¨è">å­¦ä¹ èµ„æºæ¨è</h2>
<p><strong>å®˜æ–¹æ–‡æ¡£</strong>ï¼š</p>
<ul>
<li><a href="https://docs.spring.io/spring-ai/reference/" target="_blank">Spring AI å®˜æ–¹æ–‡æ¡£</a> - Spring AI æ¡†æ¶å®Œæ•´æŒ‡å—</li>
<li><a href="https://platform.openai.com/docs" target="_blank">OpenAI API æ–‡æ¡£</a> - GPT æ¨¡å‹ API ä½¿ç”¨æ–‡æ¡£</li>
<li><a href="https://dev.mysql.com/doc/" target="_blank">MySQL å®˜æ–¹æ–‡æ¡£</a> - MySQL æ•°æ®åº“å®Œæ•´æ–‡æ¡£</li>
<li><a href="https://platform.deepseek.com/api-docs" target="_blank">DeepSeek API æ–‡æ¡£</a> - DeepSeek å¤§è¯­è¨€æ¨¡å‹ API</li>
</ul>
<p><strong>ç›¸å…³æŠ€æœ¯æ¡†æ¶</strong>ï¼š</p>
<ul>
<li><a href="https://python.langchain.com/" target="_blank">LangChain</a> - Python ç”Ÿæ€çš„ AI åº”ç”¨å¼€å‘æ¡†æ¶</li>
<li><a href="https://www.llamaindex.ai/" target="_blank">LlamaIndex</a> - æ•°æ®ç´¢å¼•å’Œæ£€ç´¢æ¡†æ¶</li>
<li><a href="https://modelcontextprotocol.io/" target="_blank">MCP åè®®</a> - æ¨¡å‹ä¸Šä¸‹æ–‡åè®®æ ‡å‡†</li>
<li><a href="https://spring.io/projects/spring-boot" target="_blank">Spring Boot</a> - Java ä¼ä¸šçº§åº”ç”¨å¼€å‘æ¡†æ¶</li>
</ul>
<p><strong>Text2SQL ç›¸å…³èµ„æº</strong>ï¼š</p>
<ul>
<li><a href="https://github.com/eosphoros-ai/awesome-text2sql" target="_blank">Text2SQL è®ºæ–‡é›†åˆ</a> - Text2SQL å­¦æœ¯ç ”ç©¶èµ„æº</li>
<li><a href="https://owasp.org/www-community/attacks/SQL_Injection" target="_blank">SQL æ³¨å…¥é˜²æŠ¤æŒ‡å—</a> - OWASP SQL æ³¨å…¥é˜²æŠ¤</li>
<li><a href="https://www.sqlstyle.guide/" target="_blank">æ•°æ®åº“è®¾è®¡æœ€ä½³å®è·µ</a> - SQL ç¼–ç è§„èŒƒæŒ‡å—</li>
</ul>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹ä½ æœ‰å¸®åŠ©ã€‚å¦‚æœä½ åœ¨å®ç°è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œæ¬¢è¿äº¤æµè®¨è®ºï¼</p>
<h2 id="è‡´è°¢">è‡´è°¢</h2>
<p>æ„Ÿè°¢ <a href="https://spring.io/projects/spring-ai" target="_blank">Spring AI å›¢é˜Ÿ</a> æä¾›çš„ä¼˜ç§€æ¡†æ¶ï¼Œæ„Ÿè°¢ <a href="https://www.deepseek.com/" target="_blank">DeepSeek</a> æä¾›çš„ AI æœåŠ¡æ”¯æŒï¼Œæ„Ÿè°¢æ‰€æœ‰ <a href="https://github.com/" target="_blank">å¼€æºç¤¾åŒº</a> çš„è´¡çŒ®è€…ä»¬ã€‚æ­£æ˜¯æœ‰äº†è¿™äº›ä¼˜ç§€çš„å·¥å…·å’Œç¤¾åŒºï¼Œæˆ‘ä»¬æ‰èƒ½å¿«é€Ÿæ„å»ºå‡ºå¦‚æ­¤å¼ºå¤§çš„ <strong>Text2SQL è‡ªç„¶è¯­è¨€æŸ¥è¯¢ç³»ç»Ÿ</strong>ã€‚</p>
<hr>
<p><em>æœ¬æ–‡åŸºäº Spring AI 1.1.0-M2 ç‰ˆæœ¬ç¼–å†™ï¼Œ<a href="https://github.com/chensoul/spring-ai-text2sql-showcase" target="_blank">é¡¹ç›®ä»£ç å·²å¼€æº</a>ï¼Œæ¬¢è¿ Star å’Œ Forkï¼</em></p>
		</div>


	</article>
</main>
<footer class="post__footer">
	

<div class="post-related">
	<h3>ç›¸å…³æ–‡ç« </h3>
	<ul class="post-related-list">
		
		<li class="post-related-item">
			<a href="/posts/2025/09/26/spring-ai-restaurant-showcase-rag/" target="_blank" title="åŸºäº Spring AI æ„å»ºæ™ºèƒ½é¤å…æ¨èç³»ç»Ÿï¼šRAG æŠ€æœ¯å®æˆ˜">åŸºäº Spring AI æ„å»ºæ™ºèƒ½é¤å…æ¨èç³»ç»Ÿï¼šRAG æŠ€æœ¯å®æˆ˜</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2025/09/25/spring-ai-restaurant-showcase/" target="_blank" title="åŸºäº Spring AI æ„å»ºæ™ºèƒ½é¤å…æ¨èç³»ç»Ÿï¼šå¤šæ¨¡å‹é›†æˆçš„å®è·µæŒ‡å—">åŸºäº Spring AI æ„å»ºæ™ºèƒ½é¤å…æ¨èç³»ç»Ÿï¼šå¤šæ¨¡å‹é›†æˆçš„å®è·µæŒ‡å—</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2025/09/22/openai-api-with-spring-ai/" target="_blank" title="OpenAI API æ¥å£ä¸ Spring AI å¯¹åº”å…³ç³»">OpenAI API æ¥å£ä¸ Spring AI å¯¹åº”å…³ç³»</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2025/09/19/spring-ai-chat-client-api/" target="_blank" title="Spring AI ChatClient API ä»‹ç»">Spring AI ChatClient API ä»‹ç»</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2025/09/18/spring-ai/" target="_blank" title="Spring AI ä»‹ç»">Spring AI ä»‹ç»</a>
		</li>
		
		<li class="post-related-item">
			<a href="/posts/2025/07/15/ruoyi-ai/" target="_blank" title="RuoYi AI æºç åˆ†æ">RuoYi AI æºç åˆ†æ</a>
		</li>
		
	</ul>
</div>

</footer>

<footer class="post__footer">
	<footer class="post__footer">
		
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 0 0 0-6 3 3 0 0 0 0 6"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/java/" rel="tag">java</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/spring-boot/" rel="tag">spring-boot</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/spring-ai/" rel="tag">spring-ai</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/tutorial/" rel="tag">tutorial</a>
		</li>
	</ul>
</div>
	</footer>
</footer>


<nav class="pagination flex">
	<div class="pagination__item pagination__item--prev">
		<a class="pagination__link" href="/posts/2025/09/29/spec-kit-with-cursor/" rel="prev">
			<p class="pagination__title">Â«&thinsp;ä¸Šä¸€ç¯‡: Spec-Kit åœ¨ Cursor ä¸­çš„å®‰è£…å’Œä½¿ç”¨æŒ‡å—</p>
		</a>
	</div>
</nav>



<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="ChenSoul avatar" src="/avatar.jpg" class="avatar" height="60" width="60" loading="lazy">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">å…³äº ChenSoul</span>
	</div>
	<div class="authorbox__description">
		ä¸€ä¸ªæ¥è‡ªä¸­å›½æ­¦æ±‰çš„å¼€å‘è€…ï¼Œä¸»è¦æ’°å†™è½¯ä»¶å¼€å‘å’Œå¼€æºæ–¹é¢çš„æ–‡ç« ã€‚æµè§ˆæˆ‘çš„<a href="%28/posts%29">åšå®¢æ–‡ç« </a>ï¼Œè®¢é˜…æˆ‘çš„ <a href="/index.xml">RSS</a> æºï¼Œæˆ–äº†è§£æ›´å¤š<a href="/about/">å…³äºæˆ‘</a>çš„ä¿¡æ¯ã€‚
	</div>
</div>




	<p><h3>æ¬¢è¿ç•™è¨€ï¼</h3></p>
<div id="remark42"></div>
<script>
	var remark_config = {
		host: 'https:\/\/comment.chensoul.cc',
		site_id: 'remark',
		components: ['embed'],
		url: 'https:\/\/blog.chensoul.cc\/posts\/2025\/09\/30\/spring-ai-text2sql-showcase\/',
		locale: 'zh'
	};

	!function(e, n) {
		for (var o = 0; o < e.length; o++) {
			var r = n.createElement('script'),
			c = '.js',
			d = n.head || n.body;
			'noModule' in r ? (r.type = 'module', c = '.mjs') : r.async = !0, r.defer = !0, r.src = remark_config.host + '/web/' + e[o] + c, d.appendChild(r)
		}
	}(remark_config.components || ['embed'], document);

</script>



<script defer src="https://cdn.jsdmirror.com/npm/mermaid@11.8.0/dist/mermaid.min.js" integrity="sha256-ozuDfeDhjEI9EXLi0CdigeIiAcaRYi3E5T+VLC9yIB4=" crossorigin="anonymous" async></script>



			</div>
			

<aside class="sidebar sidebar--right">
	<div class="post__toc toc">
		<div class="toc__title">ç›®å½•</div>
		<div class="toc__menu">
			<nav id="TableOfContents">
  <ul>
    <li><a href="#æºä»£ç ">æºä»£ç </a></li>
    <li><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©-text2sql">ä¸ºä»€ä¹ˆé€‰æ‹© Text2SQL</a></li>
    <li><a href="#10-åˆ†é’Ÿå¿«é€Ÿä½“éªŒ">10 åˆ†é’Ÿå¿«é€Ÿä½“éªŒ</a></li>
    <li><a href="#ç¬¬ä¸€ç‰ˆç®€å•ç²—æš´çš„ç›´æ¥æ¨¡å¼">ç¬¬ä¸€ç‰ˆï¼šç®€å•ç²—æš´çš„ç›´æ¥æ¨¡å¼</a>
      <ul>
        <li><a href="#ç³»ç»Ÿæ¶æ„å›¾">ç³»ç»Ÿæ¶æ„å›¾</a></li>
        <li><a href="#æ ¸å¿ƒä»£ç å®ç°">æ ¸å¿ƒä»£ç å®ç°</a></li>
        <li><a href="#æ ¸å¿ƒé…ç½®">æ ¸å¿ƒé…ç½®</a></li>
        <li><a href="#spring-ai-é…ç½®ç±»">Spring AI é…ç½®ç±»</a></li>
        <li><a href="#api-æ¥å£è®¾è®¡">API æ¥å£è®¾è®¡</a></li>
        <li><a href="#rest-controller-å®ç°">REST Controller å®ç°</a></li>
        <li><a href="#å‰ç«¯ç•Œé¢å±•ç¤º">å‰ç«¯ç•Œé¢å±•ç¤º</a></li>
      </ul>
    </li>
    <li><a href="#ç¬¬äºŒç‰ˆmcp-å·¥å…·é›†æˆæ¨¡å¼---è®©-ai-æ›´èªæ˜">ç¬¬äºŒç‰ˆï¼šMCP å·¥å…·é›†æˆæ¨¡å¼ - è®© AI æ›´èªæ˜</a>
      <ul>
        <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦-mcp-å·¥å…·è°ƒç”¨">ä¸ºä»€ä¹ˆéœ€è¦ MCP å·¥å…·è°ƒç”¨ï¼Ÿ</a></li>
        <li><a href="#mcp-å·¥å…·è°ƒç”¨æµç¨‹å›¾">MCP å·¥å…·è°ƒç”¨æµç¨‹å›¾</a></li>
        <li><a href="#spring-ai-é…ç½®ç±»-1">Spring AI é…ç½®ç±»</a></li>
        <li><a href="#mcptext2sqlservice">McpText2SqlService</a></li>
      </ul>
    </li>
    <li><a href="#ç¬¬ä¸‰ç‰ˆåˆ†æ­¥éª¤æŸ¥è¯¢æ¨¡å¼---è®©-ai-æ¨ç†è¿‡ç¨‹é€æ˜åŒ–">ç¬¬ä¸‰ç‰ˆï¼šåˆ†æ­¥éª¤æŸ¥è¯¢æ¨¡å¼ - è®© AI æ¨ç†è¿‡ç¨‹é€æ˜åŒ–</a>
      <ul>
        <li><a href="#æ¯ä¸€æ­¥éƒ½åœ¨åšä»€ä¹ˆ">æ¯ä¸€æ­¥éƒ½åœ¨åšä»€ä¹ˆï¼Ÿ</a></li>
        <li><a href="#åˆ†æ­¥éª¤æŸ¥è¯¢çš„æç¤ºè¯è®¾è®¡">åˆ†æ­¥éª¤æŸ¥è¯¢çš„æç¤ºè¯è®¾è®¡</a></li>
        <li><a href="#åˆ†æ­¥éª¤æŸ¥è¯¢çš„å‰ç«¯ç•Œé¢">åˆ†æ­¥éª¤æŸ¥è¯¢çš„å‰ç«¯ç•Œé¢</a></li>
      </ul>
    </li>
    <li><a href="#ç¬¬å››ç‰ˆæ™ºèƒ½ä¸šåŠ¡è§„åˆ™æ¨ç†è®©aiæ›´æ‡‚ä¸šåŠ¡">ç¬¬å››ç‰ˆï¼šæ™ºèƒ½ä¸šåŠ¡è§„åˆ™æ¨ç†ï¼Œè®©AIæ›´æ‡‚ä¸šåŠ¡</a>
      <ul>
        <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦ä¸šåŠ¡è§„åˆ™æ¨ç†">ä¸ºä»€ä¹ˆéœ€è¦ä¸šåŠ¡è§„åˆ™æ¨ç†ï¼Ÿ</a></li>
        <li><a href="#ä¸šåŠ¡è§„åˆ™æ¨ç†çš„æ ¸å¿ƒç»„ä»¶">ä¸šåŠ¡è§„åˆ™æ¨ç†çš„æ ¸å¿ƒç»„ä»¶</a></li>
        <li><a href="#æ­¥éª¤3ä¿¡æ¯æ¨ç†çš„æ™ºèƒ½åŒ–å‡çº§">æ­¥éª¤3ï¼šä¿¡æ¯æ¨ç†çš„æ™ºèƒ½åŒ–å‡çº§</a></li>
        <li><a href="#ä¸šåŠ¡è§„åˆ™æ¨ç†çš„å®é™…æ•ˆæœ">ä¸šåŠ¡è§„åˆ™æ¨ç†çš„å®é™…æ•ˆæœ</a></li>
        <li><a href="#æŠ€æœ¯å®ç°ç»†èŠ‚">æŠ€æœ¯å®ç°ç»†èŠ‚</a></li>
        <li><a href="#ä¸šåŠ¡è§„åˆ™æ¨ç†çš„ä¼˜åŠ¿">ä¸šåŠ¡è§„åˆ™æ¨ç†çš„ä¼˜åŠ¿</a></li>
        <li><a href="#å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</a></li>
        <li><a href="#ç‰ˆæœ¬æ¼”è¿›å¯¹æ¯”">ç‰ˆæœ¬æ¼”è¿›å¯¹æ¯”</a></li>
      </ul>
    </li>
    <li><a href="#å®‰å…¨ç¬¬ä¸€sql-æ³¨å…¥é˜²æŠ¤ä¸æ•°æ®å®‰å…¨ç­–ç•¥">å®‰å…¨ç¬¬ä¸€ï¼šSQL æ³¨å…¥é˜²æŠ¤ä¸æ•°æ®å®‰å…¨ç­–ç•¥</a>
      <ul>
        <li><a href="#æ ¸å¿ƒå®‰å…¨é˜²æŠ¤ç­–ç•¥">æ ¸å¿ƒå®‰å…¨é˜²æŠ¤ç­–ç•¥</a></li>
        <li><a href="#sql-æ³¨å…¥é˜²æŠ¤ä»£ç ç¤ºä¾‹">SQL æ³¨å…¥é˜²æŠ¤ä»£ç ç¤ºä¾‹</a></li>
      </ul>
    </li>
    <li><a href="#å¸¸è§é—®é¢˜æ’æŸ¥æŒ‡å—ä¸æ•…éšœè¯Šæ–­">å¸¸è§é—®é¢˜æ’æŸ¥æŒ‡å—ä¸æ•…éšœè¯Šæ–­</a>
      <ul>
        <li><a href="#ç¯å¢ƒé…ç½®é—®é¢˜">ç¯å¢ƒé…ç½®é—®é¢˜</a></li>
        <li><a href="#åŠŸèƒ½æ€§é—®é¢˜">åŠŸèƒ½æ€§é—®é¢˜</a></li>
        <li><a href="#æ€§èƒ½é—®é¢˜">æ€§èƒ½é—®é¢˜</a></li>
        <li><a href="#æœ€ä½³å®è·µå»ºè®®">æœ€ä½³å®è·µå»ºè®®</a></li>
      </ul>
    </li>
    <li><a href="#é¡¹ç›®æ€»ç»“ä¸æŠ€æœ¯å±•æœ›">é¡¹ç›®æ€»ç»“ä¸æŠ€æœ¯å±•æœ›</a>
      <ul>
        <li><a href="#æŠ€æœ¯æ”¶è·ä¸æˆé•¿">æŠ€æœ¯æ”¶è·ä¸æˆé•¿</a></li>
        <li><a href="#æœªæ¥æŠ€æœ¯è§„åˆ’">æœªæ¥æŠ€æœ¯è§„åˆ’</a></li>
        <li><a href="#ç»™å¼€å‘è€…çš„å»ºè®®">ç»™å¼€å‘è€…çš„å»ºè®®</a></li>
        <li><a href="#æŠ€æœ¯é€‰å‹ä¸æ¶æ„å»ºè®®">æŠ€æœ¯é€‰å‹ä¸æ¶æ„å»ºè®®</a></li>
        <li><a href="#é¡¹ç›®æ‰©å±•æ–¹å‘">é¡¹ç›®æ‰©å±•æ–¹å‘</a></li>
      </ul>
    </li>
    <li><a href="#å­¦ä¹ èµ„æºæ¨è">å­¦ä¹ èµ„æºæ¨è</a></li>
    <li><a href="#è‡´è°¢">è‡´è°¢</a></li>
  </ul>
</nav>
		</div>
	</div>
</aside>

		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
<div class="footer__links">
	<a class="footer__link" href="/">é¦–é¡µ</a> | <a class="footer__link" href="/categories/">åˆ†ç±»</a> | <a class="footer__link" href="/tags/">æ ‡ç­¾</a> | <a class="footer__link" href="/index.xml">è®¢é˜…</a> | <a class="footer__link" href="/about/">å…³äº</a>
</div>
		<div class="footer__copyright">
			&copy; 2025 ChenSoul.
			<span class="footer__copyright-credits">åŸºäº <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> å¼•æ“å’Œ <a href="https://github.com/chensoul/rose-hugo/" rel="nofollow noopener" target="_blank">Rose Hugo</a> ä¸»é¢˜</span>
		</div>
	</div>

	






<style>
	.scroll-up a {
		display: block;
		height: 3.125rem;
		width: 3.125rem;
		text-align: center;
		line-height: 2.7;
		border-radius: 50px;
		font-size: 1.125rem;
		color: #fff;
		opacity: 1;
		transition: all 0.3s ease 0s;
		box-shadow: 0 0 10px rgb(0 0 0 / 20%);
	}
	.scroll-up a {
		background: #ee591f;
	}
	.scroll-up {
		position: fixed;
		display: none;
		bottom: 50px;
		z-index: 999;
	}
	.scroll-up.right {
		right: 60px;
	}
</style>

<div class="scroll-up custom right" style="display: block;"><a href="#top" id="top-link" accesskey="g"><i
	class="fa fa-arrow-up"></i></a></div>

<script>
	var mybutton = document.getElementById("top-link");
	window.onscroll = function () {
		if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
			mybutton.style.visibility = "visible";
			mybutton.style.opacity = "1";
		} else {
			mybutton.style.visibility = "hidden";
			mybutton.style.opacity = "0";
		}
	};
</script>


    <script defer src="https://umami.chensoul.cc/random-string.js" data-website-id="1e07d36d-bec3-4ba6-9459-876b1ac3bbe7"></script>
</footer>


	</div>

	<script>
		'use strict';
		(function iifeMenu(document, window, undefined) {
			var menuBtn = document.querySelector('.menu__btn');
			var	menu = document.querySelector('.menu__list');
			function toggleMenu() {
				menu.classList.toggle('menu__list--active');
				menu.classList.toggle('menu__list--transition');
				this.classList.toggle('menu__btn--active');
				this.setAttribute(
					'aria-expanded',
					this.getAttribute('aria-expanded') === 'true' ? 'false' : 'true'
				);
			}
			function removeMenuTransition() {
				this.classList.remove('menu__list--transition');
			}
			if (menuBtn && menu) {
				menuBtn.addEventListener('click', toggleMenu, false);
				menu.addEventListener('transitionend', removeMenuTransition, false);
			}
		}(document, window));
	</script>
</body>
</html>