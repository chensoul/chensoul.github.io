<!doctype html><html lang=zh itemscope itemtype=http://schema.org/WebPage><head><meta name=generator content="Hugo 0.109.0"><meta charset=utf-8><title>Greenplum安装和部署 · ChenSoul</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="本文主要介绍如何快速安装部署单节点的 Greenplum过程，以及Greenplum的一些常用命令及工具。 环境准备 环境说明 操作系统：Cento"><meta name=keywords content="devops,programming"><link rel=canonical href=https://blog.chensoul.com/posts/greenplum-install-deploy/><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><link rel=stylesheet href=https://blog.chensoul.com/css/den.css><meta property="og:title" content="Greenplum安装和部署"><meta property="og:description" content="本文主要介绍如何快速安装部署单节点的 Greenplum过程，以及Greenplum的一些常用命令及工具。 环境准备 环境说明 操作系统：Cento"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chensoul.com/posts/greenplum-install-deploy/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-19T17:14:18+08:00"><meta property="article:modified_time" content="2022-08-19T17:14:18+08:00"><meta itemprop=name content="Greenplum安装和部署"><meta itemprop=description content="本文主要介绍如何快速安装部署单节点的 Greenplum过程，以及Greenplum的一些常用命令及工具。 环境准备 环境说明 操作系统：Cento"><meta itemprop=datePublished content="2022-08-19T17:14:18+08:00"><meta itemprop=dateModified content="2022-08-19T17:14:18+08:00"><meta itemprop=wordCount content="4354"><meta itemprop=keywords content="greenplum,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Greenplum安装和部署"><meta name=twitter:description content="本文主要介绍如何快速安装部署单节点的 Greenplum过程，以及Greenplum的一些常用命令及工具。 环境准备 环境说明 操作系统：Cento"></head><body><div class=header-container style=background:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://blog.chensoul.com/images/background.webp);background-position:50%;background-size:cover><div class=container><nav class="header-nav navbar navbar-expand-md navbar-dark light-dark"><div class="header-logo navbar-brand"><a class=float-left href=https://blog.chensoul.com/><img class="mr20 header-logo-image" src=https://blog.chensoul.com/images/fly.png alt=logo>
ChenSoul</a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="nav-menu collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://blog.chensoul.com/category/idea/>思考</a></li><li class=nav-item><a class=nav-link href=https://blog.chensoul.com/link/>友链</a></li><li class=nav-item><a class=nav-link href=https://blog.chensoul.com/about/>关于</a></li></ul></div></nav></div><div class="container header-wrapper"><div class=row><div class=col-lg-12><div class=header-content><h1 class=header-title>Greenplum安装和部署</h1><p class=header-date>作者：
ChenShu /
2022-08-19
/ 分类：
<a href=https://blog.chensoul.com/categories/database/>database</a></p><div class=header-underline></div><div class=clearfix></div><p class="float-right header-tags"><i class="fas fa-tags" aria-hidden=true></i>
<a href=https://blog.chensoul.com/tags/greenplum/>greenplum</a></p></div></div></div></div></div><main><div class="container content"><article><p>本文主要介绍如何快速安装部署单节点的 Greenplum过程，以及Greenplum的一些常用命令及工具。</p><h2 id=环境准备>环境准备</h2><h3 id=环境说明>环境说明</h3><p>操作系统：Centos7</p><p>节点环境：</p><table><thead><tr><th>ip</th><th>hostname</th><th>角色</th></tr></thead><tbody><tr><td>192.168.56.141</td><td>dw-test-node001</td><td>master</td></tr><tr><td>192.168.56.142</td><td>dw-test-node002</td><td>segment</td></tr><tr><td>192.168.56.143</td><td>dw-test-node003</td><td>segment</td></tr></tbody></table><p>安装用户：root</p><h3 id=配置系统参数>配置系统参数</h3><p>在每台服务器上执行以下操作。</p><h4 id=配置hosts文件>配置hosts文件</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; /etc/hosts <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>192.168.56.141 dw-test-node001
</span></span></span><span class=line><span class=cl><span class=s>192.168.56.142 dw-test-node002
</span></span></span><span class=line><span class=cl><span class=s>192.168.56.143 dw-test-node003
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><h4 id=关闭selinux>关闭selinux</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>setenforce <span class=m>0</span>  &gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>sed -i -e <span class=s1>&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/sysconfig/selinux
</span></span><span class=line><span class=cl>sed -i -e <span class=s1>&#39;s/^SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/selinux/config
</span></span></code></pre></div><h4 id=关闭防火墙>关闭防火墙</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl stop firewalld.service <span class=o>&amp;&amp;</span> systemctl disable firewalld.service
</span></span></code></pre></div><h4 id=设置时钟同步>设置时钟同步</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum install ntp -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat &gt; /etc/ntp.conf <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>#在与上级时间服务器联系时所花费的时间，记录在driftfile参数后面的文件
</span></span></span><span class=line><span class=cl><span class=s>driftfile /var/lib/ntp/drift
</span></span></span><span class=line><span class=cl><span class=s>#默认关闭所有的 NTP 联机服务
</span></span></span><span class=line><span class=cl><span class=s>restrict default ignore
</span></span></span><span class=line><span class=cl><span class=s>restrict -6 default ignore
</span></span></span><span class=line><span class=cl><span class=s>#如从loopback网口请求，则允许NTP的所有操作
</span></span></span><span class=line><span class=cl><span class=s>restrict 127.0.0.1
</span></span></span><span class=line><span class=cl><span class=s>restrict -6 ::1
</span></span></span><span class=line><span class=cl><span class=s>#使用指定的时间服务器
</span></span></span><span class=line><span class=cl><span class=s>server ntp1.aliyun.com
</span></span></span><span class=line><span class=cl><span class=s>server ntp2.aliyun.com
</span></span></span><span class=line><span class=cl><span class=s>server ntp3.aliyun.com
</span></span></span><span class=line><span class=cl><span class=s>#允许指定的时间服务器查询本时间服务器的信息
</span></span></span><span class=line><span class=cl><span class=s>restrict ntp1.aliyun.com nomodify notrap nopeer noquery
</span></span></span><span class=line><span class=cl><span class=s>#其它认证信息
</span></span></span><span class=line><span class=cl><span class=s>includefile /etc/ntp/crypto/pw
</span></span></span><span class=line><span class=cl><span class=s>keys /etc/ntp/keys
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>systemctl start ntpd <span class=o>&amp;&amp;</span> systemctl <span class=nb>enable</span> ntpd
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;* */6 * * * /usr/sbin/ntpdate -u ntp1.aliyun.com &amp;&amp; /sbin/hwclock --systohc &gt; /dev/null 2&gt;&amp;1&#39;</span> &gt;&gt; /var/spool/cron/<span class=sb>`</span>whoami<span class=sb>`</span>
</span></span></code></pre></div><h4 id=配置内核参数>配置内核参数</h4><p>参考 <a href="https://segmentfault.com/a/1190000020654036?utm_source=tag-newest">https://segmentfault.com/a/1190000020654036?utm_source=tag-newest</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#设置内核参数</span>
</span></span><span class=line><span class=cl>cat &gt; greenplum.conf <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>kernel.shmall = 2033299
</span></span></span><span class=line><span class=cl><span class=s>kernel.shmmax = 8328392704
</span></span></span><span class=line><span class=cl><span class=s>kernel.shmmni = 4096
</span></span></span><span class=line><span class=cl><span class=s>kernel.sem = 500 1024000 200 4096
</span></span></span><span class=line><span class=cl><span class=s>kernel.sysrq = 1
</span></span></span><span class=line><span class=cl><span class=s>kernel.core_uses_pid = 1
</span></span></span><span class=line><span class=cl><span class=s>kernel.msgmnb = 65536
</span></span></span><span class=line><span class=cl><span class=s>kernel.msgmax = 65536
</span></span></span><span class=line><span class=cl><span class=s>kernel.msgmni = 31764
</span></span></span><span class=line><span class=cl><span class=s>net.ipv4.tcp_syncookies = 1
</span></span></span><span class=line><span class=cl><span class=s>net.ipv4.conf.default.accept_source_route = 0
</span></span></span><span class=line><span class=cl><span class=s>net.ipv4.tcp_tw_recycle = 1
</span></span></span><span class=line><span class=cl><span class=s>net.ipv4.tcp_max_syn_backlog = 4096
</span></span></span><span class=line><span class=cl><span class=s>net.ipv4.conf.all.arp_filter = 1
</span></span></span><span class=line><span class=cl><span class=s>net.ipv4.ip_local_port_range = 10000 65535
</span></span></span><span class=line><span class=cl><span class=s>net.core.netdev_max_backlog = 10000
</span></span></span><span class=line><span class=cl><span class=s>net.core.rmem_max = 2097152
</span></span></span><span class=line><span class=cl><span class=s>net.core.wmem_max = 2097152
</span></span></span><span class=line><span class=cl><span class=s>vm.overcommit_memory = 2
</span></span></span><span class=line><span class=cl><span class=s>vm.overcommit_ratio = 95 
</span></span></span><span class=line><span class=cl><span class=s>vm.swappiness = 0
</span></span></span><span class=line><span class=cl><span class=s>vm.zone_reclaim_mode = 0
</span></span></span><span class=line><span class=cl><span class=s>#这个时候，后台进行在脏数据达到3%时就开始异步清理，但在10%之前系统不会强制同步写磁盘。刷脏进程3秒起来一次，脏数据存活超过10秒就会开始刷。
</span></span></span><span class=line><span class=cl><span class=s>vm.dirty_expire_centisecs = 500
</span></span></span><span class=line><span class=cl><span class=s>vm.dirty_writeback_centisecs = 100
</span></span></span><span class=line><span class=cl><span class=s>vm.dirty_background_ratio = 3
</span></span></span><span class=line><span class=cl><span class=s>vm.dirty_ratio = 10
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mv greenplum.conf /etc/sysctl.d/greenplum.conf
</span></span><span class=line><span class=cl>sysctl -p /etc/sysctl.d/greenplum.conf
</span></span></code></pre></div><p>生产环境的配置，需要详细参考官方文档的说明：https://gpdb.docs.pivotal.io/6-1/install_guide/prep_os.html#topic3__sysctl_file</p><p>kernel.shmall（共享内存页总数）
kernel.shmmax (共享内存段的最大值)
一般来讲，这两个参数的值应该是物理内存的一半，可以通过操作系统的值_PHYS_PAGES和PAGE_SIZE计算得出。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kernel.shmall <span class=o>=</span> <span class=o>(</span> _PHYS_PAGES / 2<span class=o>)</span>
</span></span><span class=line><span class=cl>kernel.shmmax <span class=o>=</span> <span class=o>(</span> _PHYS_PAGES / 2<span class=o>)</span> * PAGE_SIZE
</span></span></code></pre></div><p>也可以通过以下两个命令得出这两个参数的值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=k>$(</span>expr <span class=k>$(</span>getconf _PHYS_PAGES<span class=k>)</span> / 2<span class=k>)</span> 
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=k>$(</span>expr <span class=k>$(</span>getconf _PHYS_PAGES<span class=k>)</span> / <span class=m>2</span> <span class=se>\*</span> <span class=k>$(</span>getconf PAGE_SIZE<span class=k>))</span>
</span></span></code></pre></div><p>如果得出的kernel.shmmax值小于系统的默认值，则引用系统默认值即可</p><p>对于64G内存的操作系统，建议配置如下值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vm.dirty_background_ratio <span class=o>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>vm.dirty_ratio <span class=o>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>vm.dirty_background_bytes <span class=o>=</span> <span class=m>1610612736</span> <span class=c1># 1.5GB</span>
</span></span><span class=line><span class=cl>vm.dirty_bytes <span class=o>=</span> <span class=m>4294967296</span> <span class=c1># 4GB</span>
</span></span></code></pre></div><p>对于小于64G内存的操作系统，建议配置如下值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vm.dirty_background_ratio <span class=o>=</span> <span class=m>3</span>
</span></span><span class=line><span class=cl>vm.dirty_ratio <span class=o>=</span> <span class=m>10</span>
</span></span></code></pre></div><h4 id=设置文件句柄数>设置文件句柄数</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt;/etc/security/limits.d/file.conf<span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>*       soft    nproc   131072
</span></span></span><span class=line><span class=cl><span class=s>*       hard    nproc   131072
</span></span></span><span class=line><span class=cl><span class=s>*       soft    nofile  131072
</span></span></span><span class=line><span class=cl><span class=s>*       hard    nofile  131072
</span></span></span><span class=line><span class=cl><span class=s>root    soft    nproc   131072
</span></span></span><span class=line><span class=cl><span class=s>root    hard    nproc   131072
</span></span></span><span class=line><span class=cl><span class=s>root    soft    nofile  131072
</span></span></span><span class=line><span class=cl><span class=s>root    hard    nofile  131072
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><h4 id=设置ssh连接>设置SSH连接</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sed -i <span class=s1>&#39;s/#MaxStartups 10:30:100/MaxStartups 10:30:200/g&#39;</span> /etc/ssh/sshd_config
</span></span><span class=line><span class=cl>service sshd restart
</span></span></code></pre></div><h3 id=配置-greenplum-要求的参数>配置 Greenplum 要求的参数</h3><h4 id=磁盘io设置>磁盘IO设置</h4><p>设置磁盘预读</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>fdisk -l
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/sbin/blockdev --setra <span class=m>16384</span> /dev/sdb
</span></span></code></pre></div><p>调整IO调度算法</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> deadline &gt; /sys/block/sdb/queue/scheduler
</span></span><span class=line><span class=cl>grubby --update-kernel<span class=o>=</span>ALL --args<span class=o>=</span><span class=s2>&#34;elevator=deadline&#34;</span>
</span></span></code></pre></div><h4 id=设置transparent-huge-pages>设置Transparent Huge Pages</h4><p>禁止透明大页，Redhat 6以及更高版本默认激活THP，THP会降低GP database性能，通过修改文件/boot/grub/grub.conf添加参数transparent_hugepage=never禁止THP的应用，但需要重新启动系统</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;echo never &gt; /sys/kernel/mm/*transparent_hugepage/defrag&#34;</span> &gt;/etc/rc.local
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;echo never &gt; /sys/kernel/mm/*transparent_hugepage/enabled&#34;</span> &gt;/etc/rc.local
</span></span><span class=line><span class=cl>grubby --update-kernel<span class=o>=</span>ALL --args<span class=o>=</span><span class=s2>&#34;transparent_hugepage=never&#34;</span>
</span></span></code></pre></div><blockquote><p>需要重启系统</p></blockquote><p>查看是否禁用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /sys/kernel/mm/*transparent_hugepage/enabled
</span></span><span class=line><span class=cl>always madvise <span class=o>[</span>never<span class=o>]</span>
</span></span></code></pre></div><p>检查内核参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ grubby --info<span class=o>=</span>ALL
</span></span><span class=line><span class=cl><span class=nv>index</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl><span class=nv>kernel</span><span class=o>=</span>/boot/vmlinuz-4.4.202-1.el7.elrepo.x86_64
</span></span><span class=line><span class=cl><span class=nv>args</span><span class=o>=</span><span class=s2>&#34;ro elevator=deadline no_timer_check crashkernel=auto rd.lvm.lv=centos_centos7/root rd.lvm.lv=centos_centos7/swap biosdevname=0 net.ifnames=0 rhgb quiet numa=off transparent_hugepage=never&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>root</span><span class=o>=</span>/dev/mapper/centos_centos7-root
</span></span><span class=line><span class=cl><span class=nv>initrd</span><span class=o>=</span>/boot/initramfs-4.4.202-1.el7.elrepo.x86_64.img
</span></span><span class=line><span class=cl><span class=nv>title</span><span class=o>=</span>CentOS Linux <span class=o>(</span>4.4.202-1.el7.elrepo.x86_64<span class=o>)</span> <span class=m>7</span> <span class=o>(</span>Core<span class=o>)</span>
</span></span></code></pre></div><h4 id=关闭removeipc>关闭RemoveIPC</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sed -i <span class=s1>&#39;s/#RemoveIPC=no/RemoveIPC=no/g&#39;</span> /etc/systemd/logind.conf
</span></span><span class=line><span class=cl>service systemd-logind restart
</span></span></code></pre></div><h4 id=挂载磁盘>挂载磁盘</h4><p>先查看磁盘挂载：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>fdisk -l
</span></span></code></pre></div><p>如果没有磁盘，则需要挂载磁盘。官方建议使用XFS磁盘类型，当然其他磁盘类型也是可以。</p><p>配置/etc/fstab文件以使Linux系统启动默认挂载磁盘，如下配置添加到文件/etc/fstab：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkfs.xfs -f /dev/sdb
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mkdir /data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;/dev/sdb /data xfs  nodev,noatime,nobarrier,inode64 0 0&#34;</span> &gt;&gt; /etc/fstab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mount -a
</span></span></code></pre></div><h3 id=创建greenplum管理员用户>创建Greenplum管理员用户</h3><p>使用root用户创建用户 gpadmin，这里密码也设置为 gpadmin</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>USER</span><span class=o>=</span>gpadmin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>groupadd <span class=nv>$USER</span>
</span></span><span class=line><span class=cl>useradd <span class=nv>$USER</span> -r -m -g <span class=nv>$USER</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$USER</span><span class=p>|</span>passwd <span class=nv>$USER</span> --stdin &gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span></code></pre></div><p>添加sudo权限：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$USER</span><span class=s2> ALL = (root) NOPASSWD:ALL&#34;</span> <span class=p>|</span> sudo tee /etc/sudoers.d/<span class=nv>$USER</span>
</span></span></code></pre></div><p>切换到 gpadmin 用户，生成ssh密钥：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su gpadmin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span> ! -f ~/.ssh/id_rsa.pub <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=o>(</span>yes<span class=p>|</span>ssh-keygen -f ~/.ssh/id_rsa -t rsa -N <span class=s2>&#34;&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>(</span> chmod <span class=m>600</span> ~/.ssh/id_rsa.pub <span class=o>)</span> <span class=o>&amp;&amp;</span> cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
</span></span></code></pre></div><h2 id=安装数据库>安装数据库</h2><h3 id=安装>安装</h3><p>1、下载页面：https://network.pivotal.io/products/pivotal-gpdb/ ，当前最新版本为6.21.2，对应的rpm文件 greenplum-db-6.21.2-rhel7-x86_64.rpm。</p><p>拷贝到每个节点：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>scp greenplum-db-6.21.2-rhel7-x86_64.rpm gpadmin@dw-test-node001:~
</span></span><span class=line><span class=cl>scp greenplum-db-6.21.2-rhel7-x86_64.rpm gpadmin@dw-test-node002:~
</span></span><span class=line><span class=cl>scp greenplum-db-6.21.2-rhel7-x86_64.rpm gpadmin@dw-test-node003:~
</span></span></code></pre></div><p>2、每个节点安装RPM</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh dw-test-node001 <span class=s2>&#34;sudo yum install greenplum-db-6.21.2-rhel7-x86_64.rpm -y&#34;</span>
</span></span><span class=line><span class=cl>ssh dw-test-node002 <span class=s2>&#34;sudo yum install greenplum-db-6.21.2-rhel7-x86_64.rpm -y&#34;</span>
</span></span><span class=line><span class=cl>ssh dw-test-node003 <span class=s2>&#34;sudo yum install greenplum-db-6.21.2-rhel7-x86_64.rpm -y&#34;</span>
</span></span></code></pre></div><p>3、修改安装目录权限</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh dw-test-node001 <span class=s2>&#34;sudo chown -R gpadmin:gpadmin /usr/local/greenplum*&#34;</span>
</span></span><span class=line><span class=cl>ssh dw-test-node002 <span class=s2>&#34;sudo chown -R gpadmin:gpadmin /usr/local/greenplum*&#34;</span>
</span></span><span class=line><span class=cl>ssh dw-test-node003 <span class=s2>&#34;sudo chown -R gpadmin:gpadmin /usr/local/greenplum*&#34;</span>
</span></span></code></pre></div><h3 id=确保无密码登陆>确保无密码登陆</h3><p>1、dw-test-node001节点上配置gpadmin用户无密码登陆到其他节点：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su gpadmin
</span></span><span class=line><span class=cl>ssh-copy-id dw-test-node001
</span></span><span class=line><span class=cl>ssh-copy-id dw-test-node002
</span></span><span class=line><span class=cl>ssh-copy-id dw-test-node003
</span></span></code></pre></div><p>2、设置greenplum环境变量使其生效</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>source</span> /usr/local/greenplum-db/greenplum_path.sh
</span></span></code></pre></div><p>3、配置hostfile_all文件，将所有的服务器名记录在里面。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; hostfile_all <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>dw-test-node001
</span></span></span><span class=line><span class=cl><span class=s>dw-test-node002
</span></span></span><span class=line><span class=cl><span class=s>dw-test-node003
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><p>hostfile_segment只保存segment节点的hostname</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; hostfile_segment <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>dw-test-node002
</span></span></span><span class=line><span class=cl><span class=s>dw-test-node003
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><p>4、使用gpssh-exkeys打通所有服务器，配置所有GP节点之间ssh互信：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ gpssh-exkeys -f hostfile_all 
</span></span><span class=line><span class=cl><span class=o>[</span>STEP <span class=m>1</span> of 5<span class=o>]</span> create <span class=nb>local</span> ID and authorize on <span class=nb>local</span> host
</span></span><span class=line><span class=cl>  ... /home/gpadmin/.ssh/id_rsa file exists ... key generation skipped
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>STEP <span class=m>2</span> of 5<span class=o>]</span> keyscan all hosts and update known_hosts file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>STEP <span class=m>3</span> of 5<span class=o>]</span> retrieving credentials from remote hosts
</span></span><span class=line><span class=cl>  ... send to dw-test-node001
</span></span><span class=line><span class=cl>  ... send to dw-test-node002
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>STEP <span class=m>4</span> of 5<span class=o>]</span> determine common authentication file content
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>STEP <span class=m>5</span> of 5<span class=o>]</span> copy authentication files to all remote hosts
</span></span><span class=line><span class=cl>  ... finished key exchange with dw-test-node001
</span></span><span class=line><span class=cl>  ... finished key exchange with dw-test-node002
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> completed successfully
</span></span></code></pre></div><p>在打通所有机器通道之后，我们就可以使用gpssh命令对所有机器进行批量操作了。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpssh -f hostfile_all <span class=s2>&#34;ls -l /usr/local/greenplum-db&#34;</span>
</span></span></code></pre></div><h3 id=创建存储>创建存储</h3><p>master上创建目录：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpssh -h dw-test-node001 -e <span class=s1>&#39;sudo mkdir -p /gpdata/master &amp;&amp; sudo chown gpadmin:gpadmin /gpdata/master&#39;</span> 
</span></span></code></pre></div><p>数据节点创建目录：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpssh -f hostfile_segment -e <span class=s1>&#39;sudo mkdir -p /gpdata/primary{0,1} /gpdata/mirror{0,1} &amp;&amp; sudo chown -R gpadmin:gpadmin /gpdata/*&#39;</span>
</span></span></code></pre></div><h3 id=初始化数据库>初始化数据库</h3><h4 id=创建模板>创建模板</h4><p>配置文件的模板可以在 $GPHOME/docs/cli_help/gpconfigs/ 目录下找到。gpinitsystem_config文件是初始化Greenplum的模板，在这个模板中，Mirror Segment的配置都被注释掉了，模板中基本初始化数据库的参数都是有的。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; gpinitsystem_config <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>#数据库的代号
</span></span></span><span class=line><span class=cl><span class=s>ARRAY_NAME=&#34;Greenplum Data Platform&#34;
</span></span></span><span class=line><span class=cl><span class=s>#Segment的名称前缀
</span></span></span><span class=line><span class=cl><span class=s>SEG_PREFIX=gpseg
</span></span></span><span class=line><span class=cl><span class=s>#Primary Segment起始的端口号
</span></span></span><span class=line><span class=cl><span class=s>PORT_BASE=40000
</span></span></span><span class=line><span class=cl><span class=s>#指定Primary Segment的数据目录，配置几次资源目录就是每个子节点有几个实例（推荐4-8个，这里配置了4个，primary与mirror文件夹个数对应）
</span></span></span><span class=line><span class=cl><span class=s>declare -a DATA_DIRECTORY=(/gpdata/primary0 /gpdata/primary1)
</span></span></span><span class=line><span class=cl><span class=s>#Master所在机器的Hostname
</span></span></span><span class=line><span class=cl><span class=s>MASTER_HOSTNAME=dw-test-node001
</span></span></span><span class=line><span class=cl><span class=s>#指定Master的数据目录
</span></span></span><span class=line><span class=cl><span class=s>MASTER_DIRECTORY=/gpdata/master
</span></span></span><span class=line><span class=cl><span class=s>#Master的端口
</span></span></span><span class=line><span class=cl><span class=s>MASTER_PORT=5432
</span></span></span><span class=line><span class=cl><span class=s>#指定Bash的版本
</span></span></span><span class=line><span class=cl><span class=s>TRUSTED_SHELL=ssh
</span></span></span><span class=line><span class=cl><span class=s>#设置的是检查点段的大小，较大的检查点段可以改善大数据量装载的性能，同时会加长灾难事务恢复的时间。
</span></span></span><span class=line><span class=cl><span class=s>CHECK_POINT_SEGMENTS=8
</span></span></span><span class=line><span class=cl><span class=s>#字符集
</span></span></span><span class=line><span class=cl><span class=s>ENCODING=utf-8
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>#Mirror Segment起始的端口号
</span></span></span><span class=line><span class=cl><span class=s>MIRROR_PORT_BASE=41000
</span></span></span><span class=line><span class=cl><span class=s>#Primary Segment主备同步的起始端口号
</span></span></span><span class=line><span class=cl><span class=s>REPLICATION_PORT_BASE=42000
</span></span></span><span class=line><span class=cl><span class=s>#Mirror Segment主备同步的起始端口号
</span></span></span><span class=line><span class=cl><span class=s>MIRROR_REPLICATION_PORT_BASE=43000
</span></span></span><span class=line><span class=cl><span class=s>#Mirror Segment的数据目录,配置几次资源目录就是每个子节点有几个实例（推荐4-8个，这里配置了4个，primary与mirror文件夹个数对应）
</span></span></span><span class=line><span class=cl><span class=s>declare -a MIRROR_DATA_DIRECTORY=(/gpdata/mirror0 /gpdata/mirror1)
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>MASTER_MAX_CONNECT=250
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><blockquote><p>如果是挂载了多个磁盘，则数据路径需要使用独立的路径。</p></blockquote><h4 id=初始化数据库-1>初始化数据库</h4><p>使用gpinitsystem脚本来初始化数据库，命令如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpinitsystem -c gpinitsystem_config -h hostfile_segment
</span></span></code></pre></div><p>也可以指定standby master ：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-BASH data-lang=BASH><span class=line><span class=cl>gpinitsystem -c gpinitsystem_config -h hostfile_segment -s dw-test-node002
</span></span></code></pre></div><blockquote><p>如果不想手动确认，可以添加 <code>-a</code> 参数。</p></blockquote><p>后期添加standby master：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#在不同机器增加standby master节点</span>
</span></span><span class=line><span class=cl>gpinitstandby -S /gdata/master/gpseg1 -s dw-test-node001
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#在同一机器增加standby master节点</span>
</span></span><span class=line><span class=cl>gpinitstandby -S /gdata/master/gpseg1 -P <span class=m>5433</span> -s dw-test-node001
</span></span></code></pre></div><h4 id=设置环境变量>设置环境变量</h4><p>切换到gpadmin用户：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su - gpadmin 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat &gt;&gt;  ~/.bashrc <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>source /usr/local/greenplum-db/greenplum_path.sh
</span></span></span><span class=line><span class=cl><span class=s>export GPHOME=/usr/local/greenplum-db
</span></span></span><span class=line><span class=cl><span class=s>export MASTER_DATA_DIRECTORY=/gpdata/master/gpseg1
</span></span></span><span class=line><span class=cl><span class=s>export PGPORT=5432
</span></span></span><span class=line><span class=cl><span class=s>export PGUSER=gpadmin
</span></span></span><span class=line><span class=cl><span class=s>export PGDATABASE=postgres
</span></span></span><span class=line><span class=cl><span class=s>export LD_PRELOAD=/lib64/libz.so.1
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>source</span> ~/.bashrc
</span></span></code></pre></div><p>如果配置了 standby master节点，则拷贝到standby master节点：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>scp ~/.bashrc dw-test-node002:~
</span></span><span class=line><span class=cl>ssh dw-test-node002 <span class=s2>&#34;source ~/.bashrc&#34;</span>
</span></span></code></pre></div><h4 id=设置数据库时区>设置数据库时区</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpconfig -s TimeZone
</span></span><span class=line><span class=cl>gpconfig -c TimeZone -v <span class=s1>&#39;Asia/Shanghai&#39;</span>
</span></span></code></pre></div><h3 id=修改配置>修改配置</h3><h4 id=设置远程用户访问>设置远程用户访问</h4><p>查看/gpdata/master/gpseg1/pg_hba.conf：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>local</span>    all         gpadmin         ident
</span></span><span class=line><span class=cl>host     all         gpadmin         127.0.0.1/28    trust
</span></span><span class=line><span class=cl>host     all         gpadmin         192.168.56.141/32       trust
</span></span><span class=line><span class=cl><span class=nb>local</span>    replication gpadmin         ident
</span></span><span class=line><span class=cl>host     replication gpadmin         samehost       trust
</span></span><span class=line><span class=cl>host     replication gpadmin         192.168.56.141/32       trust
</span></span></code></pre></div><p>修改为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>local</span>    all         gpadmin         ident
</span></span><span class=line><span class=cl>host     all         gpadmin         127.0.0.1/28    trust
</span></span><span class=line><span class=cl>host     all         gpadmin         192.168.56.141/32       trust
</span></span><span class=line><span class=cl><span class=nb>local</span>    replication gpadmin         ident
</span></span><span class=line><span class=cl>host     replication gpadmin         samehost       trust
</span></span><span class=line><span class=cl>host     replication gpadmin         192.168.56.141/32       trust
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>host     all         all		         192.168.56.141/32       trust  <span class=c1>#add this</span>
</span></span></code></pre></div><blockquote><p>添加一行，设置192.168.56.141/32可以访问所有数据库</p></blockquote><h4 id=设置监听ip和port>设置监听IP和Port</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /gpdata/master/gpseg1/postgresql.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 设置监听IP (* 生产环境慎用)</span>
</span></span><span class=line><span class=cl><span class=nv>listen_addresses</span> <span class=o>=</span> <span class=s1>&#39;${ host ip address } &#39;</span>
</span></span><span class=line><span class=cl><span class=nv>port</span> <span class=o>=</span> <span class=m>5432</span>
</span></span></code></pre></div><h3 id=启动与关闭>启动与关闭</h3><p>启动数据库：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpstart -a
</span></span></code></pre></div><p>关闭数据库：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpstop -a
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gpstop -M fast
</span></span></code></pre></div><p>重启数据库：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpstop -ar
</span></span></code></pre></div><p>重新加载配置文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> gpstop -u
</span></span></code></pre></div><p>设置开机启动：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; greenplum.service <span class=s>&lt;&lt;EOF 
</span></span></span><span class=line><span class=cl><span class=s>[Unit]
</span></span></span><span class=line><span class=cl><span class=s>Description=greenplum server daemon
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[Service]
</span></span></span><span class=line><span class=cl><span class=s>Restart=on-failure
</span></span></span><span class=line><span class=cl><span class=s>ExecStart=/usr/local/greenplum-db/bin/gpstart -a
</span></span></span><span class=line><span class=cl><span class=s> 
</span></span></span><span class=line><span class=cl><span class=s>[Install]
</span></span></span><span class=line><span class=cl><span class=s>WantedBy=multi-user.target
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo mv greenplum.service /usr/lib/systemd/system/
</span></span></code></pre></div><h3 id=测试>测试</h3><h4 id=客户端访问>客户端访问</h4><p>在本地访问：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>psql -p <span class=m>5432</span> -U gpadmin -d postgres
</span></span></code></pre></div><p>在其他机器访问：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>psql -p <span class=m>5432</span> -h 192.168.56.141 -U gpadmin -d postgres
</span></span></code></pre></div><h3 id=清空数据>清空数据</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#如有报错需重新初始化，清理以下内容：</span>
</span></span><span class=line><span class=cl><span class=nb>kill</span> -9 <span class=k>$(</span>ps -ef <span class=p>|</span>grep greenplum<span class=p>|</span>awk <span class=s1>&#39;{print $2}&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>gpssh -f hostfile_all -e <span class=s2>&#34;rm -rf /gpdata/master/*&#34;</span>
</span></span><span class=line><span class=cl>gpssh -f hostfile_segment -e <span class=s2>&#34;rm -rf /gpdata/{mirror*,primary*}/*&#34;</span>
</span></span><span class=line><span class=cl>rm  -f /tmp/.s.PGSQL*.lock
</span></span></code></pre></div><h3 id=升级>升级</h3><p>1、登陆：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su - gpadmin
</span></span></code></pre></div><p>2、停止数据库</p><p>master节点执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpstop -a
</span></span></code></pre></div><p>3、安装新版本</p><p>从https://github.com/greenplum-db/gpdb/releases 下载最新版本，并拷贝到每个阶段。在每个节点运行下面命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum install greenplum-db-6.21.2-rhel7-x86_64.rpm -y
</span></span></code></pre></div><p>4、设置目录权限</p><p>每个节点执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chown -R gpadmin:gpadmin /usr/local/greenplum*
</span></span></code></pre></div><p>5、设置环境变量</p><p>重新设置软连接：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rm /usr/local/greenplum-db
</span></span><span class=line><span class=cl>ln -s /usr/local/greenplum-db-6.21.2 /usr/local/greenplum-db
</span></span><span class=line><span class=cl><span class=nb>source</span> ~/.bashrc
</span></span></code></pre></div><p>6、启动数据库</p><p>master节点执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpstart -a
</span></span></code></pre></div><h3 id=常用命令>常用命令</h3><h4 id=查看数据库状态>查看数据库状态</h4><p>1、查看segment</p><p>列出当前状态为down的Segment：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_segment_configuration</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>&lt;&gt;</span><span class=w> </span><span class=s1>&#39;u&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>检查当前处于改变跟踪模式的Segment。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_segment_configuration</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>mode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;c&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>检查当前在重新同步的Segment。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_segment_configuration</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>mode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;r&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>检查没有以其最优角色运转的Segment。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_segment_configuration</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>preferred_role</span><span class=w> </span><span class=o>&lt;&gt;</span><span class=w> </span><span class=k>role</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>运行一个分布式查询来测试它运行在所有Segment上。对每个主Segment都应返回一行。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>gp_segment_id</span><span class=p>,</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_dist_random</span><span class=p>(</span><span class=s1>&#39;pg_class&#39;</span><span class=p>)</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>2、查看数据库连接</p><p>查看到当前数据库连接的IP 地址，用户名，提交的查询等。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>pg_stat_activity</span><span class=w> 
</span></span></span></code></pre></div><p>3、查看表存储结构</p><p>查看表的存储结构:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>distinct</span><span class=w> </span><span class=n>relstorage</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>pg_class</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>查询当前数据库有哪些AO表：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=n>nspname</span><span class=p>,</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>relname</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>pg_class</span><span class=w> </span><span class=n>t1</span><span class=p>,</span><span class=w> </span><span class=n>pg_namespace</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>relnamespace</span><span class=o>=</span><span class=n>t2</span><span class=p>.</span><span class=n>oid</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>relstorage</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;c&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>查询当前数据库有哪些堆表：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=n>nspname</span><span class=p>,</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>relname</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>pg_class</span><span class=w> </span><span class=n>t1</span><span class=p>,</span><span class=w> </span><span class=n>pg_namespace</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>relnamespace</span><span class=o>=</span><span class=n>t2</span><span class=p>.</span><span class=n>oid</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>relstorage</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;h&#39;</span><span class=p>)</span><span class=w>  </span><span class=k>and</span><span class=w> </span><span class=n>relkind</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>;</span><span class=w> 
</span></span></span></code></pre></div><h4 id=维护数据库>维护数据库</h4><p>检查表上缺失的统计信息。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_toolkit</span><span class=p>.</span><span class=n>gp_stats_missing</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>检查数据文件中出现膨胀（死亡空间）且无法用常规VACUUM命令恢复的表。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_toolkit</span><span class=p>.</span><span class=n>gp_bloat_diag</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>清理用户表</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>VACUUM</span><span class=w> </span><span class=o>&lt;</span><span class=k>table</span><span class=o>&gt;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>分析用户表。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>analyzedb</span><span class=w> </span><span class=o>-</span><span class=n>d</span><span class=w> </span><span class=o>&lt;</span><span class=k>database</span><span class=o>&gt;</span><span class=w> </span><span class=o>-</span><span class=n>a</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>analyzedb</span><span class=w> </span><span class=o>-</span><span class=n>s</span><span class=w> </span><span class=n>pg_catalog</span><span class=w> </span><span class=o>-</span><span class=n>d</span><span class=w> </span><span class=o>&lt;</span><span class=k>database</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><p>推荐周期性地在系统目录上运行VACUUM和REINDEX来清理系统表和索引中已删除对象所占用的空间：</p><p>下面的示例脚本在一个Greenplum数据库系统目录上执行一次VACUUM、REINDEX以及ANALYZE：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nv>DBNAME</span><span class=o>=</span><span class=s2>&#34;&lt;database-name&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>SYSTABLES</span><span class=o>=</span><span class=s2>&#34;&#39; pg_catalog.&#39; || relname || &#39;;&#39; from pg_class a, pg_namespace b 
</span></span></span><span class=line><span class=cl><span class=s2>where a.relnamespace=b.oid and b.nspname=&#39;pg_catalog&#39; and a.relkind=&#39;r&#39;&#34;</span>
</span></span><span class=line><span class=cl>psql -tc <span class=s2>&#34;SELECT &#39;VACUUM&#39; || </span><span class=nv>$SYSTABLES</span><span class=s2>&#34;</span> <span class=nv>$DBNAME</span> <span class=p>|</span> psql -a <span class=nv>$DBNAME</span>
</span></span><span class=line><span class=cl>reindexdb --system -d <span class=nv>$DBNAME</span>
</span></span><span class=line><span class=cl>analyzedb -s pg_catalog -d <span class=nv>$DBNAME</span>
</span></span></code></pre></div><h4 id=查看磁盘空间>查看磁盘空间</h4><p>1、检查磁盘空间使用</p><p>以使用gp_toolkit管理方案中的gp_disk_free外部表来检查Segment主机文件系统中的剩余空闲空间（以千字节计）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>dw_lps</span><span class=o>=#</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_toolkit</span><span class=p>.</span><span class=n>gp_disk_free</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>dfsegment</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>dfsegment</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=n>dfhostname</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>dfdevice</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=n>dfspace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-----------+------------------+-----------+-----------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>         </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>  </span><span class=n>dw</span><span class=o>-</span><span class=n>test</span><span class=o>-</span><span class=n>node001</span><span class=w> </span><span class=o>|</span><span class=w>  </span><span class=o>/</span><span class=n>dev</span><span class=o>/</span><span class=n>sdb</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>472594712</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>  </span><span class=n>dw</span><span class=o>-</span><span class=n>test</span><span class=o>-</span><span class=n>node001</span><span class=w> </span><span class=o>|</span><span class=w>  </span><span class=o>/</span><span class=n>dev</span><span class=o>/</span><span class=n>sdb</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>472594712</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>2</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><p>2、查看数据库的磁盘空间使用</p><p>要查看一个数据库的总尺寸（以字节计），使用<em>gp_toolkit</em>管理方案中的<em>gp_size_of_database</em>视图。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>dw_lps</span><span class=o>=#</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_toolkit</span><span class=p>.</span><span class=n>gp_size_of_database</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>sodddatname</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>sodddatname</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>sodddatsize</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------------+-------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>dw_lps</span><span class=w>      </span><span class=o>|</span><span class=w>  </span><span class=mi>3833874988</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>gpperfmon</span><span class=w>   </span><span class=o>|</span><span class=w>    </span><span class=mi>63310532</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>2</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><p>查看某个数据库占用空间：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>dw_lps</span><span class=o>=#</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=n>pg_size_pretty</span><span class=p>(</span><span class=n>pg_database_size</span><span class=p>(</span><span class=s1>&#39;dw_lps&#39;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>pg_size_pretty</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>----------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>3656</span><span class=w> </span><span class=n>MB</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><p>3、查看一个表的磁盘空间使用</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>relname</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>sotdsize</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>size</span><span class=p>,</span><span class=w> </span><span class=n>sotdtoastsize</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>AS</span><span class=w> </span><span class=k>toast</span><span class=p>,</span><span class=w> </span><span class=n>sotdadditionalsize</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>other</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>FROM</span><span class=w> </span><span class=n>gp_toolkit</span><span class=p>.</span><span class=n>gp_size_of_table_disk</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>sotd</span><span class=p>,</span><span class=w> </span><span class=n>pg_class</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>WHERE</span><span class=w> </span><span class=n>sotd</span><span class=p>.</span><span class=n>sotdoid</span><span class=o>=</span><span class=n>pg_class</span><span class=p>.</span><span class=n>oid</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>relname</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>4、查看索引的磁盘空间使用</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>soisize</span><span class=p>,</span><span class=w> </span><span class=n>relname</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>indexname</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>FROM</span><span class=w> </span><span class=n>pg_class</span><span class=p>,</span><span class=w> </span><span class=n>gp_toolkit</span><span class=p>.</span><span class=n>gp_size_of_index</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>WHERE</span><span class=w> </span><span class=n>pg_class</span><span class=p>.</span><span class=n>oid</span><span class=o>=</span><span class=n>gp_size_of_index</span><span class=p>.</span><span class=n>soioid</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>AND</span><span class=w> </span><span class=n>pg_class</span><span class=p>.</span><span class=n>relkind</span><span class=o>=</span><span class=s1>&#39;i&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=查看数据分布>查看数据分布</h4><p>1、查看某个表的数据分布：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>dw_lps</span><span class=o>=#</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=n>gp_segment_id</span><span class=p>,</span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ods_lps_bill</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>gp_segment_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>gp_segment_id</span><span class=w> </span><span class=o>|</span><span class=w>  </span><span class=k>count</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>---------------+---------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>             </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>1440129</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>1439143</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>2</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><p>2、查询压缩率：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>get_ao_compression_ratio</span><span class=p>(</span><span class=s1>&#39;ods_lps_bill&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>3、查看AO表的膨胀率</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>gp_toolkit</span><span class=p>.</span><span class=n>__gp_aovisimap_compaction_info</span><span class=p>(</span><span class=s1>&#39;ods_lps_bill&#39;</span><span class=p>::</span><span class=n>regclass</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>膨胀率超过千分之2的AO表：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>select</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=n>nspname</span><span class=p>,</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>relname</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>gp_toolkit</span><span class=p>.</span><span class=n>__gp_aovisimap_compaction_info</span><span class=p>(</span><span class=n>t1</span><span class=p>.</span><span class=n>oid</span><span class=p>)).</span><span class=o>*</span><span class=w>   
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>from</span><span class=w> </span><span class=n>pg_class</span><span class=w> </span><span class=n>t1</span><span class=p>,</span><span class=w> </span><span class=n>pg_namespace</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>relnamespace</span><span class=o>=</span><span class=n>t2</span><span class=p>.</span><span class=n>oid</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>relstorage</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;c&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;a&#39;</span><span class=p>)</span><span class=w>   
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>t</span><span class=w>   
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>percent_hidden</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>2</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=查看元数据>查看元数据</h4><p>1、查看表元数据</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>\</span><span class=n>d</span><span class=o>+</span><span class=w> </span><span class=n>ods_lps_bill</span><span class=w>
</span></span></span></code></pre></div><p>2、查看某一个表上执行的操作</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>schemaname</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>schema</span><span class=p>,</span><span class=w> </span><span class=n>objname</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>table</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>usename</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>role</span><span class=p>,</span><span class=w> </span><span class=n>actionname</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>action</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=n>subtype</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>type</span><span class=p>,</span><span class=w> </span><span class=n>statime</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>time</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>FROM</span><span class=w> </span><span class=n>pg_stat_operations</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>WHERE</span><span class=w> </span><span class=n>objname</span><span class=o>=</span><span class=s1>&#39;ods_lps_bill&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h3 id=参考文章>参考文章</h3><ul><li><a href=https://blog.csdn.net/q936889811/article/details/85603814>greenplum集群的rpm（生产环境）部署及参数优化</a></li><li><a href=https://gpdb.docs.pivotal.io/6-1/install_guide/install_gpdb.html>Installing the Greenplum Database Software</a></li></ul></article><div class=author-card><div class=underline></div><div class=author-box><div class=author-image><a href=https://blog.chensoul.com><img src=/images/author.webp alt=ChenShu></a></div><div class=author-content><p class=author-title>作者</p><p class=author-name>ChenShu</p><p class=author-desc>Java 开发工程师。喜欢探索新技术。 在 <a href=https://github.com/chensoul>GitHub</a> 关注我。在我的 <a href=https://t.me/chenshu_eth>Telegram 频道</a>了解更多。</p></div></div></div></div></main><div class="footer gradient-2"><div class="container footer-container"><div class=row><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>网站地图</div><ul class=list-unstyled><li><a href=https://blog.chensoul.com/tags/>标签</a></li><li><a href=https://blog.chensoul.com/categories/>分类</a></li><li><a rel=alternate type=application/rss+xml href=https://blog.chensoul.com/index.xml></i>订阅</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>社群</div><ul class=list-unstyled><li><a href=https://t.me/chenshu_eth rel=noopener target=_blank>Telegram</a></li><li><a href=https://twitter.com/chenshu_eth rel=noopener target=_blank>Twitter</a></li><li><a href=https://space.bilibili.com/699805065/ rel=noopener target=_blank>BiliBili</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>友链</div><ul class=list-unstyled><li><a href=https://github.com/chensoul rel=noopener target=_blank>Chensoul GitHub</a></li><li><a href=https://uptime.chensoul.com/status/services rel=noopener target=_blank>Chensoul Services</a></li><li><a href=https://data.pseudoyu.com/share/8YKX7FUa/pseudoyu-blog rel=noopener target=_blank>Chensoul Analytics</a></li></ul></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><p class="pull-right text-right"><small><em>Proudly powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo</a></em></small><br><small><em>Theme - <a href=https://github.com/chensoul/hugo-theme-den rel=noopener target=_blank>Den</a></em></small><br><small>&copy;
chenshu
2020 -
2023</small></p></div></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script></body></html>