<!doctype html><html class=no-js lang=zh-cn><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>[译]没有WebSecurityConfigurerAdapter的Spring Security.md - Java、Spring、Spring Boot、MicroServices、Architecture、Kubernetes、DevOps</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="[译]没有WebSecurityConfigurerAdapter的Spring Security.md"><meta property="og:description" content="Java、Spring、Spring Boot、MicroServices、Architecture、Kubernetes、DevOps"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chensoul.cc/posts/2023/08/18/spring-security-without-websecurityconfigureradapter/"><meta property="og:site_name" content="ChenSoul Blog"><meta property="og:image" content><meta itemprop=name content="[译]没有WebSecurityConfigurerAdapter的Spring Security.md"><meta itemprop=description content="在 Spring Security 模块的上下文中，WebSecurityConfigurerAdapter 是一个抽象类，根据 Spring 官方网站 2022 年 2 月 21 日发布的公告，该类已从 Spring Security 5.7.0-M2 中弃用。它通常用于扩展 configure() 方法由自定义配置子类实现。因此，它鼓励用户转向基于组件的安全配置。为了支持对这种新配置设计的更改，我们将讨论常见用例列表和未来建议的替代方案。因此，我们将讨论没有 WebSecurityConfigurerAdapter 的 Spring Security 用例的实现。"><meta itemprop=datePublished content="2023-08-18T00:00:00+00:00"><meta itemprop=dateModified content="2023-08-18T00:00:00+00:00"><meta itemprop=wordCount content="865"><meta itemprop=keywords content="Spring-Boot,Security"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="[译]没有WebSecurityConfigurerAdapter的Spring Security.md"><meta name=twitter:description content="Java、Spring、Spring Boot、MicroServices、Architecture、Kubernetes、DevOps"><meta name=twitter:image content><link rel=preconnect href=//fonts.loli.net crossorigin><link rel=dns-prefetch href=//fonts.loli.net><link rel=stylesheet href="https://fonts.loli.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class="logo logo--mixed"><a class=logo__link href=/ title="ChenSoul Blog" rel=home><div class="logo__item logo__imagebox"><img class=logo__img src=/logo.svg loading=lazy alt="Site logo" width=60 height=60></div><div class="logo__item logo__text"><div class=logo__title>ChenSoul Blog</div><div class=logo__tagline>Java、Spring、Spring Boot、MicroServices、Architecture、Kubernetes、DevOps</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>菜单</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>首页</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>分类</span></a></li><li class=menu__item><a class=menu__link href=/tags/><span class=menu__text>标签</span></a></li><li class=menu__item><a class=menu__link href=/index.xml><span class=menu__text>订阅</span></a></li><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>关于</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>[译]没有WebSecurityConfigurerAdapter的Spring Security.md</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 110 28 1 1 0 010-28m0 3a3 3 0 100 22 3 3 0 000-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class=meta__text datetime=2023-08-18>2023-08-18</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/spring-boot/ rel=category>Spring-Boot</a></span></div><div class="meta__item-tags meta__item"><svg class="meta__icon icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 000-6 3 3 0 000 6"/></svg><span class=meta__text><a class=meta__link href=/tags/spring-boot/ rel=tag>Spring-Boot</a>, <a class=meta__link href=/tags/security/ rel=tag>Security</a></span></div></div></header><div class="content post__content clearfix"><p><img src=/images/WebSecurityConfigurerAdapter-Deprecated-1.webp alt="WebSecurityConfigurerAdapter Deprecated"></p><p>在 Spring Security 模块的上下文中，WebSecurityConfigurerAdapter 是一个抽象类，根据 <a href=https://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter target=_blank>Spring 官方网站</a> 2022 年 2 月 21 日发布的公告，该类已从 Spring Security 5.7.0-M2 中弃用。它通常用于扩展 configure() 方法由自定义配置子类实现。因此，它鼓励用户转向基于组件的安全配置。为了支持对这种新配置设计的更改，我们将讨论常见用例列表和未来建议的替代方案。因此，我们将讨论没有 WebSecurityConfigurerAdapter 的 Spring Security 用例的实现。</p><p>了解这一变化很重要，因为迟早我们将使用最新版本的 Spring Security 来开发安全功能。让我们讨论“没有 WebSecurityConfigurerAdapter 的 Spring Security”主题及其相关概念。</p><h2 id=什么是-websecurityconfigureradapter>什么是 WebSecurityConfigurerAdapter？</h2><p>WebSecurityConfigurerAdapter 是 Spring Security 模块提供的一个抽象类。一般来说，我们使用它来重写它的 configure()方法来定义我们的安全配置类。通常，我们在应用程序中实现 Spring Security 时使用两个具有不同参数的 configure() 方法。一种用于声明与身份验证相关的配置，另一种用于声明与授权相关的配置。该代码类似于下面的代码片段。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfiguration</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(AuthenticationManagerBuilder auth) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>         <span style=color:#75715e>// configure Authentication ......</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// configure Authorization ......</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=为什么我们需要学习这个改变>为什么我们需要学习这个改变？</h2><p>如果您使用 Spring Boot 2.7.0 和 maven，它将自动下载 Spring Security 5.7.0 或更高版本。在这种情况下，您会发现 WebSecurityConfigurerAdapter 已被弃用。如果您仍然想使用此类而不弃用，您可以在 pom.xml 中将 Spring Boot 版本更改为较低版本（例如 2.6.6 ），如下所示。它将自动下载低于 5.7.0 的 Spring Security 版本，并且弃用警告将消失。</p><p>但是，如果您不使用 Spring Boot，而是使用简单的 Spring Security 模块，您甚至可以降低 Spring Security 的版本。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;parent&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;groupId&gt;</span>org.springframework.boot<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;artifactId&gt;</span>spring-boot-starter-parent<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;version&gt;</span>2.6.6<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/parent&gt;</span>
</span></span></code></pre></div><p>这样，我们就可以在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security。</p><h2 id=我们需要在哪里实施这一改变>我们需要在哪里实施这一改变？</h2><p>以下是一些可能实施此更改的情况。</p><ol><li><p>如果您使用的是 Spring Boot 2.7.0 或更高版本</p></li><li><p>如果您正在使用 Spring Security 5.7.0 或更高版本</p></li><li><p>如果你的项目得到如上所述升级或迁移到更高版本</p></li><li><p>如果您想使用最新版本的 Spring Boot 自定义 Spring Security 配置</p></li><li><p>如果您想删除 WebSecurityConfigurerAdapter Deprecated 的烦人警告</p></li><li><p>如果你想在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security。</p></li></ol><h2 id=如何删除已弃用的警告>如何删除已弃用的警告？</h2><p>下面就让我们一步一步来学习吧：</p><ol><li><p>如果您使用 STS 作为 IDE 来开发项目，则需要降低 Spring Boot 的版本。如果您使用的是 Spring Boot 2.7.0 或更高版本，请将其设为 2.6.x（例如 2.6.6）。您可以通过更新 pom.xml 来做到这一点。完成后，它将自动下载 Spring Security 模块的兼容版本。</p></li><li><p>检查您的配置类是否扩展了 WebSecurityConfigurerAdapter 类。已弃用的警告应该消失。现在您可以在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security。</p></li></ol><h2 id=如何在没有-websecurityconfigureradapter-的情况下使用-spring-security>如何在没有 WebSecurityConfigurerAdapter 的情况下使用 Spring Security？</h2><p>如上所述，通常我们会在自定义配置类中继承 WebSecurityConfigurerAdapter 的 configure() 方法。因此，我们需要找到这些方法的替代方案，因为自 Spring Security 5.7.0-M2 发布以来，WebSecurityConfigurerAdapter 已被弃用。</p><p>让我们讨论一些例子</p><h3 id=示例1使用-websecurityconfigureradapter>示例#1：使用 WebSecurityConfigurerAdapter</h3><p>此示例演示了 HttpSecurity 配置。通常，我们编写它来声明授权工件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WebSecurityConfig</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>     http.<span style=color:#a6e22e>cors</span>().<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>csrf</span>().<span style=color:#a6e22e>disable</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>sessionManagement</span>().<span style=color:#a6e22e>sessionCreationPolicy</span>(SessionCreationPolicy.<span style=color:#a6e22e>STATELESS</span>)
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>authorizeRequests</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/home&#34;</span>).<span style=color:#a6e22e>permitAll</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>).<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/admin&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>)
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/emp&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>)
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/mgr&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>anyRequest</span>().<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>     ;
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例1没有-websecurityconfigureradapter>示例#1：没有 WebSecurityConfigurerAdapter</h3><p>下面的代码演示了在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security 的可能解决方案。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WebSecurityConfig</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>public</span> SecurityFilterChain <span style=color:#a6e22e>filterChain</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>      http.<span style=color:#a6e22e>cors</span>().<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>csrf</span>().<span style=color:#a6e22e>disable</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>sessionManagement</span>().<span style=color:#a6e22e>sessionCreationPolicy</span>(SessionCreationPolicy.<span style=color:#a6e22e>STATELESS</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>authorizeRequests</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/home&#34;</span>).<span style=color:#a6e22e>permitAll</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>).<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/admin&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/emp&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/mgr&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>anyRequest</span>().<span style=color:#a6e22e>authenticated</span>();
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> http.<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在这里，我们需要执行以下步骤：</p><ul><li>步骤#1：删除@override，因为我们不会从任何类中扩展和覆盖它。</li><li>步骤＃2：在此方法上应用@Bean 注解</li><li>步骤#3：现在将方法返回类型声明为 SecurityFilterChain，而不是 void</li><li>步骤#4：根据需要更新方法名称。比如说 filterChain。</li><li>步骤#5：方法结束时，主体返回 http.build()。这里 http 是 HttpSecurity 类型的变量。</li></ul><h3 id=示例2使用-websecurityconfigureradapter>示例#2：使用 WebSecurityConfigurerAdapter</h3><p>在下面的示例中，我们使用了这两种方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.context.annotation.Configuration;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.web.util.matcher.AntPathRequestMatcher;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfig</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(AuthenticationManagerBuilder auth) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// {noop} =&gt; No operation for password encoder (no password encoding needed)</span>
</span></span><span style=display:flex><span>      auth.<span style=color:#a6e22e>inMemoryAuthentication</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>withUser</span>(<span style=color:#e6db74>&#34;devs&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>password</span> (<span style=color:#e6db74>&#34;{noop} devs&#34;</span>) <span style=color:#f92672>/</span>no password encoding needed
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>authorities</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      auth.<span style=color:#a6e22e>inMemoryAuthentication</span>().<span style=color:#a6e22e>withUser</span>(<span style=color:#e6db74>&#34;ns&#34;</span>).<span style=color:#a6e22e>password</span>(<span style=color:#e6db74>&#34;{noop}ns&#34;</span>).<span style=color:#a6e22e>authorities</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>);
</span></span><span style=display:flex><span>      auth.<span style=color:#a6e22e>inMemoryAuthentication</span>().<span style=color:#a6e22e>withUser</span>(<span style=color:#e6db74>&#34;vs&#34;</span>).<span style=color:#a6e22e>password</span>(<span style=color:#e6db74>&#34;{noop}vs&#34;</span>).<span style=color:#a6e22e>authorities</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>);
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//declares which Page(URL) will have What access type</span>
</span></span><span style=display:flex><span>      http.<span style=color:#a6e22e>authorizeRequests</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/home&#34;</span>).<span style=color:#a6e22e>permitAll</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>).<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/admin&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/emp&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/mgr&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/common&#34;</span>).<span style=color:#a6e22e>hasAnyAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>,<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>//  .anyRequest().authenticated()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Login Form Details</span>
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>formLogin</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>defaultSuccessUrl</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>, <span style=color:#66d9ef>true</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Logout Form Details</span>
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>logout</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>logoutRequestMatcher</span>(<span style=color:#66d9ef>new</span> AntPathRequestMatcher(<span style=color:#e6db74>&#34;/logout&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Exception Details</span>
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>exceptionHandling</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>accessDeniedPage</span>(<span style=color:#e6db74>&#34;/accessDenied&#34;</span>)
</span></span><span style=display:flex><span>      ;
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例2没有-websecurityconfigureradapter>示例#2：没有 WebSecurityConfigurerAdapter</h3><p>下面的代码演示了在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security 的可能解决方案。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> java.util.ArrayList;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.List;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.context.annotation.Bean;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.context.annotation.Configuration;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.core.GrantedAuthority;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.core.authority.SimpleGrantedAuthority;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.core.userdetails.User;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.core.userdetails.UserDetails;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.provisioning.InMemoryUserDetailsManager;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.web.SecurityFilterChain;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.web.util.matcher.AntPathRequestMatcher;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfigNew</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> InMemoryUserDetailsManager <span style=color:#a6e22e>configAuthentication</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       List<span style=color:#f92672>&lt;</span>UserDetails<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>       List<span style=color:#f92672>&lt;</span>GrantedAuthority<span style=color:#f92672>&gt;</span> adminAuthority <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>       adminAuthority.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> SimpleGrantedAuthority(<span style=color:#e6db74>&#34;ADMIN&#34;</span>));
</span></span><span style=display:flex><span>       UserDetails admin<span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User(<span style=color:#e6db74>&#34;devs&#34;</span>, <span style=color:#e6db74>&#34;{noop}devs&#34;</span>, adminAuthority);
</span></span><span style=display:flex><span>       users.<span style=color:#a6e22e>add</span>(admin);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       List<span style=color:#f92672>&lt;</span>GrantedAuthority<span style=color:#f92672>&gt;</span> employeeAuthority <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>       adminAuthority.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> SimpleGrantedAuthority(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>));
</span></span><span style=display:flex><span>       UserDetails employee<span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User(<span style=color:#e6db74>&#34;ns&#34;</span>, <span style=color:#e6db74>&#34;{noop}ns&#34;</span>, employeeAuthority);
</span></span><span style=display:flex><span>       users.<span style=color:#a6e22e>add</span>(employee);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       List<span style=color:#f92672>&lt;</span>GrantedAuthority<span style=color:#f92672>&gt;</span> managerAuthority <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>       adminAuthority.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> SimpleGrantedAuthority(<span style=color:#e6db74>&#34;MANAGER&#34;</span>));
</span></span><span style=display:flex><span>       UserDetails manager<span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User(<span style=color:#e6db74>&#34;vs&#34;</span>, <span style=color:#e6db74>&#34;{noop}vs&#34;</span>, managerAuthority);
</span></span><span style=display:flex><span>       users.<span style=color:#a6e22e>add</span>(manager);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> InMemoryUserDetailsManager(users);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> SecurityFilterChain <span style=color:#a6e22e>filterChain</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//declares which Page(URL) will have What access type</span>
</span></span><span style=display:flex><span>        http.<span style=color:#a6e22e>authorizeRequests</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/home&#34;</span>).<span style=color:#a6e22e>permitAll</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>).<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/admin&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/emp&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/mgr&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/common&#34;</span>).<span style=color:#a6e22e>hasAnyAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>,<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Any other URLs which are not configured in above antMatchers</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// generally declared aunthenticated() in real time</span>
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>anyRequest</span>().<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Login Form Details</span>
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>formLogin</span>()
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>defaultSuccessUrl</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>, <span style=color:#66d9ef>true</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Logout Form Details</span>
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>logout</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>logoutRequestMatcher</span>(<span style=color:#66d9ef>new</span> AntPathRequestMatcher(<span style=color:#e6db74>&#34;/logout&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Exception Details</span>
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>exceptionHandling</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>accessDeniedPage</span>(<span style=color:#e6db74>&#34;/accessDenied&#34;</span>)
</span></span><span style=display:flex><span>        ;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> http.<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>上面的代码片段是使用 Spring Security 的内存中身份验证的示例。</p><h3 id=示例3使用-websecurityconfigureradapter>示例#3：使用 WebSecurityConfigurerAdapter</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WebSecurityConfig</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowire</span>
</span></span><span style=display:flex><span>    UserDetailsService userDetailsService;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(AuthenticationManagerBuilder authenticationManagerBuilder) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        authenticationManagerBuilder.<span style=color:#a6e22e>userDetailsService</span>(userDetailsService).<span style=color:#a6e22e>passwordEncoder</span>(passwordEncoder());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> PasswordEncoder <span style=color:#a6e22e>passwordEncoder</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> BCryptPasswordEncoder();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例3没有-websecurityconfigureradapter>示例#3：没有 WebSecurityConfigurerAdapter</h3><p>下面的代码演示了在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security 的可能解决方案。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WebSecurityConfig</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    AuthenticationManager <span style=color:#a6e22e>authenticationManager</span>(AuthenticationConfiguration authenticationConfiguration) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> authenticationConfiguration.<span style=color:#a6e22e>getAuthenticationManager</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在这里，在旧版本中我们注入 AuthenticationManagerBuilder，设置 userDetailsS​​ervice、passwordEncoder 并构建它。但是 AuthenticationManager 已经在这一步中创建了。它是按照我们想要的方式创建的（使用 userDetailsS​​ervice 和 passwordEncoder）。</p><h3 id=示例4使用-websecurityconfigureradapter>示例#4：使用 WebSecurityConfigurerAdapter</h3><p>在实现网络安全配置时，WebSecurityCustomizer 是一个回调接口，可用于自定义 WebSecurity。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfiguration</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(WebSecurity web) {
</span></span><span style=display:flex><span>        web.<span style=color:#a6e22e>ignoring</span>().<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/ignore1&#34;</span>, <span style=color:#e6db74>&#34;/ignore2&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例4没有-websecurityconfigureradapter>示例#4：没有 WebSecurityConfigurerAdapter</h3><p>从 Spring Security 5.7.0-M2 开始，推荐的方法是注册 WebSecurityCustomizer bean。下面的代码演示了在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security 的可能解决方案：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfiguration</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> WebSecurityCustomizer <span style=color:#a6e22e>webSecurityCustomizer</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (web) <span style=color:#f92672>-&gt;</span> web.<span style=color:#a6e22e>ignoring</span>().<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/ignore1&#34;</span>, <span style=color:#e6db74>&#34;/ignore2&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例5使用-websecurityconfigureradapter>示例#5：使用 WebSecurityConfigurerAdapter</h3><p>下面的代码演示了 Spring Security 上下文中 JDBC 身份验证的变化。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>ong<span style=color:#f92672>&gt;</span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfig</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> DataSource dataSource;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> BCryptPasswordEncoder passwordEncoder;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(AuthenticationManagerBuilder auth) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       auth.<span style=color:#a6e22e>jdbcAuthentication</span>()
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>dataSource</span>(dataSource) <span style=color:#f92672>/</span>creates database connection
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>usersByUsernameQuery</span>(<span style=color:#e6db74>&#34;select user_name,user_pwd,user_enabled from user where user_name=?&#34;</span>)
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>authoritiesByUsernameQuery</span>(<span style=color:#e6db74>&#34;select user_name,user_role from user where user_name=?&#34;</span>)
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>passwordEncoder</span>(passwordEncoder);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例5没有-websecurityconfigureradapter>示例#5：没有 WebSecurityConfigurerAdapter</h3><p>展望未来，如果我们想在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security，新代码将如下所示。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfig</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>private</span> DataSource dataSource;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>public</span> UserDetailsManager <span style=color:#a6e22e>authenticateUsers</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      UserDetails user <span style=color:#f92672>=</span> User.<span style=color:#a6e22e>withUsername</span>(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>password</span>(PasswordEncoderFactories.<span style=color:#a6e22e>createDelegatingPasswordEncoder</span>().<span style=color:#a6e22e>encode</span>(<span style=color:#e6db74>&#34;password&#34;</span>)).<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>      JdbcUserDetailsManager users <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> JdbcUserDetailsManager(dataSource);
</span></span><span style=display:flex><span>      users.<span style=color:#a6e22e>setAuthoritiesByUsernameQuery</span>(<span style=color:#e6db74>&#34;select user_name,user_pwd,user_enabled from user where user_name=?&#34;</span>);
</span></span><span style=display:flex><span>      users.<span style=color:#a6e22e>setUsersByUsernameQuery</span>(<span style=color:#e6db74>&#34;select user_name,user_role from user where user_name=?&#34;</span>);
</span></span><span style=display:flex><span>      users.<span style=color:#a6e22e>createUser</span>(user);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> users;
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>新的实现将如上所示。这可能不是确切的解决方案。</p><h2 id=spring-security-600-或更高版本中有哪些弃用更新>Spring Security 6.0.0 或更高版本中有哪些弃用更新？</h2><p>如果您使用 Spring Security 6.0.0 或更高版本（以及 Spring Boot 3.0 或更高版本），您还会看到其他 API 弃用。例如，以下是需要进行的一些更改：</p><ul><li><p>authorizeRequests() ->authorizeHttpRequests()</p></li><li><p>antMatchers() -> requestMatchers()</p></li><li><p>regexMatchers() -> RegexRequestMatchers()</p></li></ul><h2 id=faq>FAQ</h2><h3 id=在哪里可以找到没有-websecurityconfigureradapter-的-spring-security-的完整示例>在哪里可以找到“没有 WebSecurityConfigurerAdapter 的 Spring Security 的完整示例？”</h3><p>以下是查找“没有 WebSecurityConfigurerAdapter 的 Spring Security”完整示例的链接：</p><ol><li><p><a href=https://javatechonline.com/how-to-implement-security-in-spring-boot-project/ target=_blank>How To Implement Security In Spring Boot Project?</a></p></li><li><p><a href=https://javatechonline.com/how-to-implement-security-in-spring-boot-using-userdetailsservice/ target=_blank>How to implement Role Based Spring Security Without WebSecurityConfigurerAdapter in Spring Boot using UserDetailsService?</a></p></li><li><p><a href=https://javatechonline.com/how-to-implement-jwt-authentication-in-spring-boot-project/ target=_blank>How to implement JWT Authentication in Spring Boot Project?</a></p></li></ol><h2 id=结论>结论</h2><p>在完成了“没有 WebSecurityConfigurerAdapter 的 Spring Security”的所有理论和示例部分之后，最后，我们应该准备好在实时项目中处理警告“WebSecurityConfigurerAdapter Deprecated”。此外，我们希望您扩展“没有 WebSecurityConfigurerAdapter 的 Spring Security”一文中提供的知识，并在您的项目中相应地实现该概念。如需进一步学习 Spring Security，您可以访问 Spring Security 使用 Spring Boot 系列教程。另外，如果后续有任何更新，我们也会对文章进行相应的更新。此外，请随时在下面的评论部分提供您的意见。</p><p>原文链接：<a href=https://javatechonline.com/spring-security-without-websecurityconfigureradapter/ target=_blank>https://javatechonline.com/spring-security-without-websecurityconfigureradapter/</a></p></div></article></main><footer class=post__footer><div class=post-related><h3>相关文章</h3><ul class=post-related-list><li class=post-related-item><a href=/posts/2023/08/18/how-to-implement-jwt-authentication-in-spring-boot-project/ target=_blank title="[译]Spring Boot项目如何实现JWT认证？">[译]Spring Boot项目如何实现JWT认证？</a></li><li class=post-related-item><a href=/posts/2023/08/18/how-to-implement-security-in-spring-boot-project/ target=_blank title="[译]Spring Boot项目如何实现Security？">[译]Spring Boot项目如何实现Security？</a></li><li class=post-related-item><a href=/posts/2023/08/18/how-to-implement-security-in-spring-boot2-using-userdetailsservice/ target=_blank title="[译]如何在Spring Boot2中使用UserDetailsService实现安全性？">[译]如何在Spring Boot2中使用UserDetailsService实现安全性？</a></li><li class=post-related-item><a href=/posts/2023/08/18/how-to-implement-security-in-spring-boot3-using-userdetailsservice/ target=_blank title="[译]如何在Spring Boot3中使用UserDetailsService实现安全性？">[译]如何在Spring Boot3中使用UserDetailsService实现安全性？</a></li><li class=post-related-item><a href=/posts/2023/08/16/spring-security-with-jwt/ target=_blank title="[译]Spring Security - JWT">[译]Spring Security - JWT</a></li><li class=post-related-item><a href=/posts/2023/08/16/spring-security-with-oauth2/ target=_blank title="[译]Spring Security - OAuth2">[译]Spring Security - OAuth2</a></li></ul></div></footer><footer class=post__footer><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 000-6 3 3 0 000 6"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/spring-boot/ rel=tag>spring-boot</a></li><li class=tags__item><a class="tags__link btn" href=/tags/security/ rel=tag>security</a></li></ul></div></footer></footer><nav class="pagination flex"><div class="pagination__item pagination__item--prev"><a class=pagination__link href=/posts/2023/08/18/how-to-implement-security-in-spring-boot2-using-userdetailsservice/ rel=prev><p class=pagination__title>«&#8201;上一篇: [译]如何在Spring Boot2中使用UserDetailsService实现安全性？</p></a></div><div class="pagination__item pagination__item--next"><a class=pagination__link href=/posts/2023/08/18/how-to-implement-security-in-spring-boot-project/ rel=next><p class=pagination__title>&#8201;» 下一篇: [译]Spring Boot项目如何实现Security？</p></a></div></nav><div class="authorbox clearfix"><figure class=authorbox__avatar><img alt="ChenSoul avatar" src=/avatar.jpg class=avatar height=60 width=60 loading=lazy></figure><div class=authorbox__header><span class=authorbox__name>关于 ChenSoul</span></div><div class=authorbox__description>一个来自中国武汉的开发者，主要撰写软件开发和开源方面的文章。浏览我的<a href=%28/posts%29>博客文章</a>，订阅我的 <a href=/index.xml>RSS</a> 源，或了解更多<a href=/about/>关于我</a>的信息。</div></div><p><h3>欢迎留言！</h3></p><div id=remark42></div><script>var remark_config={host:"https://comment.chensoul.cc",site_id:"remark",components:["embed"],url:"https://blog.chensoul.cc/posts/2023/08/18/spring-security-without-websecurityconfigureradapter/",locale:"zh"};!function(e,t){for(s=0;s<e.length;s++){var s,n=t.createElement("script"),o=".js",i=t.head||t.body;"noModule"in n?(n.type="module",o=".mjs"):n.async=!0,n.defer=!0,n.src=remark_config.host+"/web/"+e[s]+o,i.appendChild(n)}}(remark_config.components||["embed"],document)</script></div><aside class="sidebar sidebar--right"><div class="post__toc toc"><div class=toc__title>目录</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#什么是-websecurityconfigureradapter>什么是 WebSecurityConfigurerAdapter？</a></li><li><a href=#为什么我们需要学习这个改变>为什么我们需要学习这个改变？</a></li><li><a href=#我们需要在哪里实施这一改变>我们需要在哪里实施这一改变？</a></li><li><a href=#如何删除已弃用的警告>如何删除已弃用的警告？</a></li><li><a href=#如何在没有-websecurityconfigureradapter-的情况下使用-spring-security>如何在没有 WebSecurityConfigurerAdapter 的情况下使用 Spring Security？</a><ul><li><a href=#示例1使用-websecurityconfigureradapter>示例#1：使用 WebSecurityConfigurerAdapter</a></li><li><a href=#示例1没有-websecurityconfigureradapter>示例#1：没有 WebSecurityConfigurerAdapter</a></li><li><a href=#示例2使用-websecurityconfigureradapter>示例#2：使用 WebSecurityConfigurerAdapter</a></li><li><a href=#示例2没有-websecurityconfigureradapter>示例#2：没有 WebSecurityConfigurerAdapter</a></li><li><a href=#示例3使用-websecurityconfigureradapter>示例#3：使用 WebSecurityConfigurerAdapter</a></li><li><a href=#示例3没有-websecurityconfigureradapter>示例#3：没有 WebSecurityConfigurerAdapter</a></li><li><a href=#示例4使用-websecurityconfigureradapter>示例#4：使用 WebSecurityConfigurerAdapter</a></li><li><a href=#示例4没有-websecurityconfigureradapter>示例#4：没有 WebSecurityConfigurerAdapter</a></li><li><a href=#示例5使用-websecurityconfigureradapter>示例#5：使用 WebSecurityConfigurerAdapter</a></li><li><a href=#示例5没有-websecurityconfigureradapter>示例#5：没有 WebSecurityConfigurerAdapter</a></li></ul></li><li><a href=#spring-security-600-或更高版本中有哪些弃用更新>Spring Security 6.0.0 或更高版本中有哪些弃用更新？</a></li><li><a href=#faq>FAQ</a><ul><li><a href=#在哪里可以找到没有-websecurityconfigureradapter-的-spring-security-的完整示例>在哪里可以找到“没有 WebSecurityConfigurerAdapter 的 Spring Security 的完整示例？”</a></li></ul></li><li><a href=#结论>结论</a></li></ul></nav></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__links><a class=footer__link href=/>首页</a> | <a class=footer__link href=/categories/>分类</a> | <a class=footer__link href=/tags/>标签</a> | <a class=footer__link href=/index.xml>订阅</a> | <a class=footer__link href=/about/>关于</a></div><div class=footer__copyright>&copy; 2025 ChenSoul.
<span class=footer__copyright-credits>基于 <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> 引擎和 <a href=https://github.com/chensoul/rose-hugo/ rel="nofollow noopener" target=_blank>Rose Hugo</a> 主题</span></div></div><style>.scroll-up a{display:block;height:3.125rem;width:3.125rem;text-align:center;line-height:2.7;border-radius:50px;font-size:1.125rem;color:#fff;opacity:1;transition:all .3s ease 0s;box-shadow:0 0 10px rgb(0 0 0/.2)}.scroll-up a{background:#ee591f}.scroll-up{position:fixed;display:none;bottom:50px;z-index:999}.scroll-up.right{right:60px}</style><div class="scroll-up custom right" style=display:block><a href=#top id=top-link accesskey=g><i class="fa fa-arrow-up"></i></a></div><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script defer src=https://umami.chensoul.cc/random-string.js data-website-id=1e07d36d-bec3-4ba6-9459-876b1ac3bbe7></script></footer></div><script>"use strict";(function(t){var i=t.querySelector(".menu__btn"),o=t.querySelector(".menu__list");function a(){o.classList.toggle("menu__list--active"),o.classList.toggle("menu__list--transition"),this.classList.toggle("menu__btn--active"),this.setAttribute("aria-expanded",this.getAttribute("aria-expanded")==="true"?"false":"true")}function r(){this.classList.remove("menu__list--transition")}i&&o&&(i.addEventListener("click",a,!1),o.addEventListener("transitionend",r,!1))})(document,window)</script></body></html>