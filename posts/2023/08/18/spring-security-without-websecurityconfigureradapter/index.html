<!doctype html><html lang=en-US prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="
在 Spring Security 模块的上下文中，WebSecurityConfigurerAdapter 是一个抽象类，根据 Spring 官方网站 2022 年 2 月 21 日发布的公告，该类已从 Spring Security 5.7.0-M2 中弃用。它通常用于扩展 configure() 方法由自定义配置子类实现。因此，它鼓励用户转向基于组件的安全配置。为了支持对这种新配置设计的更改，我们将讨论常见用例列表和未来建议的替代方案。因此，我们将讨论没有 WebSecurityConfigurerAdapter 的 Spring Security 用例的实现。"><title>[译]没有WebSecurityConfigurerAdapter的Spring Security.md | ChenSoul</title><link rel=canonical href=https://blog.chensoul.cc/posts/2023/08/18/spring-security-without-websecurityconfigureradapter/><link rel=preconnect href=https://fonts.font.im><link rel=preconnect href=https://fonts.loli.net crossorigin><link href="https://fonts.loli.net/css2?family=Roboto+Slab:wght@400;500;700&display=swap" rel=stylesheet><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.chensoul.cc/images/favicon.webp"><meta name=twitter:title content="[译]没有WebSecurityConfigurerAdapter的Spring Security.md"><meta name=twitter:description content="在 Spring Security 模块的上下文中，WebSecurityConfigurerAdapter 是一个抽象类，根据 Spring 官方网站 2022 年 2 月 21 日发布的公告，该类已从 Spring Security 5.7.0-M2 中弃用。它通常用于扩展 configure() 方法由自定义配置子类实现。因此，它鼓励用户转向基于组件的安全配置。为了支持对这种新配置设计的更改，我们将讨论常见用例列表和未来建议的替代方案。因此，我们将讨论没有 WebSecurityConfigurerAdapter 的 Spring Security 用例的实现。"><meta name=twitter:creator content="@ichensoul"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="chensoul"><meta property="og:url" content="https://blog.chensoul.cc/posts/2023/08/18/spring-security-without-websecurityconfigureradapter/"><meta property="og:site_name" content="ChenSoul"><meta property="og:title" content="[译]没有WebSecurityConfigurerAdapter的Spring Security.md"><meta property="og:description" content="在 Spring Security 模块的上下文中，WebSecurityConfigurerAdapter 是一个抽象类，根据 Spring 官方网站 2022 年 2 月 21 日发布的公告，该类已从 Spring Security 5.7.0-M2 中弃用。它通常用于扩展 configure() 方法由自定义配置子类实现。因此，它鼓励用户转向基于组件的安全配置。为了支持对这种新配置设计的更改，我们将讨论常见用例列表和未来建议的替代方案。因此，我们将讨论没有 WebSecurityConfigurerAdapter 的 Spring Security 用例的实现。"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-18T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-18T00:00:00+00:00"><meta property="article:tag" content="Spring-Security"><meta property="og:image" content="https://blog.chensoul.cc/images/favicon.webp"><meta itemprop=name content="[译]没有WebSecurityConfigurerAdapter的Spring Security.md"><meta itemprop=description content="在 Spring Security 模块的上下文中，WebSecurityConfigurerAdapter 是一个抽象类，根据 Spring 官方网站 2022 年 2 月 21 日发布的公告，该类已从 Spring Security 5.7.0-M2 中弃用。它通常用于扩展 configure() 方法由自定义配置子类实现。因此，它鼓励用户转向基于组件的安全配置。为了支持对这种新配置设计的更改，我们将讨论常见用例列表和未来建议的替代方案。因此，我们将讨论没有 WebSecurityConfigurerAdapter 的 Spring Security 用例的实现。"><meta itemprop=datePublished content="2023-08-18T00:00:00+00:00"><meta itemprop=dateModified content="2023-08-18T00:00:00+00:00"><meta itemprop=wordCount content="882"><meta itemprop=image content="https://blog.chensoul.cc/images/favicon.webp"><meta itemprop=keywords content="Spring-Security"><link rel=stylesheet href=https://cdnjs.loli.net/ajax/libs/font-awesome/6.4.0/css/all.min.css media=all><link rel=stylesheet href=/main.min.css type=text/css media=all><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"TechArticle","name":"[译]没有WebSecurityConfigurerAdapter的Spring Security.md","headline":"[译]没有WebSecurityConfigurerAdapter的Spring Security.md","inLanguage":"en-US","url":"https://blog.chensoul.cc/posts/2023/08/18/spring-security-without-websecurityconfigureradapter/","description":"\u003cp\u003e\u003cimg src=\"/images/WebSecurityConfigurerAdapter-Deprecated-1.webp\" alt=\"WebSecurityConfigurerAdapter Deprecated\"\u003e\u003c/p\u003e\n\u003cp\u003e在 Spring Security 模块的上下文中，WebSecurityConfigurerAdapter 是一个抽象类，根据 \u003ca href=\"https:/spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter\" target=\"_blank\"\u003eSpring 官方网站\u003c/a\u003e 2022 年 2 月 21 日发布的公告，该类已从 Spring Security 5.7.0-M2 中弃用。它通常用于扩展 configure() 方法由自定义配置子类实现。因此，它鼓励用户转向基于组件的安全配置。为了支持对这种新配置设计的更改，我们将讨论常见用例列表和未来建议的替代方案。因此，我们将讨论没有 WebSecurityConfigurerAdapter 的 Spring Security 用例的实现。\u003c/p\u003e","wordCount":"882","keywords":["spring-security"],"datePublished":"2023-08-18T00:00:00Z","dateModified":"2023-08-18T00:00:00Z","author":{"@type":"Person","name":"chensoul"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chensoul.cc/posts/2023/08/18/spring-security-without-websecurityconfigureradapter/"},"publisher":{"@type":"Organization","name":"chensoul","url":"https://blog.chensoul.cc/posts/2023/08/18/spring-security-without-websecurityconfigureradapter/"}},{"@context":"https://schema.org","@type":"Organization","name":"chensoul","url":"https://blog.chensoul.cc/","sameAs":["https://x.com/ichensoul","https://github.com/chensoul","https://www.linkedin.com/in/","https://www.youtube.com/@chensoul","https://t.me/chensouls"]}]}</script><script defer src=https://umami.chensoul.cc/random-string.js data-website-id=4718b57b-c900-4a61-a7af-0fe1fb1d50ce></script></head><body class="home blog post-layout-one-column"><button onclick=topFunction() id=scrollTopBtn title="Go to top">
<i class="fa-solid fa-arrow-up"></i></button><div id=header-top class=header-bar-wrap></div><div id=page class=site><a class="skip-link screen-reader-text" href=#content>Skip to content</a><header id=masthead class="site-header clearfix" role=banner><div class="header-main container clearfix"><div id=logo class="site-branding clearfix"><h1 class=site-title><a href=/ title=ChenSoul rel=home>ChenSoul</a></h1><p class=site-description>Java, Spring Boot, Microservice, Cloud, Architecture and DevOps Tutorials</p></div><div class="header-widgets clearfix"><aside id=search-2 class="header-widget widget_search"><form role=search method=get class=search-form onsubmit="return searchSite(event)"><label><span class=screen-reader-text>Search for:</span>
<input type=search class=search-field placeholder="Enter search keyword" name=query id=query title="Enter search keyword">
</label><button type=submit class=search-submit title=Search> <span class=genericon-search></span>
<span class=screen-reader-text>Search</span></button></form></aside></div></div><div id=main-navigation-wrap class=primary-navigation-wrap><nav id=main-navigation class="primary-navigation navigation container clearfix" role=navigation><ul id=menu-home class=main-navigation-menu><li class="menu-item menu-item-type-custom menu-item-object-custom
current-menu-item current_page_item menu-item-home"><a href=/>Home</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/spring-boot/>Spring Boot</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/architecture/>Architecture</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/microservice/>Microservice</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/categories/kubernetes/>Kubernetes</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category
menu-item-has-children"><a href=/tutorials/>Tutorials</a><ul class=sub-menu><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/spring-boot-tutorials/>Spring Boot Tutorials</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/microservice-tutorials/>Microservice Tutorials</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href=/kubernetes-tutorials/>Kubernetes Tutorials</a></li></ul></li><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=https://github.com/chensoul target=_blank>About Me</a></li></ul></nav></div></header><div id=content class="site-content container clearfix"><section id=primary class="content-archive content-area post-content-area"><main id=main class=site-main role=main><article class="post type-post"><div class=post-inner-content><header class=entry-header><h2 class=entry-title><a href=https://blog.chensoul.cc/posts/2023/08/18/spring-security-without-websecurityconfigureradapter/ rel=bookmark title="[译]没有WebSecurityConfigurerAdapter的Spring Security.md">[译]没有WebSecurityConfigurerAdapter的Spring Security.md</a></h2><div class=entry-meta><span class=meta-date><time class="entry-date published" datetime=2023-08-18T00:00:00>2023-08-18
</time></span><span class=meta-author><span class="author vcard">chensoul</span>
</span><span class="tagcloud post-tags"><i class="fa fa-tags"></i>&nbsp;
<a class="tag-cloud-link widget__link widget__link--taglist" href=/tags/spring-security/ title=spring-security>spring-security</a></span></div></header><div class=entry-content><p><img src=/images/WebSecurityConfigurerAdapter-Deprecated-1.webp alt="WebSecurityConfigurerAdapter Deprecated"></p><p>在 Spring Security 模块的上下文中，WebSecurityConfigurerAdapter 是一个抽象类，根据 <a href=https:/spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter target=_blank>Spring 官方网站</a> 2022 年 2 月 21 日发布的公告，该类已从 Spring Security 5.7.0-M2 中弃用。它通常用于扩展 configure() 方法由自定义配置子类实现。因此，它鼓励用户转向基于组件的安全配置。为了支持对这种新配置设计的更改，我们将讨论常见用例列表和未来建议的替代方案。因此，我们将讨论没有 WebSecurityConfigurerAdapter 的 Spring Security 用例的实现。</p><p>了解这一变化很重要，因为迟早我们将使用最新版本的 Spring Security 来开发安全功能。让我们讨论“没有 WebSecurityConfigurerAdapter 的 Spring Security”主题及其相关概念。</p><h2 id=什么是-websecurityconfigureradapter>什么是 WebSecurityConfigurerAdapter？</h2><p>WebSecurityConfigurerAdapter 是 Spring Security 模块提供的一个抽象类。一般来说，我们使用它来重写它的 configure()方法来定义我们的安全配置类。通常，我们在应用程序中实现 Spring Security 时使用两个具有不同参数的 configure() 方法。一种用于声明与身份验证相关的配置，另一种用于声明与授权相关的配置。该代码类似于下面的代码片段。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfiguration</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(AuthenticationManagerBuilder auth) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>         <span style=color:#f92672>/</span> configure Authentication ......
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>/</span> configure Authorization ......
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=为什么我们需要学习这个改变>为什么我们需要学习这个改变？</h2><p>如果您使用 Spring Boot 2.7.0 和 maven，它将自动下载 Spring Security 5.7.0 或更高版本。在这种情况下，您会发现 WebSecurityConfigurerAdapter 已被弃用。如果您仍然想使用此类而不弃用，您可以在 pom.xml 中将 Spring Boot 版本更改为较低版本（例如 2.6.6 ），如下所示。它将自动下载低于 5.7.0 的 Spring Security 版本，并且弃用警告将消失。</p><p>但是，如果您不使用 Spring Boot，而是使用简单的 Spring Security 模块，您甚至可以降低 Spring Security 的版本。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;parent&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;groupId&gt;</span>org.springframework.boot<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;artifactId&gt;</span>spring-boot-starter-parent<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;version&gt;</span>2.6.6<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/parent&gt;</span>
</span></span></code></pre></div><p>这样，我们就可以在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security。</p><h2 id=我们需要在哪里实施这一改变>我们需要在哪里实施这一改变？</h2><p>以下是一些可能实施此更改的情况。</p><ol><li><p>如果您使用的是 Spring Boot 2.7.0 或更高版本</p></li><li><p>如果您正在使用 Spring Security 5.7.0 或更高版本</p></li><li><p>如果你的项目得到如上所述升级或迁移到更高版本</p></li><li><p>如果您想使用最新版本的 Spring Boot 自定义 Spring Security 配置</p></li><li><p>如果您想删除 WebSecurityConfigurerAdapter Deprecated 的烦人警告</p></li><li><p>如果你想在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security。</p></li></ol><h2 id=如何删除已弃用的警告>如何删除已弃用的警告？</h2><p>下面就让我们一步一步来学习吧：</p><ol><li><p>如果您使用 STS 作为 IDE 来开发项目，则需要降低 Spring Boot 的版本。如果您使用的是 Spring Boot 2.7.0 或更高版本，请将其设为 2.6.x（例如 2.6.6）。您可以通过更新 pom.xml 来做到这一点。完成后，它将自动下载 Spring Security 模块的兼容版本。</p></li><li><p>检查您的配置类是否扩展了 WebSecurityConfigurerAdapter 类。已弃用的警告应该消失。现在您可以在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security。</p></li></ol><h2 id=如何在没有-websecurityconfigureradapter-的情况下使用-spring-security>如何在没有 WebSecurityConfigurerAdapter 的情况下使用 Spring Security？</h2><p>如上所述，通常我们会在自定义配置类中继承 WebSecurityConfigurerAdapter 的 configure() 方法。因此，我们需要找到这些方法的替代方案，因为自 Spring Security 5.7.0-M2 发布以来，WebSecurityConfigurerAdapter 已被弃用。</p><p>让我们讨论一些例子</p><h3 id=示例1使用-websecurityconfigureradapter>示例#1：使用 WebSecurityConfigurerAdapter</h3><p>此示例演示了 HttpSecurity 配置。通常，我们编写它来声明授权工件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WebSecurityConfig</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>     http.<span style=color:#a6e22e>cors</span>().<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>csrf</span>().<span style=color:#a6e22e>disable</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>sessionManagement</span>().<span style=color:#a6e22e>sessionCreationPolicy</span>(SessionCreationPolicy.<span style=color:#a6e22e>STATELESS</span>)
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>authorizeRequests</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/home&#34;</span>).<span style=color:#a6e22e>permitAll</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>).<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/admin&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>)
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/emp&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>)
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/mgr&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>anyRequest</span>().<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>     ;
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例1没有-websecurityconfigureradapter>示例#1：没有 WebSecurityConfigurerAdapter</h3><p>下面的代码演示了在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security 的可能解决方案。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WebSecurityConfig</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>public</span> SecurityFilterChain <span style=color:#a6e22e>filterChain</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>      http.<span style=color:#a6e22e>cors</span>().<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>csrf</span>().<span style=color:#a6e22e>disable</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>sessionManagement</span>().<span style=color:#a6e22e>sessionCreationPolicy</span>(SessionCreationPolicy.<span style=color:#a6e22e>STATELESS</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>and</span>().<span style=color:#a6e22e>authorizeRequests</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/home&#34;</span>).<span style=color:#a6e22e>permitAll</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>).<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/admin&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/emp&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/mgr&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>anyRequest</span>().<span style=color:#a6e22e>authenticated</span>();
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> http.<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在这里，我们需要执行以下步骤：</p><ul><li>步骤#1：删除@override，因为我们不会从任何类中扩展和覆盖它。</li><li>步骤＃2：在此方法上应用@Bean 注解</li><li>步骤#3：现在将方法返回类型声明为 SecurityFilterChain，而不是 void</li><li>步骤#4：根据需要更新方法名称。比如说 filterChain。</li><li>步骤#5：方法结束时，主体返回 http.build()。这里 http 是 HttpSecurity 类型的变量。</li></ul><h3 id=示例2使用-websecurityconfigureradapter>示例#2：使用 WebSecurityConfigurerAdapter</h3><p>在下面的示例中，我们使用了这两种方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.context.annotation.Configuration;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.web.util.matcher.AntPathRequestMatcher;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfig</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(AuthenticationManagerBuilder auth) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>/</span> {noop} <span style=color:#f92672>=&gt;</span> No operation <span style=color:#66d9ef>for</span> password <span style=color:#a6e22e>encoder</span> (no password encoding needed)
</span></span><span style=display:flex><span>      auth.<span style=color:#a6e22e>inMemoryAuthentication</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>withUser</span>(<span style=color:#e6db74>&#34;devs&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>password</span> (<span style=color:#e6db74>&#34;{noop} devs&#34;</span>) <span style=color:#f92672>/</span>no password encoding needed
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>authorities</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      auth.<span style=color:#a6e22e>inMemoryAuthentication</span>().<span style=color:#a6e22e>withUser</span>(<span style=color:#e6db74>&#34;ns&#34;</span>).<span style=color:#a6e22e>password</span>(<span style=color:#e6db74>&#34;{noop}ns&#34;</span>).<span style=color:#a6e22e>authorities</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>);
</span></span><span style=display:flex><span>      auth.<span style=color:#a6e22e>inMemoryAuthentication</span>().<span style=color:#a6e22e>withUser</span>(<span style=color:#e6db74>&#34;vs&#34;</span>).<span style=color:#a6e22e>password</span>(<span style=color:#e6db74>&#34;{noop}vs&#34;</span>).<span style=color:#a6e22e>authorities</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>);
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>/</span>declares which <span style=color:#a6e22e>Page</span>(URL) will have What access type
</span></span><span style=display:flex><span>      http.<span style=color:#a6e22e>authorizeRequests</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/home&#34;</span>).<span style=color:#a6e22e>permitAll</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>).<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/admin&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/emp&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/mgr&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/common&#34;</span>).<span style=color:#a6e22e>hasAnyAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>,<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>/</span> Any other URLs which are not configured in above antMatchers
</span></span><span style=display:flex><span>      <span style=color:#f92672>/</span> generally declared <span style=color:#a6e22e>aunthenticated</span>() in real time
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>anyRequest</span>().<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>/</span> Login Form Details
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>formLogin</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>defaultSuccessUrl</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>, <span style=color:#66d9ef>true</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>/</span> Logout Form Details
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>logout</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>logoutRequestMatcher</span>(<span style=color:#66d9ef>new</span> AntPathRequestMatcher(<span style=color:#e6db74>&#34;/logout&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>/</span> Exception Details
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>exceptionHandling</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>accessDeniedPage</span>(<span style=color:#e6db74>&#34;/accessDenied&#34;</span>)
</span></span><span style=display:flex><span>      ;
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例2没有-websecurityconfigureradapter>示例#2：没有 WebSecurityConfigurerAdapter</h3><p>下面的代码演示了在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security 的可能解决方案。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> java.util.ArrayList;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.List;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.context.annotation.Bean;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.context.annotation.Configuration;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.core.GrantedAuthority;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.core.authority.SimpleGrantedAuthority;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.core.userdetails.User;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.core.userdetails.UserDetails;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.provisioning.InMemoryUserDetailsManager;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.web.SecurityFilterChain;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.security.web.util.matcher.AntPathRequestMatcher;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfigNew</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> InMemoryUserDetailsManager <span style=color:#a6e22e>configAuthentication</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       List<span style=color:#f92672>&lt;</span>UserDetails<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>       List<span style=color:#f92672>&lt;</span>GrantedAuthority<span style=color:#f92672>&gt;</span> adminAuthority <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>       adminAuthority.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> SimpleGrantedAuthority(<span style=color:#e6db74>&#34;ADMIN&#34;</span>));
</span></span><span style=display:flex><span>       UserDetails admin<span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User(<span style=color:#e6db74>&#34;devs&#34;</span>, <span style=color:#e6db74>&#34;{noop}devs&#34;</span>, adminAuthority);
</span></span><span style=display:flex><span>       users.<span style=color:#a6e22e>add</span>(admin);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       List<span style=color:#f92672>&lt;</span>GrantedAuthority<span style=color:#f92672>&gt;</span> employeeAuthority <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>       adminAuthority.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> SimpleGrantedAuthority(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>));
</span></span><span style=display:flex><span>       UserDetails employee<span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User(<span style=color:#e6db74>&#34;ns&#34;</span>, <span style=color:#e6db74>&#34;{noop}ns&#34;</span>, employeeAuthority);
</span></span><span style=display:flex><span>       users.<span style=color:#a6e22e>add</span>(employee);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       List<span style=color:#f92672>&lt;</span>GrantedAuthority<span style=color:#f92672>&gt;</span> managerAuthority <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>       adminAuthority.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> SimpleGrantedAuthority(<span style=color:#e6db74>&#34;MANAGER&#34;</span>));
</span></span><span style=display:flex><span>       UserDetails manager<span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User(<span style=color:#e6db74>&#34;vs&#34;</span>, <span style=color:#e6db74>&#34;{noop}vs&#34;</span>, managerAuthority);
</span></span><span style=display:flex><span>       users.<span style=color:#a6e22e>add</span>(manager);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> InMemoryUserDetailsManager(users);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> SecurityFilterChain <span style=color:#a6e22e>filterChain</span>(HttpSecurity http) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>/</span>declares which <span style=color:#a6e22e>Page</span>(URL) will have What access type
</span></span><span style=display:flex><span>        http.<span style=color:#a6e22e>authorizeRequests</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/home&#34;</span>).<span style=color:#a6e22e>permitAll</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>).<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/admin&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;ADMIN&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/emp&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/mgr&#34;</span>).<span style=color:#a6e22e>hasAuthority</span>(<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/common&#34;</span>).<span style=color:#a6e22e>hasAnyAuthority</span>(<span style=color:#e6db74>&#34;EMPLOYEE&#34;</span>,<span style=color:#e6db74>&#34;MANAGER&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>/</span> Any other URLs which are not configured in above antMatchers
</span></span><span style=display:flex><span>        <span style=color:#f92672>/</span> generally declared <span style=color:#a6e22e>aunthenticated</span>() in real time
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>anyRequest</span>().<span style=color:#a6e22e>authenticated</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>/</span> Login Form Details
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>formLogin</span>()
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>defaultSuccessUrl</span>(<span style=color:#e6db74>&#34;/welcome&#34;</span>, <span style=color:#66d9ef>true</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>/</span> Logout Form Details
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>logout</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>logoutRequestMatcher</span>(<span style=color:#66d9ef>new</span> AntPathRequestMatcher(<span style=color:#e6db74>&#34;/logout&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>/</span> Exception Details
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>and</span>()
</span></span><span style=display:flex><span>         .<span style=color:#a6e22e>exceptionHandling</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>accessDeniedPage</span>(<span style=color:#e6db74>&#34;/accessDenied&#34;</span>)
</span></span><span style=display:flex><span>        ;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> http.<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>上面的代码片段是使用 Spring Security 的内存中身份验证的示例。</p><h3 id=示例3使用-websecurityconfigureradapter>示例#3：使用 WebSecurityConfigurerAdapter</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WebSecurityConfig</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowire</span>
</span></span><span style=display:flex><span>    UserDetailsService userDetailsService;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(AuthenticationManagerBuilder authenticationManagerBuilder) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        authenticationManagerBuilder.<span style=color:#a6e22e>userDetailsService</span>(userDetailsService).<span style=color:#a6e22e>passwordEncoder</span>(passwordEncoder());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> PasswordEncoder <span style=color:#a6e22e>passwordEncoder</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> BCryptPasswordEncoder();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例3没有-websecurityconfigureradapter>示例#3：没有 WebSecurityConfigurerAdapter</h3><p>下面的代码演示了在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security 的可能解决方案。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WebSecurityConfig</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    AuthenticationManager <span style=color:#a6e22e>authenticationManager</span>(AuthenticationConfiguration authenticationConfiguration) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> authenticationConfiguration.<span style=color:#a6e22e>getAuthenticationManager</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在这里，在旧版本中我们注入 AuthenticationManagerBuilder，设置 userDetailsS​​ervice、passwordEncoder 并构建它。但是 AuthenticationManager 已经在这一步中创建了。它是按照我们想要的方式创建的（使用 userDetailsS​​ervice 和 passwordEncoder）。</p><h3 id=示例4使用-websecurityconfigureradapter>示例#4：使用 WebSecurityConfigurerAdapter</h3><p>在实现网络安全配置时，WebSecurityCustomizer 是一个回调接口，可用于自定义 WebSecurity。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfiguration</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(WebSecurity web) {
</span></span><span style=display:flex><span>        web.<span style=color:#a6e22e>ignoring</span>().<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/ignore1&#34;</span>, <span style=color:#e6db74>&#34;/ignore2&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例4没有-websecurityconfigureradapter>示例#4：没有 WebSecurityConfigurerAdapter</h3><p>从 Spring Security 5.7.0-M2 开始，推荐的方法是注册 WebSecurityCustomizer bean。下面的代码演示了在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security 的可能解决方案：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfiguration</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> WebSecurityCustomizer <span style=color:#a6e22e>webSecurityCustomizer</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (web) <span style=color:#f92672>-&gt;</span> web.<span style=color:#a6e22e>ignoring</span>().<span style=color:#a6e22e>antMatchers</span>(<span style=color:#e6db74>&#34;/ignore1&#34;</span>, <span style=color:#e6db74>&#34;/ignore2&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例5使用-websecurityconfigureradapter>示例#5：使用 WebSecurityConfigurerAdapter</h3><p>下面的代码演示了 Spring Security 上下文中 JDBC 身份验证的变化。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>ong<span style=color:#f92672>&gt;</span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfig</span> <span style=color:#66d9ef>extends</span> WebSecurityConfigurerAdapter {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> DataSource dataSource;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> BCryptPasswordEncoder passwordEncoder;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>configure</span>(AuthenticationManagerBuilder auth) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       auth.<span style=color:#a6e22e>jdbcAuthentication</span>()
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>dataSource</span>(dataSource) <span style=color:#f92672>/</span>creates database connection
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>usersByUsernameQuery</span>(<span style=color:#e6db74>&#34;select user_name,user_pwd,user_enabled from user where user_name=?&#34;</span>)
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>authoritiesByUsernameQuery</span>(<span style=color:#e6db74>&#34;select user_name,user_role from user where user_name=?&#34;</span>)
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>passwordEncoder</span>(passwordEncoder);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=示例5没有-websecurityconfigureradapter>示例#5：没有 WebSecurityConfigurerAdapter</h3><p>展望未来，如果我们想在没有 WebSecurityConfigurerAdapter 的情况下实现 Spring Security，新代码将如下所示。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableWebSecurity</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecurityConfig</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>private</span> DataSource dataSource;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>public</span> UserDetailsManager <span style=color:#a6e22e>authenticateUsers</span>() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      UserDetails user <span style=color:#f92672>=</span> User.<span style=color:#a6e22e>withUsername</span>(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>password</span>(PasswordEncoderFactories.<span style=color:#a6e22e>createDelegatingPasswordEncoder</span>().<span style=color:#a6e22e>encode</span>(<span style=color:#e6db74>&#34;password&#34;</span>)).<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>      JdbcUserDetailsManager users <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> JdbcUserDetailsManager(dataSource);
</span></span><span style=display:flex><span>      users.<span style=color:#a6e22e>setAuthoritiesByUsernameQuery</span>(<span style=color:#e6db74>&#34;select user_name,user_pwd,user_enabled from user where user_name=?&#34;</span>);
</span></span><span style=display:flex><span>      users.<span style=color:#a6e22e>setUsersByUsernameQuery</span>(<span style=color:#e6db74>&#34;select user_name,user_role from user where user_name=?&#34;</span>);
</span></span><span style=display:flex><span>      users.<span style=color:#a6e22e>createUser</span>(user);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> users;
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>新的实现将如上所示。这可能不是确切的解决方案。</p><h2 id=spring-security-600-或更高版本中有哪些弃用更新>Spring Security 6.0.0 或更高版本中有哪些弃用更新？</h2><p>如果您使用 Spring Security 6.0.0 或更高版本（以及 Spring Boot 3.0 或更高版本），您还会看到其他 API 弃用。例如，以下是需要进行的一些更改：</p><ul><li><p>authorizeRequests() ->authorizeHttpRequests()</p></li><li><p>antMatchers() -> requestMatchers()</p></li><li><p>regexMatchers() -> RegexRequestMatchers()</p></li></ul><h2 id=faq>FAQ</h2><h3 id=在哪里可以找到没有-websecurityconfigureradapter-的-spring-security-的完整示例>在哪里可以找到“没有 WebSecurityConfigurerAdapter 的 Spring Security 的完整示例？”</h3><p>以下是查找“没有 WebSecurityConfigurerAdapter 的 Spring Security”完整示例的链接：</p><ol><li><p><a href=https:/javatechonline.com/how-to-implement-security-in-spring-boot-project/ target=_blank>How To Implement Security In Spring Boot Project?</a></p></li><li><p><a href=https:/javatechonline.com/how-to-implement-security-in-spring-boot-using-userdetailsservice/ target=_blank>How to implement Role Based Spring Security Without WebSecurityConfigurerAdapter in Spring Boot using UserDetailsService?</a></p></li><li><p><a href=https:/javatechonline.com/how-to-implement-jwt-authentication-in-spring-boot-project/ target=_blank>How to implement JWT Authentication in Spring Boot Project?</a></p></li></ol><h2 id=结论>结论</h2><p>在完成了“没有 WebSecurityConfigurerAdapter 的 Spring Security”的所有理论和示例部分之后，最后，我们应该准备好在实时项目中处理警告“WebSecurityConfigurerAdapter Deprecated”。此外，我们希望您扩展“没有 WebSecurityConfigurerAdapter 的 Spring Security”一文中提供的知识，并在您的项目中相应地实现该概念。如需进一步学习 Spring Security，您可以访问 Spring Security 使用 Spring Boot 系列教程。另外，如果后续有任何更新，我们也会对文章进行相应的更新。此外，请随时在下面的评论部分提供您的意见。</p><p>原文链接：<a href=https:/javatechonline.com/spring-security-without-websecurityconfigureradapter/ target=_blank>https:/javatechonline.com/spring-security-without-websecurityconfigureradapter/</a></p></div><div><div style=font-weight:700>Share this post:</div><a class=social-link-item href="https://twitter.com/intent/tweet?text=%5b%e8%af%91%5d%e6%b2%a1%e6%9c%89WebSecurityConfigurerAdapter%e7%9a%84Spring%20Security.md https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f18%2fspring-security-without-websecurityconfigureradapter%2f" target=_blank rel="noopener noreferrer" title="Click to share on Twitter"><i class="fa-brands fa-square-twitter fa-2xl" style=color:#55acee></i>
</a><a class=social-link-item href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f18%2fspring-security-without-websecurityconfigureradapter%2f&title=%5b%e8%af%91%5d%e6%b2%a1%e6%9c%89WebSecurityConfigurerAdapter%e7%9a%84Spring%20Security.md" target=_blank rel="noopener noreferrer" title="Click to share on LinkedIn"><i class="fa-brands fa-linkedin fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://telegram.me/share/url?text=%5b%e8%af%91%5d%e6%b2%a1%e6%9c%89WebSecurityConfigurerAdapter%e7%9a%84Spring%20Security.md&amp;url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f18%2fspring-security-without-websecurityconfigureradapter%2f" target=_blank rel="noopener noreferrer" title="Click to share on telegram"><i class="fa-brands fa-telegram fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://reddit.com/submit?url=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f18%2fspring-security-without-websecurityconfigureradapter%2f&title=%5b%e8%af%91%5d%e6%b2%a1%e6%9c%89WebSecurityConfigurerAdapter%e7%9a%84Spring%20Security.md" target=_blank rel="noopener noreferrer" title="Click to share on reddit"><i class="fa-brands fa-reddit fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f18%2fspring-security-without-websecurityconfigureradapter%2f" target=_blank rel="noopener noreferrer" title="Click to share on facebook"><i class="fa-brands fa-facebook fa-2xl" style=color:#007bb5></i>
</a><a class=social-link-item href="https://api.whatsapp.com/send?text=%5b%e8%af%91%5d%e6%b2%a1%e6%9c%89WebSecurityConfigurerAdapter%e7%9a%84Spring%20Security.md%20-%20https%3a%2f%2fblog.chensoul.cc%2fposts%2f2023%2f08%2f18%2fspring-security-without-websecurityconfigureradapter%2f" target=_blank rel="noopener noreferrer" title="Click to share on whatsapp"><i class="fa-brands fa-whatsapp fa-2xl" style=color:#007bb5></i></a></div></div></article><nav class="navigation post-navigation" role=navigation><h2 class=screen-reader-text>Post navigation</h2><div class=nav-links><div class=nav-previous><a href=/posts/2023/08/18/how-to-implement-security-in-spring-boot3-using-userdetailsservice/ rel=next><span class=post-title>[译]如何在Spring Boot3中使用UserDetailsService实现安全性？</span></a></div><div class=nav-next><a href=/posts/2023/08/16/spring-security-with-jwt/ rel=prev><span class=post-title>[译]Spring Security - JWT</span></a></div></div></nav><h2>Related content</h2><ul><li><a href=/posts/2023/10/13/new-features-in-spring-boot-3-and-spring-6/>[译]Spring Boot3和Spring6中的新特性</a></li><li><a href=/posts/2023/10/12/spring-security-interview-questions/>[译]Spring Security 面试问题</a></li><li><a href=/posts/2023/09/19/spring-security-tutorial/>[译]Spring Security 与 JWT for REST API</a></li><li><a href=/posts/2023/09/19/spring-security-jwt/>[译]如何使用Spring Security和JWT保护您的REST API</a></li><li><a href=/posts/2023/08/25/global-error-handler-in-a-spring-rest-api/>[译]REST API 的自定义错误消息处理</a></li><li><a href=/posts/2023/08/25/spring-events/>[译]Spring Events</a></li><li><a href=/posts/2023/08/25/spring-security-async-principal-propagation/>[译]使用@Async进行Spring Security上下文传播</a></li><li><a href=/posts/2023/08/25/exception-handling-for-rest-with-spring/>[译]使用Spring进行REST的错误处理</a></li><li><a href=/posts/2023/08/25/spring-async/>[译]如何在Spring中执行@Async</a></li><li><a href=/posts/2023/08/18/how-to-implement-jwt-authentication-in-spring-boot-project/>[译]Spring Boot项目如何实现JWT认证？</a></li></ul></main></section></div><div id=footer class=footer-wrap><footer id=colophon class="site-footer container clearfix" role=contentinfo><div id=footer-text class=site-info><span class=credit-link>Made with 🩷
by <a href=/ target=_blank rel="noopener noreferrer">ChenSoul</a></span></div></footer></div></div><script type=text/javascript src=/main.min.js></script></body></html>