<!doctype html><html class=no-js lang=zh-cn><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>周报-15｜Umami升级到2.0、汉街蜡像馆、使用Strava跑步 -</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><link rel=preconnect href=//fonts.loli.net crossorigin><link rel=dns-prefetch href=//fonts.loli.net><link rel=stylesheet href="https://fonts.loli.net/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.min.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="ChenSoul Blog" rel=home><div class="logo__item logo__text"><div class=logo__title>ChenSoul Blog</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>菜单</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>首页</span></a></li><li class=menu__item><a class=menu__link href=/categories/><span class=menu__text>分类</span></a></li><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>关于</span></a></li><li class=menu__item><a class=menu__link href=/rss.xml><span class=menu__text>RSS</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>周报-15｜Umami升级到2.0、汉街蜡像馆、使用Strava跑步</h1></header><div class="content post__content clearfix"><h2 id=前言>前言</h2><p><img src=/images/weekly-review-15-01.webp alt=weekly-review-15-01></p><p><em>题图：楚河汉街蜡像馆</em></p><p>本篇是对 <code>2023-04-10</code> 到 <code>2023-04-16</code> 这周生活的记录与思考。首发在我的个人 <a href=https://blog.chensoul.cc/ target=_blank>博客</a>，你可以移步了解更多或者给我留言。</p><p>这周的工作不算忙碌，继续学习《Effective Java 3》这本书，并花了一些时间学习 Rust、Python 的基础语法。</p><p>这个月已经过了一半，减肥也进行了两周，体重从 72 公斤减到了现在的 68.4 公斤。在之前每天走路 1 万步的基础上，打算开始每天跑步，比记录跑步数据。</p><p>这周总计支出 916 元，明细如下：</p><ul><li>4 月 12 日：329 元，开通 ETC 预存 300 元</li><li>4 月 15 日：116 元，周末买菜做饭</li><li>4 月 16 日：471 元，老婆过生，吃饭和看电影</li></ul><p>四月累计支出共 2025 元，其中餐饮和购物占了一半。</p><p><img src=/images/weekly-review-15-05.webp alt></p><h2 id=健身>健身</h2><p>这周每天走路步数如下，其中有一天因为加班而没有完成一万步的目标。</p><p><img src=/images/weekly-review-15-06.webp alt></p><p>受 <a href=https://conge.livingwithfcs.org/ target=_blank>@Conge</a> 博客影响，开始记录每天的跑步数据。首先是注册了 strava 账号，然后参考 <a href=https://github.com/yihong0618/running_page target=_blank>running_page</a> 部署了一个我的跑步主页 <a href=https://run.chensoul.cc/ target=_blank>run.chensoul.cc</a>。</p><p><img src=/images/weekly-review-15-02.webp alt=weekly-review-15-02></p><p>因为我之前是使用悦跑圈 APP 记录跑步，所以又参考<a href=https://github.com/yihong0618/running_page/blob/master/README-CN.md#joyrun%E6%82%A6%E8%B7%91%E5%9C%88 target=_blank>这篇文章</a>导出 gpx 数据，然后<a href=https://github.com/yihong0618/running_page/blob/master/README-CN.md#gpx_to_strava target=_blank>同步</a>到 Strava。最后，可以把悦跑圈 APP 卸载了。</p><p><img src=/images/weekly-review-15-03.webp alt=weekly-review-15-03></p><p>上周跑步数据如下，总计 28.64 公里，比上周的 19.05 公里多了 9.6 公里。</p><p><img src=/images/weekly-review-15-04.webp alt=weekly-review-15-04></p><p>上面搞定了之后，就可以使用 Strava 来跑步了。为了增加社交乐趣性，我在 n8n 里面创建了一个 workflow，将 Strava 活动发送到我的『<a href=https://t.me/ichensoul target=_blank>ChenSoul Share</a>』Telegram 频道，效果如下。</p><p><img src=/images/weekly-review-15-07.webp alt></p><h2 id=umami-升级到-20>Umami 升级到 2.0</h2><p>1、首先备份数据库</p><p>2、升级数据库</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/umami-software/migrate-v1-v2.git
</span></span><span style=display:flex><span>cd migrate-v1-v2
</span></span><span style=display:flex><span>yarn install
</span></span><span style=display:flex><span>yarn build
</span></span></code></pre></div><p>创建 .env 文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#75715e>#修改为你的数据库地址</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>DATABASE_URL</span><span style=color:#f92672>=</span><span style=color:#e6db74>postgresql://umami:xxxxx@postgres.chensoul.cc:5432/umami</span>
</span></span></code></pre></div><p>运行：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yarn start
</span></span></code></pre></div><p>3、重新部署静态页面</p><p>日志提示报错：</p><p><img src=/images/weekly-review-15-16.webp alt=weekly-review-15-16></p><p>解决办法是修改 scripts/check-db.js：</p><p><img src=/images/weekly-review-15-17.webp alt=weekly-review-15-17></p><p>4、修改跟踪脚本，把站点中所有追踪脚本名字<code>umami.js</code>改为<code>script.js</code>。</p><p>5、最后查看实时仪表盘。我的 umami 实时 <a href=https://umami.chensoul.cc/realtime/f110cfa0-b737-4690-a032-2b9073a57fc3 target=_blank>访问地址</a></p><h2 id=工作>工作</h2><h3 id=effective-java-3-笔记>Effective Java 3 笔记</h3><p>请参考《<a href=/posts/2023/04/17/prefer-dependency-injection-to-hardwiring-resources>Effective Java 3 笔记：依赖注入优于硬编码资源</a>》。</p><h2 id=汉街蜡像馆>汉街蜡像馆</h2><p>周末趁武汉旅游大年卡还没过期，跑到楚河汉街蜡像馆去溜达了一圈。因为有年卡，省去了 150 元的门票。</p><p><img src=/images/weekly-review-15-08.webp alt></p><p><img src=/images/weekly-review-15-09.webp alt></p><p><img src=/images/weekly-review-15-10.webp alt></p><p><img src=/images/weekly-review-15-11.webp alt></p><p><img src=/images/weekly-review-15-12.webp alt></p><p><img src=/images/weekly-review-15-13.webp alt></p><p><img src=/images/weekly-review-15-14.webp alt></p><p><img src=/images/weekly-review-15-15.webp alt></p><h2 id=好物分享>好物分享</h2><p>虽然大部分有意思的内容会分享在 『<a href=https://t.me/ichensoul target=_blank>ChenSoul Share</a>』Telegram 频道，不过还是挑选一部分在这里列举一下，感觉更像一个 newsletter 了。</p><h3 id=一些文章>一些文章</h3><p>1、<a href=https://www3.ntu.edu.sg/home/ehchua/programming/index.html target=_blank>Java 编程教程</a></p><p><img src=https://cdn.beekka.com/blogimg/asset/202301/bg2023011504.webp alt=img></p><p>这个网站是新加坡南洋理工大学的一位老师的教案（英文），主要内容为新生的 Java 编程</p><p>2、<a href=https://offsec.tools/ target=_blank>offsec.tools</a></p><p><img src=https://cdn.beekka.com/blogimg/asset/202301/bg2023012101.webp alt=img></p><p>这个网站收集各种安全相关的软件工具，目前共有 600 多个。</p><p>3、<a href=https://juemuren4449.com/archives/habit-formation-plan target=_blank>我的习惯养成计划：五分钟规则+打卡</a></p><p>4、<a href=https://www.jitao.tech/posts/my-guiding-principles-after-20-years-of-programming/ target=_blank>我编程 20 年的指导原则</a></p><p>5、<a href=https://lenciel.com/2022/10/renaming-with-zmv/ target=_blank>用 zmv 批量重命名文件</a></p><h3 id=一些工具>一些工具</h3><ul><li><a href=https://webperformancereport.com/ target=_blank>WebPerformance Report</a> 这个网站可以用邮箱订阅你的网站性能的个性化报告。它会监控指定网站的性能，每周会发送一封报告邮件给你。</li></ul></div><footer class=post__footer><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 000-6 3 3 0 000 6"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/review/ rel=tag>review</a></li></ul></div></footer></footer></article></main><nav class="pagination flex"><div class="pagination__item pagination__item--prev"><a class=pagination__link href=/posts/2023/04/13/weekly_review_14/ rel=prev><p class=pagination__title>«&#8201;上一篇: 周报-14｜如何学习一门编程语言</p></a></div><div class="pagination__item pagination__item--next"><a class=pagination__link href=/posts/2023/04/25/weekly_review_16/ rel=next><p class=pagination__title>&#8201;» 下一篇: 周报-16｜《灌篮高手》电影、《春山如笑》话剧</p></a></div></nav><footer class=post__footer><div class=post-related><h3>相关文章</h3><ul class=post-related-list><li class=post-related-item><a href=/posts/2023/04/13/weekly_review_14/ target=_blank title=周报-14｜如何学习一门编程语言>周报-14｜如何学习一门编程语言</a></li><li class=post-related-item><a href=/posts/2023/04/04/weekly_review_13/ target=_blank title=周报-13｜健身、记账、更新SSL证书、代码提交百度站点收录>周报-13｜健身、记账、更新SSL证书、代码提交百度站点收录</a></li><li class=post-related-item><a href=/posts/2023/03/28/weekly_review_12/ target=_blank title="周报-12｜车辆被堵、开车总结、Effective Java3笔记">周报-12｜车辆被堵、开车总结、Effective Java3笔记</a></li><li class=post-related-item><a href=/posts/2023/03/20/weekly_review_11/ target=_blank title=周报-11｜从语雀迁移到Obsidian>周报-11｜从语雀迁移到Obsidian</a></li><li class=post-related-item><a href=/posts/2023/03/13/weekly_review_10/ target=_blank title="周报-10｜通过Cloudflare Tunnel访问服务、Vercel部署Cusdis和Umami">周报-10｜通过Cloudflare Tunnel访问服务、Vercel部署Cusdis和Umami</a></li><li class=post-related-item><a href=/posts/2023/03/07/weekly_review_9/ target=_blank title=周报-9｜开车总结、博客该写什么、Web3批量空投>周报-9｜开车总结、博客该写什么、Web3批量空投</a></li></ul></div></footer><p><h3>欢迎留言！</h3></p><div id=remark42></div><script>var remark_config={host:"https://remark42.example.com",site_id:"remark",components:["embed"],url:"https://blog.chensoul.cc/posts/2023/04/18/weekly_review_15/",locale:"en"};!function(e,t){for(s=0;s<e.length;s++){var s,n=t.createElement("script"),o=".js",i=t.head||t.body;"noModule"in n?(n.type="module",o=".mjs"):n.async=!0,n.defer=!0,n.src=remark_config.host+"/web/"+e[s]+o,i.appendChild(n)}}(remark_config.components||["embed"],document)</script></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__links><a class=footer__link href=/>首页</a> | <a class=footer__link href=/categories/>分类</a> | <a class=footer__link href=/about/>关于</a> | <a class=footer__link href=/rss.xml>RSS</a></div><div class=footer__copyright>&copy; 2025 ChenSoul.
<span class=footer__copyright-credits>基于 <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> 引擎和 <a href=https://github.com/chensoul/rose-hugo/ rel="nofollow noopener" target=_blank>Rose Hugo</a> 主题</span></div></div><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></footer></div><script>"use strict";(function(t){var i=t.querySelector(".menu__btn"),o=t.querySelector(".menu__list");function a(){o.classList.toggle("menu__list--active"),o.classList.toggle("menu__list--transition"),this.classList.toggle("menu__btn--active"),this.setAttribute("aria-expanded",this.getAttribute("aria-expanded")==="true"?"false":"true")}function r(){this.classList.remove("menu__list--transition")}i&&o&&(i.addEventListener("click",a,!1),o.addEventListener("transitionend",r,!1))})(document,window)</script></body></html>